'ExcelScript.AggregationFunction:enum':
  - |-
    /**
     * This script changes how the data in a PivotTable is aggregated.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first PivotTable in the workbook.
      const pivotTable = workbook.getPivotTables()[0];
      
      // Set the first data hierarchy to summarize with an average value, instead of a sum.
      const dataHierarchy = pivotTable.getDataHierarchies()[0];
      dataHierarchy.setSummarizeBy(ExcelScript.AggregationFunction.average);
    }
'ExcelScript.AllowEditRangeOptions:interface':
  - |-
    /**
     * This script adds a password-protected, editable range
     * to an otherwise protected worksheet.
     */
    function main(workbook: ExcelScript.Workbook, password: string) {
        // Get the protection object for the "Data" worksheet.
        const dataSheet = workbook.getWorksheet("Data");
        const sheetProtection = dataSheet.getProtection();

        // Set the password needed to edit the range to be the user provided string.
        const editRangeProperties : ExcelScript.AllowEditRangeOptions = {
            password: password
        };

        // Set range "D2:D6" to be editable if the password is provided.
        sheetProtection.addAllowEditRange("Notes Section", "D2:D6", editRangeProperties);
        
        // Protect the worksheet.
        sheetProtection.protect();
    }
'ExcelScript.Application#calculate:member(1)':
  - |-
    /**
     * This script fully recalculates the entire workbook.
     * This code is useful when automatic recalculation is turned off
     * but later parts of the script rely on updated values.
     */
    function main(workbook: ExcelScript.Workbook, workbookURL: string) {
      const application = workbook.getApplication();
      application.calculate(ExcelScript.CalculationType.fullRebuild);
    }
'ExcelScript.Application#getCalculationState:member(1)':
  - |-
    /**
     * This script uses the fill color of the first cell to indicate the current
     * calculation state of the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the first worksheet.
      const cell = workbook.getWorksheets()[0].getCell(0,0);

      // Get that cell's fill object.
      const cellFill = cell.getFormat().getFill();

      // Set the cell fill based on the calculation state.
      const calcState = workbook.getApplication().getCalculationState();
      switch (calcState) {
        case ExcelScript.CalculationState.pending:
          cellFill.setColor("Red");
          break;
        case ExcelScript.CalculationState.calculating:
          cellFill.setColor("Yellow");
          break;
        case ExcelScript.CalculationState.done:
          cellFill.setColor("Green");
          break;
      }
    }
'ExcelScript.ArrowheadLength:enum':
  - |- 
    /**
     * This script adds a line that goes from cell B2 to cell F4 on the current worksheet.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      const sheet = workbook.getActiveWorksheet();

      // Get the ranges for the two cells.
      const b2Range = sheet.getRange("B2");
      const f4Range = sheet.getRange("F4");

      // Add a straight line that connects the top-left corners of both cells.
      const newShape = sheet.addLine(
        b2Range.getLeft(),
        b2Range.getTop(),
        f4Range.getLeft(),
        f4Range.getTop(),
        ExcelScript.ConnectorType.straight);

      // Add a long, open arrowhead to the end of the line, such that it points at F4.
      const line = newShape.getLine();
      line.setEndArrowheadStyle(ExcelScript.ArrowheadStyle.open);
      line.setEndArrowheadLength(ExcelScript.ArrowheadLength.long);
    }
'ExcelScript.ArrowheadStyle:enum':
  - |- 
    /**
     * This script adds a line that goes from cell B2 to cell F4 on the current worksheet.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      const sheet = workbook.getActiveWorksheet();

      // Get the ranges for the two cells.
      const b2Range = sheet.getRange("B2");
      const f4Range = sheet.getRange("F4");

      // Add a straight line that connects the top-left corners of both cells.
      const newShape = sheet.addLine(
        b2Range.getLeft(),
        b2Range.getTop(),
        f4Range.getLeft(),
        f4Range.getTop(),
        ExcelScript.ConnectorType.straight);

      // Add an open arrowhead to the end of the line, such that it points at F4.
      const line = newShape.getLine();
      line.setEndArrowheadStyle(ExcelScript.ArrowheadStyle.open);
    }
'ExcelScript.ArrowheadWidth:enum':
  - |- 
    /**
     * This script adds a line that goes from cell B2 to cell F4 on the current worksheet.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      const sheet = workbook.getActiveWorksheet();

      // Get the ranges for the two cells.
      const b2Range = sheet.getRange("B2");
      const f4Range = sheet.getRange("F4");

      // Add a straight line that connects the top-left corners of both cells.
      const newShape = sheet.addLine(
        b2Range.getLeft(),
        b2Range.getTop(),
        f4Range.getLeft(),
        f4Range.getTop(),
        ExcelScript.ConnectorType.straight);

      // Add a wide, triangular arrowhead to the end of the line, such that it points at F4.
      const line = newShape.getLine();
      line.setEndArrowheadStyle(ExcelScript.ArrowheadStyle.triangle);
      line.setEndArrowheadWidth(ExcelScript.ArrowheadWidth.wide);
    }
'ExcelScript.AutoFillType:enum':
  - |-
    /**
     * This script uses the autofill feature to complete a table with days of the month.
     * See https://support.microsoft.com/office/74e31bdd-d993-45da-aa82-35a236c5b5db
     * for examples of autofill scenarios.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      let currentWorksheet = workbook.getActiveWorksheet();

      // Get the data range that shows the pattern.
      let dataRange = currentWorksheet.getRange("C2:C3");

      // Autofill the connected range. C2:C3 are filled in with dates. C4:C54 are blank.
      dataRange.autoFill("C2:C54", ExcelScript.AutoFillType.fillDays);
    }
'ExcelScript.AutoFilter:interface':
  - |-
    /**
     * This script creates an autoFilter on the worksheet that filters out rows based on column values. 
     * The autoFilter filters to only include rows that have a value in column C in the lowest 10 values 
     * (of column C values).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the autoFilter of the first table in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const dataRange = currentSheet.getUsedRange();
      const autoFilter = currentSheet.getAutoFilter();

      // Add a filter that will only show the rows with the lowest 10 values in column C
      // (index 2, assuming the used range spans from at least A:C).
      autoFilter.apply(dataRange, 2, {
        criterion1: "10",
        filterOn: ExcelScript.FilterOn.bottomItems
      });
    }
'ExcelScript.AutoFilter#apply:member(1)':
  - |-
    /**
     * This script applies a filter to a table so that 
     * only rows with values in column 1 that start with "L" are shown.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the autoFilter of the first table in the current worksheet.
      const table = workbook.getActiveWorksheet().getTables()[0];
      const autoFilter = table.getAutoFilter();

      // Filter to only include values that start with "L".
      const filterCriteria: ExcelScript.FilterCriteria = {
        filterOn: ExcelScript.FilterOn.custom,
        criterion1: "L*"
      };
      
      // Apply the filter to column 1 (zero-based).
      autoFilter.apply(table.getRange(), 1, filterCriteria);
    }
'ExcelScript.AutoFilter#clearCriteria:member(1)':
  - |-
    /**
     * This script clears any applied criteria from the worksheet's autoFilter.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();

      // Clear all the criteria currently applied to the autoFilter.
      currentSheet.getAutoFilter().clearCriteria();
    }
'ExcelScript.BasicDataValidation:interface':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     * Attempts to enter other values are blocked and an error message appears.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);

      // Create an alert to appear when data other than positive numbers are entered.
      const positiveNumberOnlyAlert: ExcelScript.DataValidationErrorAlert = {
        message: "Positive numbers only",
        showAlert: true,
        style: ExcelScript.DataValidationAlertStyle.stop,
        title: "Invalid data"
      };
      rangeDataValidation.setErrorAlert(positiveNumberOnlyAlert);
    }
'ExcelScript.BorderIndex:enum':
  - |-
    /**
     * This script creates a border around a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the RangeFormat object for the range "B2:G10".
      const currentSheet = workbook.getActiveWorksheet();
      const rangeForBorder = currentSheet.getRange("B2:G10");
      const format = rangeForBorder.getFormat();
      
      // Get a RangeBorder object for each edge of the range and set the border properties.
      let edgeTop = format.getRangeBorder(ExcelScript.BorderIndex.edgeTop);
      edgeTop.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeTop.setWeight(ExcelScript.BorderWeight.thick);

      let edgeBottom = format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom);
      edgeBottom.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeBottom.setWeight(ExcelScript.BorderWeight.thick);

      let edgeLeft = format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft);
      edgeLeft.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeLeft.setWeight(ExcelScript.BorderWeight.thick);

      let edgeRight = format.getRangeBorder(ExcelScript.BorderIndex.edgeRight);
      edgeRight.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeRight.setWeight(ExcelScript.BorderWeight.thick);
    }
'ExcelScript.BorderLineStyle:enum':
  - |-
    /**
     * This script creates a border around a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the RangeFormat object for the range "B2:G10".
      const currentSheet = workbook.getActiveWorksheet();
      const rangeForBorder = currentSheet.getRange("B2:G10");
      const format = rangeForBorder.getFormat();
      
      // Get a RangeBorder object for each edge of the range and set the border properties.
      let edgeTop = format.getRangeBorder(ExcelScript.BorderIndex.edgeTop);
      edgeTop.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeTop.setWeight(ExcelScript.BorderWeight.thick);

      let edgeBottom = format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom);
      edgeBottom.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeBottom.setWeight(ExcelScript.BorderWeight.thick);

      let edgeLeft = format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft);
      edgeLeft.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeLeft.setWeight(ExcelScript.BorderWeight.thick);

      let edgeRight = format.getRangeBorder(ExcelScript.BorderIndex.edgeRight);
      edgeRight.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeRight.setWeight(ExcelScript.BorderWeight.thick);
    }
'ExcelScript.BorderWeight:enum':
  - |-
    /**
     * This script creates a border around a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the RangeFormat object for the range "B2:G10".
      const currentSheet = workbook.getActiveWorksheet();
      const rangeForBorder = currentSheet.getRange("B2:G10");
      const format = rangeForBorder.getFormat();
      
      // Get a RangeBorder object for each edge of the range and set the border properties.
      let edgeTop = format.getRangeBorder(ExcelScript.BorderIndex.edgeTop);
      edgeTop.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeTop.setWeight(ExcelScript.BorderWeight.thick);

      let edgeBottom = format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom);
      edgeBottom.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeBottom.setWeight(ExcelScript.BorderWeight.thick);

      let edgeLeft = format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft);
      edgeLeft.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeLeft.setWeight(ExcelScript.BorderWeight.thick);

      let edgeRight = format.getRangeBorder(ExcelScript.BorderIndex.edgeRight);
      edgeRight.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeRight.setWeight(ExcelScript.BorderWeight.thick);
    }
'ExcelScript.BuiltInStyle:enum':
  - |- 
    /**
     * This script sets the cell style to "warning text"
     * on every cell with a formula error.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const usedRange = sheet.getUsedRange();

      // Get any cells that are displaying errors.
      const errorCells = usedRange.getSpecialCells(
        ExcelScript.SpecialCellType.formulas,
        ExcelScript.SpecialCellValueType.errors
      );

      // Check if there are error cells before proceeding.
      if (errorCells) {
        // Use the built-in warning text style on the error cells.
        errorCells.setPredefinedCellStyle(
          ExcelScript.BuiltInStyle.warningText.toString()
        );
      } else {
        console.log("No formula errors in the worksheet.");
      }
    }
'ExcelScript.CalculationMode:enum':
  - |-
    /**
     * This script recalculates the used range of a specific worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Only recalculate if the calculation mode is not set to automatic.
      if (workbook.getApplication().getCalculationMode() !== ExcelScript.CalculationMode.automatic) {
        // Get the used range from a worksheet named "Monthly Report".
        const sheet = workbook.getWorksheet("Monthly Report");
        const range = sheet.getUsedRange();
        console.log(`Calculating ${range.getAddress()}`);

        // Force all the used cells in that worksheet to calculate.
        sheet.getUsedRange().calculate();
      }
    }
'ExcelScript.CalculationState:enum':
  - |-
    /**
     * This script uses the fill color of the first cell to indicate the current
     * calculation state of the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the first worksheet.
      const cell = workbook.getWorksheets()[0].getCell(0,0);

      // Get that cell's fill object.
      const cellFill = cell.getFormat().getFill();

      // Set the cell fill based on the calculation state.
      const calcState = workbook.getApplication().getCalculationState();
      switch (calcState) {
        case ExcelScript.CalculationState.pending:
          cellFill.setColor("Red");
          break;
        case ExcelScript.CalculationState.calculating:
          cellFill.setColor("Yellow");
          break;
        case ExcelScript.CalculationState.done:
          cellFill.setColor("Green");
          break;
      }
    }
'ExcelScript.CalculationType:enum':
  - |-
    /**
     * This script fully recalculates the entire workbook.
     * This code is useful when automatic recalculation is turned off
     * but later parts of the script rely on updated values.
     */
    function main(workbook: ExcelScript.Workbook, workbookURL: string) {
      const application = workbook.getApplication();
      application.calculate(ExcelScript.CalculationType.fullRebuild);
    }
'ExcelScript.CellValueConditionalFormat:interface':
  - |-
    /**
     * This script applies conditional formatting to a range.
     * That formatting is conditional upon the cell's numerical value.
     * Any value between 50 and 75 will have the cell fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const sheet = workbook.getActiveWorksheet();
      const ratingColumn = sheet.getRange("D2:D20");

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting : ExcelScript.CellValueConditionalFormat 
        = ratingColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();
      
      // Create the condition, in this case when the cell value is between 50 and 75.
      let rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "50",
        formula2: "75",
        operator: ExcelScript.ConditionalCellValueOperator.between
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      let format = cellValueConditionalFormatting.getFormat();
      format.getFill().setColor("yellow");
      format.getFont().setItalic(true);
    }
'ExcelScript.Chart#addChartSeries:member(1)':
  - |-
    /**
     * This sample produces a line chart with two series.
     * The chart assumes data in A1:E5 that looks like this:
     * Product Qtr1 Qtr2 Qtr3 Qtr4
     * Frames 5000 7000 6544 4377
     * Saddles 400 323 276 651
     */
    function main(workbook: ExcelScript.Workbook) {
      // Establish the ranges to use.
      const sheet = workbook.getActiveWorksheet();
      const headerRange = sheet.getRange("A1:E1");
      const firstSeriesRange = sheet.getRange("A2:E2");
      const secondSeriesRange = sheet.getRange("A3:E3");

      // Create the chart.
      const lineChart = sheet.addChart(ExcelScript.ChartType.line, headerRange);

      // Add the first chart series.
      const firstSeries = lineChart.addChartSeries();
      firstSeries.setXAxisValues(headerRange);
      firstSeries.setValues(firstSeriesRange);

      // Add the second chart series.
      const secondSeries = lineChart.addChartSeries();
      secondSeries.setXAxisValues(headerRange);
      secondSeries.setValues(secondSeriesRange);
    }
'ExcelScript.Chart#getImage:member(1)':
  - |-
    /**
     * This script returns an image of the first chart in the first worksheet.
     * That image is 600x400 pixels and the chart will be 
     * stretched to fill those dimensions.
     * The returned image can be used in a Power Automate flow.
     */
    function main(workbook: ExcelScript.Workbook): string {
      // Get the first chart in the first worksheet.
      const firstSheet = workbook.getFirstWorksheet();
      const firstChart = firstSheet.getCharts()[0];

      // Get an image of the chart as a base64-encoded string.
      const base64String = firstChart.getImage(
        600, /* Width */
        400, /* Height */
        ExcelScript.ImageFittingMode.fill /* Fill to match the dimensions. */
      );

      return base64String;
    }
'ExcelScript.Chart#getPlotBy:member(1)':
  - |-
    /**
     * This sample performs the "Switch Row/Column" action on a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let columnClusteredChart = selectedSheet.getChart("ColumnClusteredChart");
      
      // Switch the row and column for the chart's data source.
      if (columnClusteredChart.getPlotBy() === ExcelScript.ChartPlotBy.columns) {
        // If the chart is grouped by columns, switch it to rows.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.rows);
      } else {
        // If the chart is grouped by rows, switch it to columns.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.columns);
      }
    }
'ExcelScript.Chart#getSeries:member(1)':
  - |-
    /**
     * This sample sets the overlap of the columns in a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let chart = selectedSheet.getChart("ColumnClusteredChart");

      // Set the overlap of every column of each series within a category.
      let seriesList = chart.getSeries();
      seriesList.forEach((series) => {
        // An overlap of 25 means the columns have 25% of their length overlapping with the adjacent columns in the same category.
        series.setOverlap(25);
      });
    }
'ExcelScript.Chart#getTitle:member(1)':
  - |-
    /**
     * This sample sets the title text for an existing chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the chart title.
      chart.getTitle().setText("Quarterly Sales by Product");
    }
'ExcelScript.Chart#setHeight:member(1)':
  - |-
    /**
     * This sample sets the height of an existing chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the chart height to 300 points.
      chart.setHeight(300);
    }
'ExcelScript.Chart#setLeft:member(1)':
  - |-
    /**
     * This sample sets the left position of an existing chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the left position to 50 points from the left edge.
      chart.setLeft(50);
    }
'ExcelScript.Chart#setName:member(1)':
  - |-
    /**
     * This sample creates a column-clustered chart based on the current worksheet's data.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the data range.
      let range = selectedSheet.getUsedRange();

      // Insert a chart using the data on the current worksheet.
      let chart = selectedSheet.addChart(ExcelScript.ChartType.columnClustered, range);

      // Name the chart for easy access in other scripts.
      chart.setName("ColumnChart");
    }
'ExcelScript.Chart#setPlotBy:member(1)':
 - |-
    /**
     * This sample performs the "Switch Row/Column" action on a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let columnClusteredChart = selectedSheet.getChart("ColumnClusteredChart");
      
      // Switch the row and column for the chart's data source.
      if (columnClusteredChart.getPlotBy() === ExcelScript.ChartPlotBy.columns) {
        // If the chart is grouped by columns, switch it to rows.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.rows);
      } else {
        // If the chart is grouped by rows, switch it to columns.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.columns);
      }
    }
'ExcelScript.Chart#setPosition:member(1)':
  - |-
    /**
     * This sample moves an existing chart to a specific place on the worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();
      
      // Get an existing chart named "ColumnChart".
      let chart = selectedSheet.getChart("ColumnChart");

      // Place the chart over the range "F1:L13".
      chart.setPosition("F1", "L13");
    }
'ExcelScript.Chart#setTop:member(1)':
  - |-
    /**
     * This sample sets the top position of an existing chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the top position to 100 points from the top edge.
      chart.setTop(100);
    }
'ExcelScript.Chart#setWidth:member(1)':
  - |-
    /**
     * This sample sets the width of an existing chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the chart width to 500 points.
      chart.setWidth(500);
    }
'ExcelScript.ChartAxes:interface':
  - |-
    /**
     * This sample gets the chart axes and customizes them.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Access and customize the axes.
      const axes = chart.getAxes();
      axes.getValueAxis().setDisplayUnit(ExcelScript.ChartAxisDisplayUnit.thousands);
      axes.getCategoryAxis().setVisible(true);
    }
'ExcelScript.ChartAxes#getCategoryAxis:member(1)':
  - |-
    /**
     * This sample gets and customizes the category axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Get and customize the category axis.
      const categoryAxis = chart.getAxes().getCategoryAxis();
      categoryAxis.setTickLabelPosition(ExcelScript.ChartAxisTickLabelPosition.low);
    }
'ExcelScript.ChartAxes#getValueAxis:member(1)':
  - |-
    /**
     * This sample gets and customizes the value axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Get and customize the value axis.
      const valueAxis = chart.getAxes().getValueAxis();
      valueAxis.setDisplayUnit(ExcelScript.ChartAxisDisplayUnit.thousands);
      valueAxis.setMinimum(40000);
      valueAxis.setMaximum(60000);
    }
'ExcelScript.ChartAxis:interface':
  - |-
    /**
     * This sample customizes the value axis of a chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Customize the value axis.
      const valueAxis = chart.getAxes().getValueAxis();
      valueAxis.setMinimum(40000);
      valueAxis.setMaximum(60000);
      valueAxis.setDisplayUnit(ExcelScript.ChartAxisDisplayUnit.thousands);
    }
'ExcelScript.ChartAxis#getMajorGridlines:member(1)':
  - |-
    /**
     * This sample customizes the gridline color on a chart's value axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the gridline color to gray.
      chart.getAxes().getValueAxis().getMajorGridlines().getFormat().getLine().setColor("gray");
    }
'ExcelScript.ChartAxis#setDisplayUnit:member(1)':
  - |-
    /**
     * This sample sets the display unit of the value axis to thousands.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the value axis to display in thousands.
      chart.getAxes().getValueAxis().setDisplayUnit(ExcelScript.ChartAxisDisplayUnit.thousands);
    }
'ExcelScript.ChartAxis#setMaximum:member(1)':
  - |-
    /**
     * This sample sets the maximum value on the value axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the maximum value to 10.
      chart.getAxes().getValueAxis().setMaximum(10);
    }
'ExcelScript.ChartAxis#setMinimum:member(1)':
  - |-
    /**
     * This sample sets the minimum value on the value axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the minimum value to 145.
      chart.getAxes().getValueAxis().setMinimum(145);
    }
'ExcelScript.ChartAxis#setReversePlotOrder:member(1)':
  - |-
    /**
     * This sample reverses the plot order of the category axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the category axis to not reverse the plot order.
      chart.getAxes().getCategoryAxis().setReversePlotOrder(false);
    }
'ExcelScript.ChartAxis#setTickLabelPosition:member(1)':
  - |-
    /**
     * This sample sets the tick label position on the category axis.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the tick label position to low.
      chart.getAxes().getCategoryAxis().setTickLabelPosition(
        ExcelScript.ChartAxisTickLabelPosition.low
      );
    }
'ExcelScript.ChartDataLabels:interface':
  - |-
    /**
     * This sample configures data labels on a chart series.
     * This assumes the active worksheet has a pie chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Configure the data labels.
      const series = chart.getSeries()[0];
      const dataLabels = series.getDataLabels();
      dataLabels.setShowPercentage(true);
      dataLabels.setShowSeriesName(false);
      dataLabels.setShowCategoryName(false);
      dataLabels.setShowValue(false);
    }
'ExcelScript.ChartDataLabels#setPosition:member(1)':
  - |-
    /**
     * This sample sets the position of data labels.
     * This assumes the active worksheet has a chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the data label position to best fit.
      const series = chart.getSeries()[0];
      series.getDataLabels().setPosition(ExcelScript.ChartDataLabelPosition.bestFit);
    }
'ExcelScript.ChartDataLabels#setShowCategoryName:member(1)':
  - |-
    /**
     * This sample shows category names in data labels.
     * This assumes the active worksheet has a chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Show category names in the data labels.
      const series = chart.getSeries()[0];
      series.getDataLabels().setShowCategoryName(true);
    }
'ExcelScript.ChartDataLabels#setShowLeaderLines:member(1)':
  - |-
    /**
     * This sample enables leader lines for data labels.
     * This assumes the active worksheet has a chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Enable leader lines.
      const series = chart.getSeries()[0];
      series.getDataLabels().setShowLeaderLines(true);
    }
'ExcelScript.ChartDataLabels#setShowPercentage:member(1)':
  - |-
    /**
     * This sample shows percentages in data labels.
     * This assumes the active worksheet has a pie chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Show percentages in the data labels.
      const series = chart.getSeries()[0];
      series.getDataLabels().setShowPercentage(true);
    }
'ExcelScript.ChartDataLabels#setShowSeriesName:member(1)':
  - |-
    /**
     * This sample controls series name visibility in data labels.
     * This assumes the active worksheet has a chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Hide the series name in data labels.
      const series = chart.getSeries()[0];
      series.getDataLabels().setShowSeriesName(false);
    }
'ExcelScript.ChartDataLabels#setShowValue:member(1)':
  - |-
    /**
     * This sample shows values in data labels.
     * This assumes the active worksheet has a chart with data labels enabled.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Show values in the data labels.
      const series = chart.getSeries()[0];
      series.getDataLabels().setShowValue(true);
    }
'ExcelScript.ChartErrorBarsType:enum':
  - |-
    /**
     * This script adds error bars for the standard error of each chart series point.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for the chart.
      const worksheet = workbook.getWorksheet("Sample");
      const dataRange = worksheet.getRange("A1:B15");

      // Create a line chart.
      const chart = worksheet.addChart(ExcelScript.ChartType.line, dataRange);

      // For each series, add error bars for the standard error on each point.
      const allSeries = chart.getSeries();
      allSeries.forEach((series) => {
        series.getYErrorBars().setType(ExcelScript.ChartErrorBarsType.stError);
        series.getYErrorBars().setVisible(true);
      });
    }
'ExcelScript.ChartFill:interface':
  - |-
    /**
     * This sample sets the fill color of a chart series.
     * This assumes the active worksheet has a stock chart (e.g., Volume-High-Low-Close).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the fill color for the first series (volume).
      const volumeSeries = chart.getSeries()[0];
      volumeSeries.getFormat().getFill().setSolidColor("#B0C4DE");
    }
'ExcelScript.ChartFill#setSolidColor:member(1)':
  - |-
    /**
     * This sample sets a solid fill color for a chart series.
     * This assumes the active worksheet has a stock chart (e.g., Volume-Open-High-Low-Close).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the fill color to light steel blue for the first series.
      const volumeSeries = chart.getSeries()[0];
      volumeSeries.getFormat().getFill().setSolidColor("#B0C4DE");
    }
'ExcelScript.ChartLegend:interface':
  - |-
    /**
     * This sample configures the chart legend.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Configure the legend.
      const legend = chart.getLegend();
      legend.setPosition(ExcelScript.ChartLegendPosition.bottom);
      legend.setVisible(true);
    }
'ExcelScript.ChartLegend#setPosition:member(1)':
  - |-
    /**
     * This sample sets the legend position on a chart.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Position the legend on the right side.
      chart.getLegend().setPosition(ExcelScript.ChartLegendPosition.right);
    }
'ExcelScript.ChartLegend#setVisible:member(1)':
  - |-
    /**
     * This sample hides the chart legend.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Hide the legend.
      chart.getLegend().setVisible(false);
    }
'ExcelScript.ChartPlotBy:enum':
  - |-
    /**
     * This sample performs the "Switch Row/Column" action on a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let columnClusteredChart = selectedSheet.getChart("ColumnClusteredChart");
      
      // Switch the row and column for the chart's data source.
      if (columnClusteredChart.getPlotBy() === ExcelScript.ChartPlotBy.columns) {
        // If the chart is grouped by columns, switch it to rows.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.rows);
      } else {
        // If the chart is grouped by rows, switch it to columns.
        columnClusteredChart.setPlotBy(ExcelScript.ChartPlotBy.columns);
      }
    }
'ExcelScript.ChartSeries:interface':
  - |-
    /**
     * This sample produces a line chart with two series.
     * The chart assumes data in A1:E5 that looks like this:
     * Product Qtr1 Qtr2 Qtr3 Qtr4
     * Frames 5000 7000 6544 4377
     * Saddles 400 323 276 651
     */
    function main(workbook: ExcelScript.Workbook) {
      // Establish the ranges to use.
      const sheet = workbook.getActiveWorksheet();
      const headerRange = sheet.getRange("A1:E1");
      const firstSeriesRange = sheet.getRange("A2:E2");
      const secondSeriesRange = sheet.getRange("A3:E3");

      // Create the chart.
      const lineChart = sheet.addChart(ExcelScript.ChartType.line, headerRange);

      // Add the first chart series.
      const firstSeries = lineChart.addChartSeries();
      firstSeries.setXAxisValues(headerRange);
      firstSeries.setValues(firstSeriesRange);

      // Add the second chart series.
      const secondSeries = lineChart.addChartSeries();
      secondSeries.setXAxisValues(headerRange);
      secondSeries.setValues(secondSeriesRange);
    }
'ExcelScript.ChartSeries#delete:member(1)':
  - |-
    /**
     * This sample creates a bubble chart and manually adds each series.
     */
    function main(workbook: ExcelScript.Workbook) {
      const sheet = workbook.getActiveWorksheet();
      
      // Add sample data.
      const data = [
        ["Product", "Price ($)", "Quality Score", "Market Share"],
        ["Keyboards", 85, 88, 25],
        ["Mice", 120, 80, 20]
      ];
      const dataRange = sheet.getRange("A1:D3");
      dataRange.setValues(data);
      
      // Create bubble chart - start with headers to create empty chart.
      const chart = sheet.addChart(
        ExcelScript.ChartType.bubble,
        sheet.getRange("B1:D1")
      );
      chart.setPosition("A5");
      chart.getTitle().setText("Product Analysis");
      
      // Remove any default series that were created.
      while (chart.getSeries().length > 0) {
        chart.getSeries()[0].delete();
      }
      
      // Add each product as its own series.
      for (let i = 2; i <= 3; i++) {
        const productName = sheet.getRange(`A${i}`).getValue() as string;
        const newSeries = chart.addChartSeries(productName);
        newSeries.setXAxisValues(sheet.getRange(`B${i}:B${i}`));
        newSeries.setValues(sheet.getRange(`C${i}:C${i}`));
        newSeries.setBubbleSizes(sheet.getRange(`D${i}:D${i}`));
      }
    }
'ExcelScript.ChartSeries#getDataLabels:member(1)':
  - |-
    /**
     * This sample accesses and configures data labels for a series.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Configure data labels via series.
      const series = chart.getSeries()[0];
      const dataLabels = series.getDataLabels();
      dataLabels.setShowPercentage(true);
      dataLabels.setShowValue(false);
    }
'ExcelScript.ChartSeries#getFormat:member(1)':
  - |-
    /**
     * This sample gets the series format to customize appearance.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Customize the series color.
      const series = chart.getSeries()[0];
      const format = series.getFormat();
      format.getFill().setSolidColor("#B0C4DE");
    }
'ExcelScript.ChartSeries#getName:member(1)':
  - |-
    /**
     * This sample logs the names of each of the chart series in a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let chart = selectedSheet.getChart("ColumnClusteredChart");

      // Log the name of each chart series in the chart.
      let seriesList = chart.getSeries();
      seriesList.forEach((series) => {
        console.log(series.getName());
      });
    }
'ExcelScript.ChartSeries#getYErrorBars:member(1)':
  - |-
    /**
     * This script adds error bars for the standard error of each chart series point.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for the chart.
      const worksheet = workbook.getWorksheet("Sample");
      const dataRange = worksheet.getRange("A1:B15");

      // Create a line chart.
      const chart = worksheet.addChart(ExcelScript.ChartType.line, dataRange);

      // For each series, add error bars for the standard error on each point
      const allSeries = chart.getSeries();
      allSeries.forEach((series) => {
        series.getYErrorBars().setType(ExcelScript.ChartErrorBarsType.stError);
        series.getYErrorBars().setVisible(true);
      });
    }
'ExcelScript.ChartSeries#setBubbleSizes:member(1)':
  - |-
    /**
     * This sample sets bubble sizes for a bubble chart series.
     */
    function main(workbook: ExcelScript.Workbook) {
      const sheet = workbook.getActiveWorksheet();
      
      // Add sample data.
      const data = [
        ["Product", "Price ($)", "Quality Score", "Market Share"],
        ["Product A", 85, 88, 25]
      ];
      const dataRange = sheet.getRange("A1:D2");
      dataRange.setValues(data);
      
      // Create bubble chart.
      const chart = sheet.addChart(
        ExcelScript.ChartType.bubble,
        sheet.getRange("B1:D1")
      );
      chart.setPosition("A4");
      
      // Remove default series.
      while (chart.getSeries().length > 0) {
        chart.getSeries()[0].delete();
      }
      
      // Add series with bubble sizes.
      const newSeries = chart.addChartSeries("Product A");
      newSeries.setXAxisValues(sheet.getRange("B2:B2"));
      newSeries.setValues(sheet.getRange("C2:C2"));
      newSeries.setBubbleSizes(sheet.getRange("D2:D2"));
    }
'ExcelScript.ChartSeries#setHasDataLabels:member(1)':
  - |-
    /**
     * This sample enables data labels on a chart series.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Enable data labels on the series.
      const series = chart.getSeries()[0];
      series.setHasDataLabels(true);
    }
'ExcelScript.ChartSeries#setMarkerSize:member(1)':
  - |-
    /**
     * This sample sets the marker size for a line chart series.
     * This assumes the active worksheet has a line chart with markers.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the marker size for all series.
      const series = chart.getSeries();
      series.forEach((s) => {
        s.setMarkerSize(8);
      });
    }
'ExcelScript.ChartSeries#setMarkerStyle:member(1)':
  - |-
    /**
     * This sample sets the marker style for a line chart series.
     * This assumes the active worksheet has a line chart with markers.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the marker style to circle.
      const series = chart.getSeries()[0];
      series.setMarkerStyle(ExcelScript.ChartMarkerStyle.circle);
    }
'ExcelScript.ChartSeries#setName:member(1)':
  - |-
    /**
     * This sample sets the name of chart series.
     * This assumes the active worksheet has a chart with multiple series.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set names for all series.
      const seriesCollection = chart.getSeries();
      seriesCollection[0].setName("Solar");
      seriesCollection[1].setName("Wind");
      seriesCollection[2].setName("Hydro");
      seriesCollection[3].setName("Geothermal");
    }
'ExcelScript.ChartSeries#setOverlap:member(1)':
  - |-
    /**
     * This sample sets the overlap of the columns in a chart named "ColumnClusteredChart".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get an existing chart named "ColumnClusteredChart".
      let chart = selectedSheet.getChart("ColumnClusteredChart");

      // Set the overlap of every column of each series within a category.
      let seriesList = chart.getSeries();
      seriesList.forEach((series) => {
        // An overlap of 25 means the columns have 25% of their length overlapping with the adjacent columns in the same category.
        series.setOverlap(25);
      });
    }
'ExcelScript.ChartSeriesBy:enum':
  - |-
    /**
     * This script creates a clustered-column chart using an existing table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table on the current worksheet.
        const sheet = workbook.getActiveWorksheet();
        const table = sheet.getTables()[0];

        // Add a clustered-column chart that clusters the data based on the columns in the table.
        const chart = sheet.addChart(
            ExcelScript.ChartType.columnClustered,
            table.getRange(),
            ExcelScript.ChartSeriesBy.columns
        );   
    }
'ExcelScript.ChartSeriesFormat:interface':
  - |-
    /**
     * This sample gets the series format to customize fill and line properties.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Get series format and customize the fill color.
      const series = chart.getSeries()[0];
      const seriesFormat = series.getFormat();
      seriesFormat.getFill().setSolidColor("#B0C4DE");
    }
'ExcelScript.ChartTitle:interface':
  - |-
    /**
     * This sample accesses and customizes the chart title.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Customize the title.
      const title = chart.getTitle();
      title.setText("Quarterly Sales by Product");
      title.setVisible(true);
    }
'ExcelScript.ChartTitle#setText:member(1)':
  - |-
    /**
     * This sample sets the chart title text.
     * This assumes the active worksheet has a chart.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first chart on the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const chart = sheet.getCharts()[0];
      
      // Set the chart title.
      chart.getTitle().setText("Quarterly Sales by Product");
    }
'ExcelScript.ChartType:enum':
  - |-
    /**
     * This sample creates a column-clustered chart based on the current worksheet's data.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the data range.
      let range = selectedSheet.getUsedRange();

      // Insert a chart using the data on the current worksheet.
      let chart = selectedSheet.addChart(ExcelScript.ChartType.columnClustered, range);

      // Name the chart for easy access in other scripts.
      chart.setName("ColumnChart");
    }
'ExcelScript.ClearApplyTo:enum':
  - |-
    /**
     * This script removes any extra formatting that's been applied to a table. 
     * This leaves only the base table style effects.
     * Any formatting outside of the table will be left as is.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      let worksheet = workbook.getActiveWorksheet();
      let table = worksheet.getTables()[0];

      // Get the range used by the table.
      let range = table.getRange();

      // Clear all the formatting that is not applied by the table and the table style.
      range.clear(ExcelScript.ClearApplyTo.formats);
    }
'ExcelScript.CommentMention:interface':
  - |- 
    /**
     * This sample creates a comment that mentions a specific person.
     * That person will get a notification and link to the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const cell = currentSheet.getCell(0,0);
      
      /* Create a CommentMention object for the comment.
       *
       * A CommentMention's properties are:
       * `name`: The name of the person being mentioned.
       * `id`: The zero-based index of this mention in the comment.
       * `email`: The email address of the person being mentioned. 
       */
      const mention: ExcelScript.CommentMention = {
        name: "Alex",
        id: 0,
        email: "alex@contoso.com"
      };

      /* Create comment content that uses the mention. 
       * The `<at id="0">` syntax embeds the mention with ID 0 in the comment text. 
       * The name is displayed in the comment, 
       * while an email is sent to the given address.
       */
      const content: ExcelScript.CommentRichContent = {
        richContent: '<at id="0">' + mention.name + "</at> - Hello!",
        mentions: [mention]
      };

      // Add the comment.
      currentSheet.addComment(cell, content, ExcelScript.ContentType.mention);
    }
'ExcelScript.CommentRichContent#richContent:member':
  - |-
    /**
     * This sample finds overdue work items in a table and 
     * lets their owners know with a comment that uses an @mention.
     * 
     * This assumes the worksheet has a table with the columns: 
     * "Work Item", "Project", "Owner", "Due Date"
     */
    function main(workbook: ExcelScript.Workbook) {
      let currentSheet = workbook.getActiveWorksheet();

      // Get the "Owner" column range and values.
      let table = currentSheet.getTables()[0];
      let ownerColumnRange = table.getColumn("Owner").getRangeBetweenHeaderAndTotal();
      let ownerColumnValues = ownerColumnRange.getValues();

      // Get the "Due Date" column range and values.
      let dueDateColumnRange = table.getColumn("Due Date").getRangeBetweenHeaderAndTotal();
      let dueDateColumnValues = dueDateColumnRange.getValues();

      // Look for overdue work items.
      for (let row = 0; row < dueDateColumnValues.length; row++) {

        /* Convert the Excel date into a JavaScript date. 
         * This is necessary because Excel and JavaScript store
         * their dates as different numerical values.
         */
        let dueDate = new Date(Math.round((dueDateColumnValues[row][0] as number - 25569) * 86400 * 1000));

        // Check if the current date is greater than the due date.
        if (Date.now() > dueDate.valueOf()) {

          /* Create a CommentMention object for the comment,
           * based on the work item's owner.
           *
           * A CommentMention's properties are:
           * `name`: The name of the person being mentioned.
           * `id`: The index of this mention in the comment.
           * `email`: The email address of the person being mentioned. 
           *          In this sample, "Owner: is also the user name for the email.
           */
          let mention = {
            name: ownerColumnValues[row][0].toString(),
            id: 0,
            email: ownerColumnValues[row][0] + "@contoso.com"
          };

          /* Create the comment. 
           * The `<at id="0">` syntax embeds the mention in the comment text. 
           * The name is displayed in the comment, 
           * while an email is sent to the given address.
           *
           * The addComment parameters are:
           * `cellAddress`: The location of the comment.
           * `content`: The text of the comment and any embedded mentions.
           * `contentType`: The type of comment ("Mention" or "Plain").
           */
          currentSheet.addComment(
            dueDateColumnRange.getCell(row, 0),
            {
              richContent: '<at id="0">' + mention.name + "</at> - Your work item is overdue.",
              mentions: [mention]
            },
            ExcelScript.ContentType.mention
          );
        }
      }
    }
'ExcelScript.ConditionalCellValueOperator:enum':
  - |-
    /**
     * This script applies conditional formatting to a range.
     * That formatting is conditional upon the cell's numerical value.
     * Any value between 50 and 75 will have the cell fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const sheet = workbook.getActiveWorksheet();
      const ratingColumn = sheet.getRange("D2:D20");

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        ratingColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();
      
      // Set the format to apply when the condition is met.
      let format = cellValueConditionalFormatting.getFormat();
      format.getFill().setColor("yellow");
      format.getFont().setItalic(true);

      // Create the condition, in this case when the cell value is between 50 and 75.
      let rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "50",
        formula2: "75",
        operator: ExcelScript.ConditionalCellValueOperator.between
      };
      cellValueConditionalFormatting.setRule(rule);
    }
'ExcelScript.ConditionalCellValueRule:interface':
  - |-
    /**
     * This script applies conditional formatting to a range.
     * That formatting is conditional upon the cell's numerical value.
     * Any value between 50 and 75 will have the cell fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const sheet = workbook.getActiveWorksheet();
      const ratingColumn = sheet.getRange("D2:D20");

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        ratingColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();
      
      // Create the condition, in this case when the cell value is between 50 and 75.
      let rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "50",
        formula2: "75",
        operator: ExcelScript.ConditionalCellValueOperator.between
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      let format = cellValueConditionalFormatting.getFormat();
      format.getFill().setColor("yellow");
      format.getFont().setItalic(true);
    }
'ExcelScript.ConditionalDataBarNegativeFormat:interface':
  - |-
    /**
     * This script applies data bar conditional formatting to a range.
     * It sets the data bar colors to be green when positive and red when negative.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the "Sales" data column range in a table named "SalesTable".
        const table = workbook.getTable("SalesTable");
        const salesRange = table.getColumnByName("Sales").getRangeBetweenHeaderAndTotal();

        // Add data bar conditional formatting to the range.
        const cf = salesRange.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);

        // Have the bar show green when positive and red when negative. 
        const dataBarConditionalFormat = cf.getDataBar();
        const positiveFormat: ExcelScript.ConditionalDataBarPositiveFormat = dataBarConditionalFormat.getPositiveFormat();
        positiveFormat .setFillColor("green");
        const negativeFormat: ExcelScript.ConditionalDataBarNegativeFormat = dataBarConditionalFormat.getNegativeFormat();
        negativeFormat.setFillColor("red");
    }
'ExcelScript.ConditionalDataBarPositiveFormat:interface':
  - |-
    /**
     * This script applies data bar conditional formatting to a range.
     * It sets the data bar colors to be green when positive and red when negative.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the "Sales" data column range in a table named "SalesTable".
        const table = workbook.getTable("SalesTable");
        const salesRange = table.getColumnByName("Sales").getRangeBetweenHeaderAndTotal();

        // Add data bar conditional formatting to the range.
        const cf = salesRange.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);

        // Have the bar show green when positive and red when negative. 
        const dataBarConditionalFormat = cf.getDataBar();
        const positiveFormat: ExcelScript.ConditionalDataBarPositiveFormat = dataBarConditionalFormat.getPositiveFormat();
        positiveFormat .setFillColor("green");
        const negativeFormat: ExcelScript.ConditionalDataBarNegativeFormat = dataBarConditionalFormat.getNegativeFormat();
        negativeFormat.setFillColor("red");
    }
'ExcelScript.ConditionalDataBarRule:interface':
  - |-
    /**
     * This script creates data bar conditional formatting on the selected range.
     * The scale of the data bar goes from 0 to 1000.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      const selected = workbook.getSelectedRange();
      
      // Create new conditional formatting on the range.
      const format = selected.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);
      const dataBarFormat: ExcelScript.DataBarConditionalFormat = format.getDataBar();

      // Set the lower bound of the data bar formatting to be 0.
      const lowerBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "0"
      };
      dataBarFormat.setLowerBoundRule(lowerBound);

      // Set the upper bound of the data bar formatting to be 1000.
      const upperBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "1000"
      };
      dataBarFormat.setUpperBoundRule(upperBound);
    }
'ExcelScript.ConditionalFormat#getCellValue:member(1)':
  - |-
    /**
     * This script applies conditional formatting to a range.
     * That formatting is conditional upon the cell's numerical value.
     * Any value between 50 and 75 will have the cell fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const sheet = workbook.getActiveWorksheet();
      const ratingColumn = sheet.getRange("D2:D20");

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        ratingColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();
      
      // Create the condition, in this case when the cell value is between 50 and 75.
      let rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "50",
        formula2: "75",
        operator: ExcelScript.ConditionalCellValueOperator.between
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      let format = cellValueConditionalFormatting.getFormat();
      format.getFill().setColor("yellow");
      format.getFont().setItalic(true);

    }
'ExcelScript.ConditionalFormat#getColorScale:member(1)':
  - |-
    /**
     * This script applies a red, white, and blue color scale to the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      let selectedRange = workbook.getSelectedRange();

      // Create a new conditional formatting object by adding one to the range.
      let conditionalFormatting = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.colorScale);

      // Set the colors for the three parts of the scale: minimum, midpoint, and maximum.
      conditionalFormatting.getColorScale().setCriteria({
        minimum: {
          color:"#F8696B", /* A pale red. */
          type:ExcelScript.ConditionalFormatColorCriterionType.lowestValue
        },
        midpoint: {
          color: "#FCFCFF", /* Slightly off-white. */
          formula:'=50',type:ExcelScript.ConditionalFormatColorCriterionType.percentile
        },
        maximum: {
          color: "#5A8AC6", /* A pale blue. */
          type:ExcelScript.ConditionalFormatColorCriterionType.highestValue
        }
      });
    }
'ExcelScript.ConditionalFormat#getCustom:member(1)':
  - |-
    /**
     * This script applies a custom conditional formatting to the selected range.
     * A light-green fill is applied to a cell if the value is larger than the value in the row's previous column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected cells.
      let selectedRange = workbook.getSelectedRange();

      // Apply a rule for positive change from the previous column.
      let positiveChange = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.custom);
      positiveChange.getCustom().getFormat().getFill().setColor("lightgreen");
      positiveChange.getCustom().getRule().setFormula(`=${selectedRange.getCell(0, 0).getAddress()}>${selectedRange.getOffsetRange(0, -1).getCell(0, 0).getAddress()}`);
    }
'ExcelScript.ConditionalFormat#getDataBar:member(1)':
  - |-
    /**
     * This script creates data bar conditional formatting on the selected range.
     * The scale of the data bar goes from 0 to 1000.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      const selected = workbook.getSelectedRange();
      
      // Create new conditional formatting on the range.
      const format = selected.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);
      const dataBarFormat = format.getDataBar();

      // Set the lower bound of the data bar formatting to be 0.
      const lowerBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "0"
      };
      dataBarFormat.setLowerBoundRule(lowerBound);

      // Set the upper bound of the data bar formatting to be 1000.
      const upperBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "1000"
      };
      dataBarFormat.setUpperBoundRule(upperBound);
    }
'ExcelScript.ConditionalFormat#getIconSet:member(1)':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);

      // Use the "3 Traffic Lights (Unrimmed)" set.
      conditionalFormatting.getIconSet().setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      conditionalFormatting.getIconSet().setCriteria([
        {
          formula:'=0',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula:'=33',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent},
        {
          formula:'=67',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        }]);
    }
'ExcelScript.ConditionalFormat#getPreset:member(1)':
  - |-
    /**
     * This script applies a conditional format that uses a preset criterion.
     * Any cell in row 1 will have the color fill set to green if it is a duplicate value
     * (of anything else in row 1).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for row 1.
      const sheet = workbook.getActiveWorksheet();
      const formattedRange = sheet.getRange("1:1");

      // Add new conditional formatting to that range.
      const conditionalFormat = formattedRange.addConditionalFormat(
        ExcelScript.ConditionalFormatType.presetCriteria);

      // Set the conditional formatting to apply a green fill.
      const presetFormat = conditionalFormat.getPreset();
      presetFormat.getFormat().getFill().setColor("green");

      // Set a rule to apply the conditional format when values are duplicated in the range.
      const duplicateRule: ExcelScript.ConditionalPresetCriteriaRule = {
        criterion: ExcelScript.ConditionalFormatPresetCriterion.duplicateValues
      };
      presetFormat.setRule(duplicateRule);
    }
'ExcelScript.ConditionalFormat#getTextComparison:member(1)':
  - |-
    /**
     * This script adds conditional formatting to the first column in the worksheet.
     * This formatting gives the cells a green fill if they have text starting with "Excel".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first column in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const firstColumn = currentSheet.getRange("A:A");

      // Add conditional formatting based on the text in the cells.
      const textConditionFormat = 
        firstColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.containsText).getTextComparison();

      // Set the conditional format to provide a green fill.
      textConditionFormat.getFormat().getFill().setColor("green");

      // Apply the condition rule that the text begins with "Excel".
      const textRule: ExcelScript.ConditionalTextComparisonRule = {
        operator: ExcelScript.ConditionalTextOperator.beginsWith,
        text: "Excel"
      };
      textConditionFormat.setRule(textRule);
    }
'ExcelScript.ConditionalFormat#getTopBottom:member(1)':
  - |-
    /**
     * This script applies top/bottom conditional formatting to a range.
     * The top 2 values in the range will have the cell fill color changed to green.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const sheet = workbook.getWorksheet("TopBottom");
      const dataRange = sheet.getRange("B2:D5");

      // Set the fill color to green for the top 2 values in the range.
      const topBottomFormat = dataRange.addConditionalFormat(
        ExcelScript.ConditionalFormatType.topBottom).getTopBottom();
      topBottomFormat.getFormat().getFill().setColor("green");
      topBottomFormat.setRule({
        rank: 2, /* The numeric threshold. */
        type: ExcelScript.ConditionalTopBottomCriterionType.topItems /* The type of the top/bottom condition. */
      });
    }
'ExcelScript.ConditionalFormatColorCriterionType:enum':
  - |-
    /**
     * This script applies a red, white, and blue color scale to the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      let selectedRange = workbook.getSelectedRange();

      // Create a new conditional formatting object by adding one to the range.
      let conditionalFormatting = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.colorScale);

      // Set the colors for the three parts of the scale: minimum, midpoint, and maximum.
      conditionalFormatting.getColorScale().setCriteria({
        minimum: {
          color:"#F8696B", /* A pale red. */
          type:ExcelScript.ConditionalFormatColorCriterionType.lowestValue
        },
        midpoint: {
          color: "#FCFCFF", /* Slightly off-white. */
          formula:'=50',type:ExcelScript.ConditionalFormatColorCriterionType.percentile
        },
        maximum: {
          color: "#5A8AC6", /* A pale blue. */
          type:ExcelScript.ConditionalFormatColorCriterionType.highestValue
        }
      });
    }
'ExcelScript.ConditionalFormatIconRuleType:enum':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);

      // Use the "3 Traffic Lights (Unrimmed)" set.
      conditionalFormatting.getIconSet().setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      const criteria: ExcelScript.ConditionalIconCriterion[] = [
        {
          formula: '=0', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=33', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=67', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        }];
      conditionalFormatting.getIconSet().setCriteria(criteria);
    }
'ExcelScript.ConditionalFormatPresetCriterion:enum':
  - |-
    /**
     * This script applies a conditional format that uses a preset criterion.
     * Any cell in row 1 will have the color fill set to green if it is a duplicate value
     * (of anything else in row 1).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for row 1.
      const sheet = workbook.getActiveWorksheet();
      const formattedRange = sheet.getRange("1:1");

      // Add new conditional formatting to that range.
      const conditionalFormat = formattedRange.addConditionalFormat(
        ExcelScript.ConditionalFormatType.presetCriteria);

      // Set the conditional formatting to apply a green fill.
      const presetFormat = conditionalFormat.getPreset();
      presetFormat.getFormat().getFill().setColor("green");

      // Set a rule to apply the conditional format when values are duplicated in the range.
      const duplicateRule: ExcelScript.ConditionalPresetCriteriaRule = {
        criterion: ExcelScript.ConditionalFormatPresetCriterion.duplicateValues
      };
      presetFormat.setRule(duplicateRule);
    }
'ExcelScript.ConditionalFormatRule:interface':
  - |-
    /**
     * This script applies a custom conditional formatting to the selected range.
     * A light-green fill is applied to a cell if the value is larger than the value in the row's previous column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected cells.
      let selectedRange = workbook.getSelectedRange();

      // Apply a rule for positive change from the previous column.
      let positiveChange: ExcelScript.ConditionalFormat = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.custom);

      // Set the conditional format to be a lightgreen fill.
      let positiveCustom: ExcelScript.CustomConditionalFormat = positiveChange.getCustom();
      positiveCustom.getFormat().getFill().setColor("lightgreen");

      // Set the conditional rule to be if there is positive change across the row.
      let positiveRule: ExcelScript.ConditionalFormatRule = positiveCustom.getRule();
      positiveRule.setFormula(`=${selectedRange.getCell(0, 0).getAddress()}>${selectedRange.getOffsetRange(0, -1).getCell(0, 0).getAddress()}`);
    }
'ExcelScript.ConditionalFormatRuleType:enum':
  - |-
    /**
     * This script creates data bar conditional formatting on the selected range.
     * The scale of the data bar goes from 0 to 1000.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      const selected = workbook.getSelectedRange();
      
      // Create new conditional formatting on the range.
      const format = selected.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);
      const dataBarFormat = format.getDataBar();

      // Set the lower bound of the data bar formatting to be 0.
      const lowerBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "0"
      };
      dataBarFormat.setLowerBoundRule(lowerBound);

      // Set the upper bound of the data bar formatting to be 1000.
      const upperBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "1000"
      };
      dataBarFormat.setUpperBoundRule(upperBound);
    }
'ExcelScript.ConditionalFormatType:enum':
  - |-
    /**
     * This script applies a red, white, and blue color scale to the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      let selectedRange = workbook.getSelectedRange();

      // Create a new conditional formatting object by adding one to the range.
      let conditionalFormatting = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.colorScale);

      // Set the colors for the three parts of the scale: minimum, midpoint, and maximum.
      conditionalFormatting.getColorScale().setCriteria({
        minimum: {
          color:"#F8696B", /* A pale red. */
          type:ExcelScript.ConditionalFormatColorCriterionType.lowestValue
        },
        midpoint: {
          color: "#FCFCFF", /* Slightly off-white. */
          formula:'=50',type:ExcelScript.ConditionalFormatColorCriterionType.percentile
        },
        maximum: {
          color: "#5A8AC6", /* A pale blue. */
          type:ExcelScript.ConditionalFormatColorCriterionType.highestValue
        }
      });
    }
'ExcelScript.ConditionalIconCriterion:interface':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);

      // Use the "3 Traffic Lights (Unrimmed)" set.
      conditionalFormatting.getIconSet().setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      const criteria: ExcelScript.ConditionalIconCriterion[] = [
        {
          formula: '=0', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=33', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=67', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        }];
      conditionalFormatting.getIconSet().setCriteria(criteria);
    }
'ExcelScript.ConditionalIconCriterionOperator:enum':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);

      // Use the "3 Traffic Lights (Unrimmed)" set.
      conditionalFormatting.getIconSet().setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      const criteria: ExcelScript.ConditionalIconCriterion[] = [
        {
          formula: '=0', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=33', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula: '=67', operator: ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type: ExcelScript.ConditionalFormatIconRuleType.percent
        }];
      conditionalFormatting.getIconSet().setCriteria(criteria);
    }
'ExcelScript.ConditionalPresetCriteriaRule:interface':
  - |-
    /**
     * This script applies a conditional format that uses a preset criterion.
     * Any cell in row 1 will have the color fill set to green if it is a duplicate value
     * (of anything else in row 1).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for row 1.
      const sheet = workbook.getActiveWorksheet();
      const formattedRange = sheet.getRange("1:1");

      // Add new conditional formatting to that range.
      const conditionalFormat = formattedRange.addConditionalFormat(
        ExcelScript.ConditionalFormatType.presetCriteria);

      // Set the conditional formatting to apply a green fill.
      const presetFormat = conditionalFormat.getPreset();
      presetFormat.getFormat().getFill().setColor("green");

      // Set a rule to apply the conditional format when values are duplicated in the range.
      const duplicateRule: ExcelScript.ConditionalPresetCriteriaRule = {
        criterion: ExcelScript.ConditionalFormatPresetCriterion.duplicateValues
      };
      presetFormat.setRule(duplicateRule);
    }
'ExcelScript.ConditionalRangeFill:interface':
  - |-
    /**
     * This script applies cell value conditional formatting to a range.
     * Any value less than 60 will have the cell's fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const selectedRange = workbook.getSelectedRange();

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();

      // Create the condition, in this case when the cell value is less than 60.
      const rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "60",
        operator: ExcelScript.ConditionalCellValueOperator.lessThan
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      const format: ExcelScript.ConditionalRangeFormat = cellValueConditionalFormatting.getFormat();
      const fill: ExcelScript.ConditionalRangeFill = format.getFill();
      const font: ExcelScript.ConditionalRangeFont = format.getFont();
      fill.setColor("yellow");
      font.setItalic(true);
    }
'ExcelScript.ConditionalRangeFont:interface':
  - |-
    /**
     * This script applies cell value conditional formatting to a range.
     * Any value less than 60 will have the cell's fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const selectedRange = workbook.getSelectedRange();

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();

      // Create the condition, in this case when the cell value is less than 60.
      const rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "60",
        operator: ExcelScript.ConditionalCellValueOperator.lessThan
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      const format: ExcelScript.ConditionalRangeFormat = cellValueConditionalFormatting.getFormat();
      const fill: ExcelScript.ConditionalRangeFill = format.getFill();
      const font: ExcelScript.ConditionalRangeFont = format.getFont();
      fill.setColor("yellow");
      font.setItalic(true);
    }
'ExcelScript.ConditionalRangeFormat:interface':
  - |-
    /**
     * This script applies cell value conditional formatting to a range.
     * Any value less than 60 will have the cell's fill color changed and the font made italic.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range to format.
      const selectedRange = workbook.getSelectedRange();

      // Add cell value conditional formatting.
      const cellValueConditionalFormatting =
        selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.cellValue).getCellValue();

      // Create the condition, in this case when the cell value is less than 60.
      const rule: ExcelScript.ConditionalCellValueRule = {
        formula1: "60",
        operator: ExcelScript.ConditionalCellValueOperator.lessThan
      };
      cellValueConditionalFormatting.setRule(rule);

      // Set the format to apply when the condition is met.
      const format: ExcelScript.ConditionalRangeFormat = cellValueConditionalFormatting.getFormat();
      format.getFill().setColor("yellow");
      format.getFont().setItalic(true);
    }
'ExcelScript.ConditionalTextComparisonRule:interface':
  - |-
    /**
     * This script adds conditional formatting to the first column in the worksheet.
     * This formatting gives the cells a green fill if they have text starting with "Excel".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first column in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const firstColumn = currentSheet.getRange("A:A");

      // Add conditional formatting based on the text in the cells.
      const textConditionFormat = 
        firstColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.containsText).getTextComparison();

      // Set the conditional format to provide a green fill.
      textConditionFormat.getFormat().getFill().setColor("green");

      // Apply the condition rule that the text begins with "Excel".
      const textRule: ExcelScript.ConditionalTextComparisonRule = {
        operator: ExcelScript.ConditionalTextOperator.beginsWith,
        text: "Excel"
      };
      textConditionFormat.setRule(textRule);
    }
'ExcelScript.ConditionalTextOperator:enum':
  - |-
    /**
     * This script adds conditional formatting to the first column in the worksheet.
     * This formatting gives the cells a green fill if they have text starting with "Excel".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first column in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const firstColumn = currentSheet.getRange("A:A");

      // Add conditional formatting based on the text in the cells.
      const textConditionFormat = 
        firstColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.containsText).getTextComparison();

      // Set the conditional format to provide a green fill.
      textConditionFormat.getFormat().getFill().setColor("green");

      // Apply the condition rule that the text begins with "Excel".
      const textRule: ExcelScript.ConditionalTextComparisonRule = {
        operator: ExcelScript.ConditionalTextOperator.beginsWith,
        text: "Excel"
      };
      textConditionFormat.setRule(textRule);
    }
'ExcelScript.ConditionalTopBottomRule:interface':
  - |-
    /**
     * This sample applies conditional formatting to the currently used range in the worksheet. 
     * The conditional formatting is a pink fill for the 5 lowest values.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the used range in the worksheet.
      let range = selectedSheet.getUsedRange();

      // Set the fill color to pink for the lowest 5 values in the range.
      let conditionalFormat = range.addConditionalFormat(ExcelScript.ConditionalFormatType.topBottom)
      conditionalFormat.getTopBottom().getFormat().getFill().setColor("pink");
      conditionalFormat.getTopBottom().setRule({
        rank: 5, /* The numerical threshold. */
        type: ExcelScript.ConditionalTopBottomCriterionType.bottomItems /* The type of the top/bottom condition. */
      });
    }
'ExcelScript.ConnectorType:enum':
  - |- 
    /**
     * This script adds a line that goes from cell B2 to cell F4 on the current worksheet.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      const sheet = workbook.getActiveWorksheet();

      // Get the ranges for the two cells.
      const b2Range = sheet.getRange("B2");
      const f4Range = sheet.getRange("F4");

      // Add a straight line that connects the top-left corners of both cells.
      const line = sheet.addLine(
        b2Range.getLeft(),
        b2Range.getTop(),
        f4Range.getLeft(),
        f4Range.getTop(),
        ExcelScript.ConnectorType.straight);
    }
'ExcelScript.ContentType:enum':
  - |- 
    /**
     * This sample creates a comment that mentions a specific person.
     * That person will get a notification and link to the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const cell = currentSheet.getCell(0,0);
      
      /* Create a CommentMention object for the comment.
       *
       * A CommentMention's properties are:
       * `name`: The name of the person being mentioned.
       * `id`: The zero-based index of this mention in the comment.
       * `email`: The email address of the person being mentioned. 
       */
      const mention: ExcelScript.CommentMention = {
        name: "Alex",
        id: 0,
        email: "alex@contoso.com"
      };

      /* Create comment content that uses the mention.
       * The `<at id="0">` syntax embeds the mention with ID 0 in the comment text. 
       * The name is displayed in the comment, 
       * while an email is sent to the given address.
       */
      const content: ExcelScript.CommentRichContent = {
        richContent: '<at id="0">' + mention.name + "</at> - Hello!",
        mentions: [mention]
      };

      // Add the comment.
      currentSheet.addComment(cell, content, ExcelScript.ContentType.mention);
    }
'ExcelScript.CultureInfo:interface':
  - |-
    /**
     * This script sets the value of a cell to a date string for January 2, 2023.
     * It writes the day or month first in the string based on system settings.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Get the date format.
      const cultureInfo : ExcelScript.CultureInfo = workbook.getApplication().getCultureInfo();
      const systemDateTimeFormat : ExcelScript.DatetimeFormatInfo = cultureInfo.getDatetimeFormat();
      const shortDatePattern : string = systemDateTimeFormat.getShortDatePattern();

      // Determine if the date should start with the month or day.
      if (shortDatePattern.startsWith("m")) {
        cell.setValue("1/2/2023");
      } else {
        cell.setValue("2/1/2023");
      }
    }
'ExcelScript.CustomConditionalFormat:interface':
  - |-
    /**
     * This script applies a custom three-color conditional formatting to the selected range.
     * The three colors represent positive, negative, or no changes from the values in the previous column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected cells.
      let selectedRange = workbook.getSelectedRange();

      // Apply a rule for positive change from the previous column.
      let positiveChange: ExcelScript.ConditionalFormat = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.custom);
      let positiveCustom: ExcelScript.CustomConditionalFormat = positiveChange.getCustom();
      positiveCustom.getFormat().getFill().setColor("lightgreen");
      positiveCustom.getRule().setFormula(`=${selectedRange.getCell(0, 0).getAddress()}>${selectedRange.getOffsetRange(0, -1).getCell(0, 0).getAddress()}`);

      // Apply a rule for negative change from the previous column.
      let negativeChange: ExcelScript.ConditionalFormat = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.custom);
      let negativeCustom: ExcelScript.CustomConditionalFormat = negativeChange.getCustom();
      negativeCustom.getFormat().getFill().setColor("pink");
      negativeCustom.getRule().setFormula(`=${selectedRange.getCell(0, 0).getAddress()}<${selectedRange.getOffsetRange(0, -1).getCell(0, 0).getAddress()}`);

      // Apply a rule for no change from the previous column.
      let sameChange: ExcelScript.ConditionalFormat = selectedRange.addConditionalFormat(ExcelScript.ConditionalFormatType.custom);
      let sameCustom: ExcelScript.CustomConditionalFormat = sameChange.getCustom();
      sameCustom.getFormat().getFill().setColor("lightyellow");
      sameCustom.getRule().setFormula(`=${selectedRange.getCell(0, 0).getAddress()}=${selectedRange.getOffsetRange(0, -1).getCell(0, 0).getAddress()}`);
    }
'ExcelScript.CustomDataValidation:interface':
  - |-
    /**
     * This script adds data validation to a range.
     * The validation prevents duplicate entries within that range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "B2:B20".
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("B2:B20");

      // Set data validation on the range to prevent duplicate, non-blank entries.
      const dataValidation = range.getDataValidation();
      dataValidation.setIgnoreBlanks(true);
      const duplicateRule : ExcelScript.CustomDataValidation = { 
        formula: "=COUNTIF($B$2:$B$20, B2)=1"
      };
      dataValidation.setRule({
        custom: duplicateRule
      });
    }
'ExcelScript.DataBarConditionalFormat:interface':
  - |-
    /**
     * This script creates data bar conditional formatting on the selected range.
     * The scale of the data bar goes from 0 to 1000.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      const selected = workbook.getSelectedRange();
      
      // Create new conditional formatting on the range.
      const format = selected.addConditionalFormat(ExcelScript.ConditionalFormatType.dataBar);
      const dataBarFormat: ExcelScript.DataBarConditionalFormat = format.getDataBar();

      // Set the lower bound of the data bar formatting to be 0.
      const lowerBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "0"
      };
      dataBarFormat.setLowerBoundRule(lowerBound);

      // Set the upper bound of the data bar formatting to be 1000.
      const upperBound: ExcelScript.ConditionalDataBarRule = {
        type: ExcelScript.ConditionalFormatRuleType.number,
        formula: "1000"
      };
      dataBarFormat.setUpperBoundRule(upperBound);
    }
'ExcelScript.DataPivotHierarchy:interface':
  - |-
    /**
     *  This sample sorts the rows of a PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get an existing PivotTable.
      const pivotTable = workbook.getPivotTable("Farm Sales");

      // Get the data hierarchy to use as the basis of the sort.
      const valueFieldToSortOn: ExcelScript.DataPivotHierarchy = pivotTable.getDataHierarchy("Sum of Crates Sold Wholesale");

      // Get the row to sort.
      const rowToSort: ExcelScript.RowColumnPivotHierarchy = pivotTable.getRowHierarchy("Farm");

      // Sort the "Farm" row's only field by the values in "Sum of Crates Sold Wholesale".
      rowToSort.getFields()[0].sortByValues(ExcelScript.SortBy.descending, valueFieldToSortOn);
    }
'ExcelScript.DataPivotHierarchy#setSummarizeBy:member(1)':
  - |-
    /**
     * This script changes how the data in a PivotTable is aggregated.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first PivotTable in the workbook.
      const pivotTable = workbook.getPivotTables()[0];
      
      // Set the first data hierarchy to summarize with an average value, instead of a sum.
      const dataHierarchy = pivotTable.getDataHierarchies()[0];
      dataHierarchy.setSummarizeBy(ExcelScript.AggregationFunction.average);
    }
'ExcelScript.DataPivotHierarchy#setShowAs:member(1)':
  - |-
    /**
     * The script changes the display for "Crates Sold at Farm".
     * It shows the percentage of the grand total, 
     * instead of the default sum.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Pivot".
      const farmPivot = workbook.getPivotTable("Farm Pivot");

      // Get the data hierarchy "Sum of Crates Sold at Farm".
      const farmSales = farmPivot.getDataHierarchy("Sum of Crates Sold at Farm");

      // Show the data as a percentage of the grand total.
      farmSales.setShowAs({
        calculation: ExcelScript.ShowAsCalculation.percentOfGrandTotal
      });
    }
'ExcelScript.DataValidation#getType:member(1)':
  - |-
    /**
     * This sample reads and logs the data validation type of the currently selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the currently selected range.
      let range = workbook.getSelectedRange();

      // Get the type (`DataValidationType`) of data validation applied to the range.
      let validationType = range.getDataValidation().getType();

      /*
       * Log the data validation type.
       * If the range has a single value, it logs that type.
       * If the range doesn't have data validation applied, it logs "None".
       * If the range has multiple different types of data validation, it logs "Inconsistent" or "MixedCriteria".
       */
      console.log(validationType.toString());
    }
'ExcelScript.DataValidation#setPrompt:member(1)':
  - |-
    /**
     * This script creates a text prompt that's shown in C2:C8 when a user enters the cell.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the data validation object for C2:C8 in the current worksheet.
        let selectedSheet = workbook.getActiveWorksheet();
        let dataValidation = selectedSheet.getRange("C2:C8").getDataValidation();

        // Clear any previous validation to avoid conflicts.
        dataValidation.clear();

        // Create a prompt to remind users to only enter first names in this column.
        dataValidation.setPrompt({ 
            showPrompt: true, 
            title: "First names only", 
            message: "Only enter the first name of the employee, not the full name." 
        });
    }    
'ExcelScript.DataValidation#setRule:member(1)':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     * Attempts to enter other values are blocked and an error message appears.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);

      // Create an alert to appear when data other than positive numbers are entered.
      const positiveNumberOnlyAlert: ExcelScript.DataValidationErrorAlert = {
        message: "Positive numbers only",
        showAlert: true,
        style: ExcelScript.DataValidationAlertStyle.stop,
        title: "Invalid data"
      };
      rangeDataValidation.setErrorAlert(positiveNumberOnlyAlert);
    }
'ExcelScript.DataValidationAlertStyle:enum':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     * Attempts to enter other values are blocked and an error message appears.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);

      // Create an alert to appear when data other than positive numbers are entered.
      const positiveNumberOnlyAlert: ExcelScript.DataValidationErrorAlert = {
        message: "Positive numbers only",
        showAlert: true,
        style: ExcelScript.DataValidationAlertStyle.stop,
        title: "Invalid data"
      };
      rangeDataValidation.setErrorAlert(positiveNumberOnlyAlert);
    }
'ExcelScript.DataValidationErrorAlert:interface':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     * Attempts to enter other values are blocked and an error message appears.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);

      // Create an alert to appear when data other than positive numbers are entered.
      const positiveNumberOnlyAlert: ExcelScript.DataValidationErrorAlert = {
        message: "Positive numbers only",
        showAlert: true,
        style: ExcelScript.DataValidationAlertStyle.stop,
        title: "Invalid data"
      };
      rangeDataValidation.setErrorAlert(positiveNumberOnlyAlert);
    }
'ExcelScript.DataValidationOperator:enum':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);
    }
'ExcelScript.DataValidationPrompt:interface':
  - |-
    /**
     * This script creates a text prompt that's shown in C2:C8 when a user enters the cell.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the data validation object for C2:C8 in the current worksheet.
        let selectedSheet = workbook.getActiveWorksheet();
        let dataValidation = selectedSheet.getRange("C2:C8").getDataValidation();

        // Clear any previous validation to avoid conflicts.
        dataValidation.clear();

        // Create a prompt to remind users to only enter first names in this column.
        const prompt: ExcelScript.DataValidationPrompt = {
          showPrompt: true,
          title: "First names only",
          message: "Only enter the first name of the employee, not the full name."
        }
        dataValidation.setPrompt(prompt);
    }    
'ExcelScript.DataValidationRule#custom:member':
  - |-
    /**
     * This script adds data validation to a range.
     * The validation prevents duplicate entries within that range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "B2:B20".
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("B2:B20");

      // Set data validation on the range to prevent duplicate, non-blank entries.
      const dataValidation = range.getDataValidation();
      dataValidation.setIgnoreBlanks(true);
      const duplicateRule : ExcelScript.CustomDataValidation = { 
        formula: "=COUNTIF($B$2:$B$20, B2)=1"
      };
      dataValidation.setRule({
        custom: duplicateRule
      });
    }
'ExcelScript.DataValidationRule#list:member':
  - |-
    /**
     * This script creates a dropdown selection list for a cell.
     * It uses the existing values of the selected range as the choices for the list.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the values for data validation.
        const selectedRange = workbook.getSelectedRange();
        const rangeValues = selectedRange.getValues();

        // Convert the values into a comma-delimited string.
        let dataValidationListString = "";
        rangeValues.forEach((rangeValueRow) => {
            rangeValueRow.forEach((value) => {
                dataValidationListString += value + ",";
            });
        });

        // Clear the old range.
        selectedRange.clear(ExcelScript.ClearApplyTo.contents);

        // Apply the data validation to the first cell in the selected range.
        const targetCell = selectedRange.getCell(0, 0);
        const dataValidation = targetCell.getDataValidation();

        // Set the content of the dropdown list.
        let validationCriteria : ExcelScript.ListDataValidation = {
            inCellDropDown: true,
            source: dataValidationListString
        };
        let validationRule: ExcelScript.DataValidationRule = {
            list: validationCriteria
        };
        dataValidation.setRule(validationRule);
    }
'ExcelScript.DataValidationRule#wholeNumber:member':
  - |-
    /**
     * This script creates a data validation rule for the range B1:B5.
     * All values in that range must be a positive number.
     * Attempts to enter other values are blocked and an error message appears.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range B1:B5 in the active worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const positiveNumberOnlyCells = currentSheet.getRange("B1:B5");

      // Create a data validation rule to only allow positive numbers.
      const positiveNumberValidation: ExcelScript.BasicDataValidation = {
        formula1: "0",
        operator: ExcelScript.DataValidationOperator.greaterThan
      };
      const positiveNumberOnlyRule: ExcelScript.DataValidationRule = {
        wholeNumber: positiveNumberValidation
      };

      // Set the rule on the range.
      const rangeDataValidation = positiveNumberOnlyCells.getDataValidation();
      rangeDataValidation.setRule(positiveNumberOnlyRule);

      // Create an alert to appear when data other than positive numbers are entered.
      const positiveNumberOnlyAlert: ExcelScript.DataValidationErrorAlert = {
        message: "Positive numbers only",
        showAlert: true,
        style: ExcelScript.DataValidationAlertStyle.stop,
        title: "Invalid data"
      };
      rangeDataValidation.setErrorAlert(positiveNumberOnlyAlert);
    }
'ExcelScript.DataValidationType:enum':
  - |-
    /**
     * This sample reads and logs the data validation type of the currently selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the currently selected range.
      let range = workbook.getSelectedRange();

      // Get the type (`DataValidationType`) of data validation applied to the range.
      let validationType = range.getDataValidation().getType();

      /*
       * Log the data validation type.
       * If the range has a single value, it logs that type.
       * If the range doesn't have data validation applied, it logs "None".
       * If the range has multiple different types of data validation, it logs "Inconsistent" or "MixedCriteria".
       */
      console.log(validationType.toString());
    }
'ExcelScript.DateFilterCondition:enum':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters out rows 
     * that aren't from this month.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          // Setting the condition to `thisMonth` means items that are before or
          // after this month will not be displayed.
          condition: ExcelScript.DateFilterCondition.thisMonth
        }
      });
    }
'ExcelScript.DateTimeDataValidation:interface':
  - |-
    /**
     * This script sets a validation rule that only allows for certain dates to be entered.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the range D2:D6 in the current worksheet.
        const selectedSheet = workbook.getActiveWorksheet();
        const range = selectedSheet.getRange("D2:D6");

        // Set a validation rule to only allow values that are dates in the year 2023.
        let dataValidation = range.getDataValidation();
        const dateValidationRule: ExcelScript.DateTimeDataValidation = {
            formula1: "1/1/2023",
            formula2: "12/31/2023",
            operator: ExcelScript.DataValidationOperator.between
        };
        dataValidation.setRule({ date: dateValidationRule});

        // Set an appropriate error message.
        dataValidation.setErrorAlert({ 
            showAlert: true, 
            title: "2023 date required", 
            message: "Please enter a date in the year 2023.", 
            style: ExcelScript.DataValidationAlertStyle.stop
        });
    }
'ExcelScript.DatetimeFormatInfo:interface':
  - |-
    /**
     * This script sets the value of a cell to a date string for January 2, 2023.
     * It writes the day or month first in the string based on system settings.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Get the date format.
      const cultureInfo : ExcelScript.CultureInfo = workbook.getApplication().getCultureInfo();
      const systemDateTimeFormat : ExcelScript.DatetimeFormatInfo = cultureInfo.getDatetimeFormat();
      const shortDatePattern : string = systemDateTimeFormat.getShortDatePattern();

      // Determine if the date should start with the month or day.
      if (shortDatePattern.startsWith("m")) {
        cell.setValue("1/2/2023");
      } else {
        cell.setValue("2/1/2023");
      }
    }
'ExcelScript.DatetimeFormatInfo#getDateSeparator:member(1)':
  - |-
    /**
     * This script writes the current date, month, and year.
     * It uses the system's date separator character.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Get the date separation string.
      const cultureInfo = workbook.getApplication().getCultureInfo();
      const systemDateTimeFormat = cultureInfo.getDatetimeFormat();
      const separator = systemDateTimeFormat.getDateSeparator();

      // Get the current date.
      const currentDate = new Date(Date.now());

      // Write the date using the system's separator character.
      cell.setValue(`${currentDate.getMonth()}${separator}${currentDate.getDate()}${separator}${currentDate.getFullYear()}`);
    }
'ExcelScript.DatetimeFormatInfo#getLongDatePattern:member(1)':
  - |-
    /**
     * This script returns the system's long date pattern. 
     * This could be used in a Power Automate flow to keep date formatting consistent.
     */
    function main(workbook: ExcelScript.Workbook) : string {
        const cultureInfo = workbook.getApplication().getCultureInfo();
        const dateTimeInfo =  cultureInfo.getDatetimeFormat();
        
        return dateTimeInfo.getLongDatePattern();
    }
'ExcelScript.DatetimeFormatInfo#getTimeSeparator:member(1)':
  - |-
    /**
     * This script writes the current hour, minute, and second.
     * It uses the system's time separator character.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0, 0);

      // Get the date separation string.
      const cultureInfo = workbook.getApplication().getCultureInfo();
      const systemDateTimeFormat = cultureInfo.getDatetimeFormat();
      const separator = systemDateTimeFormat.getTimeSeparator();

      // Get the current time.
      const currentTime = new Date(Date.now());

      // Write the date using the system's separator character.
      cell.setValue(`${currentTime.getHours()}${separator}${currentTime.getMinutes()}${separator}${currentTime.getSeconds()}`);
    }
'ExcelScript.DeleteShiftDirection:enum':
  - |-
    /**
     * This sample creates a sample range, then deletes
     * "A1" using different DeleteShiftDirection values.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Add sample data to better visualize the delete changes.
      const currentSheet = workbook.getActiveWorksheet();
      currentSheet.getRange("A1:D4").setValues([
        [1,2,3,4],
        [5,6,7,8],
        [9,10,11,12],
        [13,14,15,16]]);

      // Delete A1 and shift the cells from the right to fill the space.
      // The value being deleted is 1.
      currentSheet.getRange("A1").delete(ExcelScript.DeleteShiftDirection.left);

      // Delete A1 and shift the cells from the bottom to fill the space.
      // The value being deleted is 2.
      currentSheet.getRange("A1").delete(ExcelScript.DeleteShiftDirection.up);

      // Log the sample range. The values should be:
      /*
        5, 3, 4, "",
        9, 6, 7, 8,
        13, 10, 11, 12,
        "", 14, 15, 16
      */
      console.log(currentSheet.getRange("A1:D4").getValues()); 
    }
'ExcelScript.DocumentProperties:interface':
  - |-
    /**
     * This script creates a new worksheet that displays some of the document properties.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the document properties.
        const properties: ExcelScript.DocumentProperties = workbook.getProperties();

        // Create a new worksheet called "Metadata".
        const newWorksheet = workbook.addWorksheet("Metadata");
        
        // Create an array to store the string values of properties to save.
        let values: string[][] = [];
        values.push(["Creation Date", properties.getCreationDate().toString()]);
        values.push(["Author", properties.getAuthor()]);
        values.push(["Last Edited By", properties.getLastAuthor()]);
        
        // Set the property values to a range on the new worksheet.
        newWorksheet.getRange("A1:B3").setValues(values);
    }
'ExcelScript.DocumentProperties#addCustomProperty:member(1)':
  - |-
    /**
     * This script adds a workbook-level custom property.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the property collection.
      const properties = workbook.getProperties();

      // Add a new property called "Project" with the value "FA".
      properties.addCustomProperty("Project", "FA");
    }
'ExcelScript.DocumentProperties#getCustomProperty:member(1)':
  - |-
    /**
     * This script gets a workbook-level custom property called "Project".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the property collection.
      const properties = workbook.getProperties();

      // Get the "Project" property.
      const project = properties.getCustomProperty("Project");

      // Show the property value in the console.
      console.log(project.getValue());
    }
'ExcelScript.DocumentPropertyType:enum':
  - |-
    /**
     * This script uses a custom property to set the value and formatting of a cell.
     * If the value of "Routing Number" is not set or is not a number, the cell will be red.
    */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell from Sheet1.
      const cell = workbook.getWorksheet("Sheet1").getCell(0,0);
      
      // Get the "Routing Number" property.
      const properties = workbook.getProperties();
      const routingNumber = properties.getCustomProperty("Routing Number");

      // If the property is missing or is not a number, change the formatting to indicate a problem.
      if (!routingNumber || routingNumber.getType() != ExcelScript.DocumentPropertyType.number) {
        cell.getFormat().getFill().setColor("red");
      }

      // If the property exists, use it to set the value of A1.
      if (routingNumber) {
        cell.setValue(routingNumber.getValue());
      }
    }
'ExcelScript.DynamicFilterCriteria:enum':
  - |-
    /**
     * This script applies a filter to a table that filters it 
     * to only show rows with dates from the previous month.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the table named "ReportTable".
      const table = workbook.getTable("ReportTable");

      // Get the column with the header "Date".
      const dateColumn = table.getColumnByName("Date");

      // Apply a dynamic filter to the column. 
      // `lastMonth` will only show rows with a date from the previous month.
      dateColumn.getFilter().applyDynamicFilter(ExcelScript.DynamicFilterCriteria.lastMonth);
    }
'ExcelScript.FillPattern:enum':
  - |-
    /**
     * This script sets a black-checkered fill on the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      const selected = workbook.getSelectedRange();
      selected.getFormat().getFill().setPattern(ExcelScript.FillPattern.checker);
      selected.getFormat().getFill().setPatternColor("black");
    }
'ExcelScript.Filter:interface':
  - |- 
    /**
     * This script adds a table filter to only show the top 10% of values 
     * belonging to a particular column.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table on the current worksheet.
        const table = workbook.getActiveWorksheet().getTables()[0];

        // Get the filter for the "PageViews" table column.
        const pageViewFilter : ExcelScript.Filter = table.getColumnByName("PageViews").getFilter();

        // Apply a filter to only show the rows with the top 10% of values in this column.
        pageViewFilter.applyTopPercentFilter(10);
    }
'ExcelScript.Filter#applyCustomFilter:member(1)':
  - |-
    /**
     * The script filters rows from a table based on numerical values.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Filter to only show rows with values in the "Sales" column that are 
      // greater than or equal to 2000.
      table.getColumnByName("Sales").getFilter().applyCustomFilter(">=2000");
    }
'ExcelScript.Filter#applyDynamicFilter:member(1)':
  - |-
    /**
     * This script applies a filter to a table that filters it 
     * to only show rows with dates from the previous month.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the table named "ReportTable".
      const table = workbook.getTable("ReportTable");

      // Get the column with the header "Date".
      const dateColumn = table.getColumnByName("Date");

      // Apply a dynamic filter to the column. 
      // `lastMonth` will only show rows with a date from the previous month.
      dateColumn.getFilter().applyDynamicFilter(ExcelScript.DynamicFilterCriteria.lastMonth);
    }
'ExcelScript.Filter#applyValuesFilter:member(1)':
  - |-
    /**
     * This script applies a filter to a table so that it only shows rows with "Needs Review" in the "Type" column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Apply the filter to the "Type" column.
      const typeColumn = table.getColumnByName("Type");
      typeColumn.getFilter().applyValuesFilter(["Needs Review"]);
    }
'ExcelScript.Filter#clear:member(1)':
  - |-
    /**
     * This script shows how to clear a filter from a table column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Clear the filter for the table column named "Status".
      const statusColumnFilter = table.getColumn("Status").getFilter();
      statusColumnFilter.clear();
    }
'ExcelScript.FilterCriteria#criterion1:member':
  - |-
    /**
     * This script creates an autoFilter on the worksheet that filters out rows based on column values. 
     * The autoFilter filters to only include rows that have a value in column C in the lowest 10 values 
     * (of column C values).
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const dataRange = currentSheet.getUsedRange();

      // Add a filter that will only show the rows with the lowest 10 values in column C
      // (index 2, assuming the used range spans from at least A:C).
      const filterCriteria: ExcelScript.FilterCriteria = {
        criterion1: "10",
        filterOn: ExcelScript.FilterOn.bottomItems
      };
      currentSheet.getAutoFilter().apply(dataRange, 2, filterCriteria);
    }
'ExcelScript.FilterDatetime:interface':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters it
     * to only show rows from between June 20th, 2022 and July 10th, 2022.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Create the filter's date boundaries.
      let earliestDate: ExcelScript.FilterDatetime = {
        date: "2022-06-20",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };
      let latestDate: ExcelScript.FilterDatetime = {
        date: "2022-07-10",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          condition: ExcelScript.DateFilterCondition.between,
          lowerBound: earliestDate,
          upperBound: latestDate
        }
      });
    }
'ExcelScript.FilterDatetimeSpecificity:enum':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters it
     * to only show rows from between June 20th, 2022 and July 10th, 2022.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Create the filter's date boundaries.
      let earliestDate: ExcelScript.FilterDatetime = {
        date: "2022-06-20",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };
      let latestDate: ExcelScript.FilterDatetime = {
        date: "2022-07-10",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          condition: ExcelScript.DateFilterCondition.between,
          lowerBound: earliestDate,
          upperBound: latestDate
        }
      });
    }
'ExcelScript.FilterOn:enum':
  - |-
    /**
     * This script applies a filter to a table so that 
     * only rows with values in column 1 that start with "L" are shown.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the autoFilter of the first table in the current worksheet.
      const table = workbook.getActiveWorksheet().getTables()[0];
      const autoFilter = table.getAutoFilter();

      // Filter to only include values that start with "L".
      const filterCriteria: ExcelScript.FilterCriteria = {
        filterOn: ExcelScript.FilterOn.custom,
        criterion1: "L*"
      };

      // Apply the filter to column 1 (zero-based).
      autoFilter.apply(table.getRange(), 1, filterCriteria);
    }
'ExcelScript.FilterOperator:enum':
  - |-
    /**
     * The script filters rows from a table based on a numerical range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Filter to only show rows with a value in the "Exam Score" column that is
      // greater than 0 and less than or equal to 60.
      table.getColumnByName("Exam Score").getFilter().applyCustomFilter(">0", "<=60", ExcelScript.FilterOperator.and);
    }
'ExcelScript.FilterPivotHierarchy:interface':
  - |-
    /**
     * This script creates a PivotTable with a filter.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the two worksheets to use in PivotTable creation.
      const dataSheet = workbook.getWorksheet("Data");
      const pivotSheet = workbook.getWorksheet("Pivot");

      // Create a new PivotTable.
      const newPivot = pivotSheet.addPivotTable(
        "My PivotTable", 
        dataSheet.getUsedRange(), 
        pivotSheet.getRange("A1"));

      // Add a filter with the Quarter field.
      const filter: ExcelScript.FilterPivotHierarchy = 
        newPivot.addFilterHierarchy(newPivot.getHierarchy("Quarter"));

      // Add other hierarchies...
    }
'ExcelScript.FilterPivotHierarchy#getName:member(1)':
  - |-
    /**
     * This script logs the names of all the filter hierarchies in a PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first PivotTable in the workbook.
        const pivotTable = workbook.getPivotTables()[0];

        // For each pivot filter, log its name.
        pivotTable.getFilterHierarchies().forEach((filter: ExcelScript.FilterPivotHierarchy) => {
          console.log(filter.getName());
        });
    }


'ExcelScript.GeometricShapeType:enum':
  - |-
    /**
     * This script creates a hexagon shape on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const hexagon: ExcelScript.Shape = 
        currentSheet.addGeometricShape(ExcelScript.GeometricShapeType.hexagon);
      
      // Set the hexagon size to 40x40 pixels.
      hexagon.setHeight(40);
      hexagon.setWidth(40);

      // Position the hexagon at [100,100] pixels.
      hexagon.setLeft(100);
      hexagon.setTop(100);
    }
'ExcelScript.GroupOption:enum':
  - |-
    /**
     * This script creates a two-level column-based outline on Sheet1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Group columns A-F in the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const firstLevel = sheet.getRange("A:F");
      firstLevel.group(ExcelScript.GroupOption.byColumns);
      
      // Create a second level to the outline by grouping subsections.
      sheet.getRange("A:B").group(ExcelScript.GroupOption.byColumns);
      sheet.getRange("D:E").group(ExcelScript.GroupOption.byColumns);
    }
'ExcelScript.HorizontalAlignment:enum':
  - |-
    /**
     * This script centers the text in a table's header row cells.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Get the header range.
      const headerRange = table.getHeaderRowRange();

      // Set the horizontal text alignment to `center`.
      headerRange.getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.center);
    }
'ExcelScript.IconSet:enum':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);

      // Use the "3 Traffic Lights (Unrimmed)" set.
      conditionalFormatting.getIconSet().setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      conditionalFormatting.getIconSet().setCriteria([
        {
          formula:'=0',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula:'=33',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent},
        {
          formula:'=67',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        }]);
    }
'ExcelScript.IconSetConditionalFormat:interface':
  - |-
    /**
     * This script applies icon set conditional formatting to a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range "A1:A5" on the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const range = sheet.getRange("A1:A5");

      // Create icon set conditional formatting on the range.
      const conditionalFormatting = range.addConditionalFormat(ExcelScript.ConditionalFormatType.iconSet);
      const iconSetFormat: ExcelScript.IconSetConditionalFormat = conditionalFormatting.getIconSet();
      // Use the "3 Traffic Lights (Unrimmed)" set.
      iconSetFormat.setStyle(ExcelScript.IconSet.threeTrafficLights1);

      // Set the criteria to use a different icon for the bottom, middle, and top thirds of the values in the range.
      iconSetFormat.setCriteria([
        {
          formula:'=0',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        },
        {
          formula:'=33',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent},
        {
          formula:'=67',operator:ExcelScript.ConditionalIconCriterionOperator.greaterThanOrEqual,
          type:ExcelScript.ConditionalFormatIconRuleType.percent
        }]);
    }
'ExcelScript.Image:interface':
  - |-
    /**
     * This script transfers an image from one worksheet to another.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the worksheet with the image on it.
      const firstWorksheet = workbook.getWorksheet("FirstSheet");

      // Get the first image from the worksheet.
      // If a script added the image, you could add a name to make it easier to find.
      let image: ExcelScript.Image;
      firstWorksheet.getShapes().forEach((shape, index) => {
        if (shape.getType() === ExcelScript.ShapeType.image) {
          image = shape.getImage();
          return;
        }
      });

      // Copy the image to another worksheet.
      image.getShape().copyTo("SecondSheet");
    }
'ExcelScript.ImageFittingMode:enum':
  - |-
    /**
     * This script returns an image of the first chart in the first worksheet.
     * That image is 600x400 pixels and the chart will be 
     * stretched to fill those dimensions.
     * The returned image can be used in a Power Automate flow.
     */
    function main(workbook: ExcelScript.Workbook): string {
      // Get the first chart in the first worksheet.
      const firstSheet = workbook.getFirstWorksheet();
      const firstChart = firstSheet.getCharts()[0];

      // Get an image of the chart as a base64-encoded string.
      const base64String = firstChart.getImage(
        600, /* Width */
        400, /* Height */
        ExcelScript.ImageFittingMode.fill /* Fill to match the dimensions. */
      );

      return base64String;
    }
'ExcelScript.InsertShiftDirection:enum':
  - |-
    /**
     * This script inserts headers at the top of the worksheet.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      let currentSheet = workbook.getActiveWorksheet();

      // Create headers for 3 columns.
      let myHeaders = [["NAME", "ID", "ROLE"]];

      // Add a blank first row and push existing data down a row.
      let firstRow = currentSheet.getRange("1:1");
      firstRow.insert(ExcelScript.InsertShiftDirection.down);

      // Add the headers.
      currentSheet.getRange("A1:C1").setValues(myHeaders);
    }
'ExcelScript.KeyboardDirection:enum':
  - |-
    /**
     * This script makes the font bold on all the contiguous cells between 
     * A1 and the bottom of the used range of the first column.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get every cell that's used between A1 and the end of the column.
      // This recreates the Ctrl+Shift+Down arrow key behavior.
      let firstCell = selectedSheet.getRange("A1");
      let firstColumn = firstCell.getExtendedRange(ExcelScript.KeyboardDirection.down);

      // Set the font to bold in that range.
      firstColumn.getFormat().getFont().setBold(true);
    }
'ExcelScript.LabelFilterCondition:enum':
  - |-
    /**
     * This script filters items that start with "L" from the "Type" field
     * of the "Farm Sales" PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable.
      const pivotTable = workbook.getActiveWorksheet().getPivotTable("Farm Sales");

      // Get the "Type" field.
      const field = pivotTable.getHierarchy("Type").getPivotField("Type");

      // Filter out any types that start with "L" (such as "Lemons" and "Limes").
      const filter: ExcelScript.PivotLabelFilter = {
        condition: ExcelScript.LabelFilterCondition.beginsWith,
        substring: "L",
        exclusive: true
      };

      // Apply the label filter to the field.
      field.applyFilter({ labelFilter: filter });
    }
'ExcelScript.LinkedWorkbook#breakLinks:member(1)':
  - |-
    /**
     * This script removes all links to other workbooks.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get all the linked workbook references.
        const externalWorkbooks: ExcelScript.LinkedWorkbook[] = workbook.getLinkedWorkbooks();
        console.log(`There are ${externalWorkbooks.length} other workbooks linked to from this workbook.`);

        // Remove all the links to those workbooks.
        // This changes the value of cells with workbook links to "#CONNECT!".
        externalWorkbooks.forEach((workbookLink) => {
            workbookLink.breakLinks();
        });
    }
'ExcelScript.ListDataValidation:interface':
  - |-
    /**
     * This script creates a dropdown selection list for a cell.
     * It uses the existing values of the selected range as the choices for the list.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the values for data validation.
        const selectedRange = workbook.getSelectedRange();
        const rangeValues = selectedRange.getValues();

        // Convert the values into a comma-delimited string.
        let dataValidationListString = "";
        rangeValues.forEach((rangeValueRow) => {
            rangeValueRow.forEach((value) => {
                dataValidationListString += value + ",";
            });
        });

        // Clear the old range.
        selectedRange.clear(ExcelScript.ClearApplyTo.contents);

        // Apply the data validation to the first cell in the selected range.
        const targetCell = selectedRange.getCell(0, 0);
        const dataValidation = targetCell.getDataValidation();

        // Set the content of the dropdown list.
        let validationCriteria : ExcelScript.ListDataValidation = {
            inCellDropDown: true,
            source: dataValidationListString
        };
        let validationRule: ExcelScript.DataValidationRule = {
            list: validationCriteria
        };
        dataValidation.setRule(validationRule);
    }
'ExcelScript.NamedItem:interface':
  - |-
    /**
     * This script creates a named formula and uses it in another part of the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a named item for a formula.
      // This formula is the sum of the cells F2:F21 on Sheet1.
      const namedItem: ExcelScript.NamedItem = workbook.addNamedItem(
        "GrandTotal", 
        "=SUM(Sheet1!$F$2:$F$21)", 
        "The sum of table sums."
      );

      // Add this named formula to a new sheet in the workbook.
      const otherSheet = workbook.addWorksheet();
      otherSheet.getRange("A1").setFormula(namedItem.getFormula());

      // Switch to the new worksheet.
      otherSheet.activate();
    }
'ExcelScript.NamedItem#getType:member(1)':
  - |-
    /**
     * This script looks for every named range with "Review" in the name 
     * and marks the range with a yellow fill.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Look at every named item in the workbook.
      workbook.getNames().forEach((namedItem) => {
        // Find names containing "Review".
        if (namedItem.getName().includes("Review")) {
          // Only change the fill color if the named item is a range (not a formula).
          let itemType: ExcelScript.NamedItemType = namedItem.getType();
          if (itemType === ExcelScript.NamedItemType.range) {
            // Set the range's fill color to yellow.
            namedItem.getRange().getFormat().getFill().setColor("yellow");
          }
        }
      });
    }
'ExcelScript.NamedItemType:enum':
  - |-
    /**
     * This script looks for every named range with "Review" in the name 
     * and marks the range with a yellow fill.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Look at every named item in the workbook.
      workbook.getNames().forEach((namedItem) => {
        // Find names containing "Review".
        if (namedItem.getName().includes("Review")) {
          // Only change the fill color if the named item is a range (not a formula).
          let itemType: ExcelScript.NamedItemType = namedItem.getType();
          if (itemType === ExcelScript.NamedItemType.range) {
            // Set the range's fill color to yellow.
            namedItem.getRange().getFormat().getFill().setColor("yellow");
          }
        }
      });
    }
'ExcelScript.NumberFormatCategory:enum':
  - |-
    /**
     * This script finds cells in a table column that are not formatted as currency
     * and sets the fill color to red.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Cost" column from the "Expenses" table.
      const table = workbook.getTable("Expenses");
      const costColumn = table.getColumnByName("Cost");
      const costColumnRange = costColumn.getRangeBetweenHeaderAndTotal();

      // Get the number format categories for the column's range.
      const numberFormatCategories = costColumnRange.getNumberFormatCategories();

      // If any cell in the column doesn't have a currency format, make the cell red.
      numberFormatCategories.forEach((category, index) =>{
        if (category[0] != ExcelScript.NumberFormatCategory.currency) {
          costColumnRange.getCell(index, 0).getFormat().getFill().setColor("red");
        }
      }); 
    }
'ExcelScript.PageLayout:interface':
  - |-
    /**
     * This script sets some basic page layout settings for printing.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout : ExcelScript.PageLayout = sheet.getPageLayout();

        // Turn off draft mode so images are printed.
        pageLayout.setDraftMode(false);
        
        // Print on 8.5"x11" paper.
        pageLayout.setPaperSize(ExcelScript.PaperType.letter);

        // Print every page with a landscape orientation.
        pageLayout.setOrientation(ExcelScript.PageOrientation.landscape);
      });
    }
'ExcelScript.PageLayout#setDraftMode:member(1)':
  - |-
    /**
     * This script turns off the print setting for draft mode.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();

        // Turn off draft mode so images are printed.
        pageLayout.setDraftMode(false);
      });
    }
'ExcelScript.PageLayout#setOrientation:member(1)':
  - |-
    /**
     * This script sets the printing orientation for the entire workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();

        // Print every page with a landscape orientation.
        pageLayout.setOrientation(ExcelScript.PageOrientation.landscape);
      });
    }
'ExcelScript.PageLayout#setPaperSize:member(1)':
  - |-
    /**
     * This script sets the page size for printing.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();
        // Print on 8.5"x11" paper.
        pageLayout.setPaperSize(ExcelScript.PaperType.letter);
      });
    }
'ExcelScript.PageLayout#setPrintComments:member(1)':
  - |-
    /**
     * This script makes the comments print at the end of the worksheet
     * when the workbook is printed.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Access every worksheet in the workbook.
      workbook.getWorksheets().forEach(worksheet => {
        // Get the page layout for each sheet.
        const layout = worksheet.getPageLayout();

        // Change the comment printing settings to print them at the end of the sheet.
        layout.setPrintComments(ExcelScript.PrintComments.endSheet);
      });
    }
'ExcelScript.PageLayout#setPrintOrder:member(1)':
  - |-
    /**
     * This script sets the print order for every worksheet in the workbook.
     * The order of printed content will go over (e.g., left-to-right) 
     * then down (i.e., top-to-bottom).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Access every worksheet in the workbook.
      workbook.getWorksheets().forEach(worksheet => {
        // Get the page layout for each sheet.
        const layout: ExcelScript.PageLayout = worksheet.getPageLayout();

        // Set the print order to over-then-down.
        layout.setPrintOrder(ExcelScript.PrintOrder.overThenDown);
      });
    }
'ExcelScript.PageLayout#setZoom:member(1)':
  - |-
    /**
     * This script changes the scale-to-fit of the page layout.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the current worksheet.
        const sheet = workbook.getActiveWorksheet();

        // Scale the layout to half size for printing.
        const layout = sheet.getPageLayout();
        const zoomOptions: ExcelScript.PageLayoutZoomOptions = {
            scale: 50
        }
        layout.setZoom(zoomOptions)
    }
'ExcelScript.PageLayoutZoomOptions:interface':
  - |-
    /**
     * This script changes the scale-to-fit of the page layout.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the current worksheet.
        const sheet = workbook.getActiveWorksheet();

        // Scale the layout to half size for printing.
        const layout = sheet.getPageLayout();
        const zoomOptions: ExcelScript.PageLayoutZoomOptions = {
            scale: 50
        }
        layout.setZoom(zoomOptions)
    }
'ExcelScript.PageOrientation:enum':
  - |-
    /**
     * This script sets the printing orientation for the entire workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();

        // Print every page with a landscape orientation.
        pageLayout.setOrientation(ExcelScript.PageOrientation.landscape);
      });
    }
'ExcelScript.PaperType:enum':
  - |-
    /**
     * This script sets the page size for printing.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();
        // Print on 8.5"x11" paper.
        pageLayout.setPaperSize(ExcelScript.PaperType.letter);
      });
    }
'ExcelScript.PictureFormat:enum':
  - |-
    /**
     * This script creates a star shape with the value from cell A1.
     * It then returns the image as a base64-encoded string. 
     * This string would be used as part of a Power Automate flow to add the image elsewhere.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the value of A1 from the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const value = sheet.getRange("A1").getValue();

      // Create a Shape object that looks like a 5-pointed star.
      const star = sheet.addGeometricShape(ExcelScript.GeometricShapeType.star5);

      // Set the text of star and make sure the shape fits the text.
      const textFrame = star.getTextFrame();
      textFrame.getTextRange().setText(value.toString());
      textFrame.setAutoSizeSetting(ExcelScript.ShapeAutoSize.autoSizeShapeToFitText);

      // Return the shape as a PNG image represented by a base64-encoded string.
      return star.getAsImage(ExcelScript.PictureFormat.png);
    }
'ExcelScript.PivotDateFilter#condition:member':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters out rows 
     * that aren't from this month.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          // Setting the condition to `thisMonth` means items that are before or
          // after this month will not be displayed.
          condition: ExcelScript.DateFilterCondition.thisMonth
        }
      });
    }
'ExcelScript.PivotDateFilter#lowerBound:member':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters it
     * to only show rows from between June 20th, 2022 and July 10th, 2022.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Create the filter's date boundaries.
      let earliestDate: ExcelScript.FilterDatetime = {
        date: "2022-06-20",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };
      let latestDate: ExcelScript.FilterDatetime = {
        date: "2022-07-10",
        specificity: ExcelScript.FilterDatetimeSpecificity.day
      };

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          condition: ExcelScript.DateFilterCondition.between,
          lowerBound: earliestDate,
          upperBound: latestDate
        }
      });
    }
'ExcelScript.PivotField#applyFilter:member(1)':
  - |-
    /**
     * This script applies a PivotValueFilter to the first row hierarchy in the PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable on the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let pivotTable = sheet.getPivotTables()[0];

      // Get the first row hierarchy to use as the field which gets filtered.
      let rowHierarchy = pivotTable.getRowHierarchies()[0];

      // Get the first data hierarchy to use as the values for filtering the rows.
      let dataHierarchy = pivotTable.getDataHierarchies()[0];

      // Create a filter that excludes values greater than 500.
      let filter: ExcelScript.PivotValueFilter = {
        condition: ExcelScript.ValueFilterCondition.greaterThan,
        comparator: 500,
        value: dataHierarchy.getName()
      };

      // Apply the filter.
      rowHierarchy.getPivotField(rowHierarchy.getName()).applyFilter({
        valueFilter: filter
      });
    }
'ExcelScript.PivotField#clearFilter:member(1)':
  - |-
    /**
     * This script gets the "Type" field from the "Farms Sales" PivotTable 
     * and clears the value filter from it.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the "Type" field.
      const typeField = pivot.getHierarchy("Type").getPivotField("Type");

      // Clear the value filter (if there is one) from the field.
      typeField.clearFilter(ExcelScript.PivotFilterType.value);
    }
'ExcelScript.PivotField#sortByValues:member(1)':
  - |-
    /**
     * This sample sorts the rows of a PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get an existing PivotTable.
      const pivotTable = workbook.getPivotTable("Farm Sales");

      // Get the data hierarchy to use as the basis of the sort.
      const valueFieldToSortOn = pivotTable.getDataHierarchy("Sum of Crates Sold Wholesale");

      // Get the row to sort.
      const rowToSort = pivotTable.getRowHierarchy("Farm");

      // Sort the "Farm" row's only field by the values in "Sum of Crates Sold Wholesale".
      rowToSort.getFields()[0].sortByValues(ExcelScript.SortBy.descending, valueFieldToSortOn);
    }
'ExcelScript.PivotFilters#dateFilter:member':
  - |-
    /**
     * This script applies a filter to a PivotTable that filters out rows 
     * that aren't from this month.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Date Recorded" field to filter. 
      // The data in this field must be dates in order for the filter to work.
      const pivot = workbook.getPivotTables()[0];
      const rowHierarchy = pivot.getRowHierarchy("Date Recorded");
      const rowField = rowHierarchy.getFields()[0];

      // Apply the date filter.
      rowField.applyFilter({
        dateFilter: {
          // Setting the condition to `thisMonth` means items that are before or
          // after this month will not be displayed.
          condition: ExcelScript.DateFilterCondition.thisMonth
        }
      });
    }
'ExcelScript.PivotFilters#labelFilter:member':
  - |-
    /**
     * This script filters items that start with "L" from the "Type" field
     * of the "Farm Sales" PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable.
      const pivotTable = workbook.getActiveWorksheet().getPivotTable("Farm Sales");

      // Get the "Type" field.
      const field = pivotTable.getHierarchy("Type").getPivotField("Type");

      // Filter out any types that start with "L" (such as "Lemons" and "Limes").
      const filter: ExcelScript.PivotLabelFilter = {
        condition: ExcelScript.LabelFilterCondition.beginsWith,
        substring: "L",
        exclusive: true
      };

      // Apply the label filter to the field.
      field.applyFilter({ labelFilter: filter });
    }
'ExcelScript.PivotFilters#manualFilter:member':
  - |-
    /**
     * This script adds a manual filter to a PivotTable. 
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the first PivotTable in the workbook.
      const pivot = workbook.getPivotTables()[0];

      // Get the hierarchy to use as the filter.
      const location = pivot.getHierarchy("Location");

      // Use "Location" as the FilterHierarchy.
      pivot.addFilterHierarchy(location);

      // Select items for the filter.
      // Note that hierarchies and fields have a 1:1 relationship in Excel,
      // so `getFields()[0]` always gets the correct field.
      location.getFields()[0].applyFilter({
        manualFilter: {
          selectedItems: ["Seattle", "Chicago"]
        }
      });
    }
'ExcelScript.PivotFilters#valueFilter:member':
  - |-
    /**
     * This script applies a PivotValueFilter to the first row hierarchy in the PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable on the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let pivotTable = sheet.getPivotTables()[0];

      // Get the first row hierarchy to use as the field which gets filtered.
      let rowHierarchy = pivotTable.getRowHierarchies()[0];

      // Get the first data hierarchy to use as the values for filtering the rows.
      let dataHierarchy = pivotTable.getDataHierarchies()[0];

      // Create a filter that excludes values greater than 500.
      let filter: ExcelScript.PivotValueFilter = {
        condition: ExcelScript.ValueFilterCondition.greaterThan,
        comparator: 500,
        value: dataHierarchy.getName()
      };

      // Apply the filter.
      rowHierarchy.getPivotField(rowHierarchy.getName()).applyFilter({
        valueFilter: filter
      });
    }
'ExcelScript.PivotFilterType:enum':
  - |-
    /**
     * This script gets the "Type" field from the "Farms Sales" PivotTable 
     * and clears the value filter from it.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the "Type" field.
      const typeField = pivot.getHierarchy("Type").getPivotField("Type");

      // Clear the value filter (if there is one) from the field.
      typeField.clearFilter(ExcelScript.PivotFilterType.value);
    }
'ExcelScript.PivotHierarchy:interface':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to a new worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];

      // Add the PivotTable to a new worksheet.
      let newSheet = workbook.addWorksheet("Pivot");
      let pivotTable = newSheet.addPivotTable("My Pivot", table, "A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.PivotLabelFilter:interface':
  - |-
    /**
     * This script filters items that start with "L" from the "Type" field
     * of the "Farm Sales" PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable.
      const pivotTable = workbook.getActiveWorksheet().getPivotTable("Farm Sales");

      // Get the "Type" field.
      const field = pivotTable.getHierarchy("Type").getPivotField("Type");

      // Filter out any types that start with "L" (such as "Lemons" and "Limes").
      const filter: ExcelScript.PivotLabelFilter = {
        condition: ExcelScript.LabelFilterCondition.beginsWith,
        substring: "L",
        exclusive: true
      };

      // Apply the label filter to the field.
      field.applyFilter({ labelFilter: filter });
    }
'ExcelScript.PivotLayout#getBodyAndTotalRange:member(1)':
  - |-
    /**
     * This sample finds the first PivotTable in the workbook and logs the values in the "Grand Total" cells.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first PivotTable in the workbook.
      let pivotTable = workbook.getPivotTables()[0];

      // Get the names of each data column in the PivotTable.
      let pivotColumnLabelRange = pivotTable.getLayout().getColumnLabelRange();

      // Get the range displaying the pivoted data.
      let pivotDataRange = pivotTable.getLayout().getBodyAndTotalRange();

      // Get the range with the "grand totals" for the PivotTable columns.
      let grandTotalRange = pivotDataRange.getLastRow();

      // Print each of the "Grand Totals" to the console.
      grandTotalRange.getValues()[0].forEach((column, columnIndex) => {
        console.log(`Grand total of ${pivotColumnLabelRange.getValues()[0][columnIndex]}: ${grandTotalRange.getValues()[0][columnIndex]}`);
        // Example log: "Grand total of Sum of Crates Sold Wholesale: 11000"
      });
    }
'ExcelScript.PivotLayout#setLayoutType:member(1)':
  - |-
    /**
     * This script sets the layout of the "Farms Sales" PivotTable to the "tabular"
     * setting. This places the fields from the Rows area in separate columns.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the PivotLayout object.
      const layout = pivot.getLayout();

      // Set the layout type to "tabular".
      layout.setLayoutType(ExcelScript.PivotLayoutType.tabular);
    }
'ExcelScript.PivotLayout#setSubtotalLocation:member(1)':
  - |-
    /**
     * This script displays group subtotals of the "Farms Sales" PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the PivotLayout object.
      const layout = pivot.getLayout();

      // Show all the subtotals at the bottom of each group.
      layout.setSubtotalLocation(ExcelScript.SubtotalLocationType.atBottom);
    }
'ExcelScript.PivotLayoutType:enum':
  - |-
    /**
     * This script sets the layout of the "Farms Sales" PivotTable to the "tabular"
     * setting. This places the fields from the Rows area in separate columns.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the PivotLayout object.
      const layout = pivot.getLayout();

      // Set the layout type to "tabular".
      layout.setLayoutType(ExcelScript.PivotLayoutType.tabular);
    }
'ExcelScript.PivotManualFilter:interface':
  - |-
    /**
     * This script adds a manual filter to a PivotTable. 
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the first PivotTable in the workbook.
      const pivot = workbook.getPivotTables()[0];

      // Get the hierarchy to use as the filter.
      const location = pivot.getHierarchy("Location");

      // Use "Location" as the FilterHierarchy.
      pivot.addFilterHierarchy(location);

      // Select items for the filter.
      const cityFilter: ExcelScript.PivotManualFilter = {
        selectedItems: ["Seattle", "Chicago"]
      };

      // Apply the filter
      // Note that hierarchies and fields have a 1:1 relationship in Excel, so `getFields()[0]` always gets the correct field.
      location.getFields()[0].applyFilter({
        manualFilter: cityFilter
      });
    }
'ExcelScript.PivotTable:interface':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to a new worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];

      // Add the PivotTable to a new worksheet.
      let newSheet = workbook.addWorksheet("Pivot");
      let pivotTable = newSheet.addPivotTable("My Pivot", table, "A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.PivotTable#addColumnHierarchy:member(1)':
  - |-
    /**
     * This script adds a row hierarchy to the PivotTable on the current worksheet.
     * This assumes the source data has columns named 
     * "Type", "Classification", and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable on the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let pivotTable = sheet.getPivotTables()[0];

      // Add the field "Type" to the PivotTable as a row hierarchy.
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));

      // Add the field "Classification" to the PivotTable as a column hierarchy.
      pivotTable.addColumnHierarchy(pivotTable.getHierarchy("Classification"));

      // Add the field "Sales" to the PivotTable as a data hierarchy.
      // By default, this displays the sums of the values in "Sales" based on the "Type".
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.PivotTable#addDataHierarchy:member(1)':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to a new worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];

      // Add the PivotTable to a new worksheet.
      let newSheet = workbook.addWorksheet("Pivot");
      let pivotTable = newSheet.addPivotTable("My Pivot", table, "A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.PivotTable#addFilterHierarchy:member(1)':
  - |-
    /**
     * This script adds a manual filter to a PivotTable. 
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the first PivotTable in the workbook.
      const pivot = workbook.getPivotTables()[0];

      // Get the hierarchy to use as the filter.
      const location = pivot.getHierarchy("Location");

      // Use "Location" as the FilterHierarchy.
      pivot.addFilterHierarchy(location);

      // Select items for the filter.
      // Note that hierarchies and fields have a 1:1 relationship in Excel,
      // so `getFields()[0]` always gets the correct field.
      location.getFields()[0].applyFilter({
        manualFilter: {
          selectedItems: ["Seattle", "Chicago"]
        }
      });
    }
'ExcelScript.PivotTable#addRowHierarchy:member(1)':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to a new worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];

      // Add the PivotTable to a new worksheet.
      let newSheet = workbook.addWorksheet("Pivot");
      let pivotTable = newSheet.addPivotTable("My Pivot", table, "A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.PivotTable#getLayout:member(1)':
  - |-
    /**
     * This script sets the layout of the "Farms Sales" PivotTable to the "tabular"
     * setting. This places the fields from the Rows area in separate columns.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the PivotLayout object.
      const layout = pivot.getLayout();

      // Set the layout type to "tabular".
      layout.setLayoutType(ExcelScript.PivotLayoutType.tabular);
    }
'ExcelScript.PivotTable#getRowHierarchy:member(1)':
  - |-
    /**
     * This sample sorts the rows of a PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get an existing PivotTable.
      const pivotTable = workbook.getPivotTable("Farm Sales");

      // Get the data hierarchy to use as the basis of the sort.
      const valueFieldToSortOn = pivotTable.getDataHierarchy("Sum of Crates Sold Wholesale");

      // Get the row to sort.
      const rowToSort = pivotTable.getRowHierarchy("Farm");

      // Sort the "Farm" row's only field by the values in "Sum of Crates Sold Wholesale".
      rowToSort.getFields()[0].sortByValues(ExcelScript.SortBy.descending, valueFieldToSortOn);
    }
'ExcelScript.PivotValueFilter:interface':
  - |-
    /**
     * This script applies a PivotValueFilter to the first row hierarchy in the PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable on the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let pivotTable = sheet.getPivotTables()[0];

      // Get the first row hierarchy to use as the field which gets filtered.
      let rowHierarchy = pivotTable.getRowHierarchies()[0];

      // Get the first data hierarchy to use as the values for filtering the rows.
      let dataHierarchy = pivotTable.getDataHierarchies()[0];

      // Create a filter that excludes values greater than 500.
      let filter: ExcelScript.PivotValueFilter = {
        condition: ExcelScript.ValueFilterCondition.greaterThan,
        comparator: 500,
        value: dataHierarchy.getName()
      };

      // Apply the filter.
      rowHierarchy.getPivotField(rowHierarchy.getName()).applyFilter({
        valueFilter: filter
      });
    }
'ExcelScript.Placement:enum':
  - |-
    /**
     * This script creates a diamond shape at cell C3.
     * The shape moves and resizes as the grid underneath it changes.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get cell C3 in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const cell = sheet.getRange("C3");

      // Create a diamond that slightly overlaps the cell C3.
      const diamond = sheet.addGeometricShape(ExcelScript.GeometricShapeType.diamond);
      // Set each dimension so that the shape extends 5 pixels beyond the cell borders.
      diamond.setLeft(cell.getLeft() - 5);
      diamond.setTop(cell.getTop() - 5);
      diamond.setHeight(cell.getHeight() + 10);
      diamond.setWidth(cell.getWidth() + 10);

      // Set the placement of the shape so that it resizes and moves with the grid.
      diamond.setPlacement(ExcelScript.Placement.twoCell);
    }
'ExcelScript.PresetCriteriaConditionalFormat:interface':
  - |-
    /**
     * This script applies a conditional format that uses a preset criterion.
     * Any cell in row 1 will have the color fill set to green if it is a duplicate value
     * (of anything else in row 1).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range for row 1.
      const sheet = workbook.getActiveWorksheet();
      const formattedRange = sheet.getRange("1:1");

      // Add new conditional formatting to that range.
      const conditionalFormat = formattedRange.addConditionalFormat(
        ExcelScript.ConditionalFormatType.presetCriteria);

      // Set the conditional formatting to apply a green fill.
      const presetFormat: ExcelScript.PresetCriteriaConditionalFormat = conditionalFormat.getPreset();
      presetFormat.getFormat().getFill().setColor("green");

      // Set a rule to apply the conditional format when values are duplicated in the range.
      const duplicateRule: ExcelScript.ConditionalPresetCriteriaRule = {
        criterion: ExcelScript.ConditionalFormatPresetCriterion.duplicateValues
      };
      presetFormat.setRule(duplicateRule);
    }
'ExcelScript.PrintComments:enum':
  - |-
    /**
     * This script makes the comments print at the end of the worksheet
     * when the workbook is printed.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Access every worksheet in the workbook.
      workbook.getWorksheets().forEach(worksheet => {
        // Get the page layout for each sheet.
        const layout = worksheet.getPageLayout();

        // Change the comment printing settings to print them at the end of the sheet.
        layout.setPrintComments(ExcelScript.PrintComments.endSheet);
      });
    }
'ExcelScript.PrintOrder:enum':
  - |-
    /**
     * This script sets the print order for every worksheet in the workbook.
     * The order of printed content will go over (e.g., left-to-right) 
     * then down (i.e., top-to-bottom).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Access every worksheet in the workbook.
      workbook.getWorksheets().forEach(worksheet => {
        // Get the page layout for each sheet.
        const layout: ExcelScript.PageLayout = worksheet.getPageLayout();

        // Set the print order to over-then-down.
        layout.setPrintOrder(ExcelScript.PrintOrder.overThenDown);
      });
    }
'ExcelScript.ProtectionSelectionMode:enum':
  - |-
    /**
     * This script protects cells from being selected on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the protection settings for the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const sheetProtection = currentSheet.getProtection();

      // Create a new WorksheetProtectionOptions object with the selectionMode property set to `none`.
      let protectionOptions : ExcelScript.WorksheetProtectionOptions = {
        selectionMode: ExcelScript.ProtectionSelectionMode.none
      }

      // Apply the given protection options.
      sheetProtection.protect(protectionOptions);
    }
'ExcelScript.Query:interface':
  - |-
    /**
     * This script logs information about all the Power Query queries in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the Power Query queries in the workbook.
      const queries = workbook.getQueries();

      // For each query, log the date it was last refreshed.
      queries.forEach((query: ExcelScript.Query) => {
        console.log(`Query ${query.getName()} - last refreshed ${query.getRefreshDate()}`);
      });
    }
'ExcelScript.Range:interface':
  - |-
    /**
     * This script logs the address of the used range in the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      let currentWorksheet = workbook.getActiveWorksheet();

      // Get the range containing all the cells with data or formatting.
      let usedRange = currentWorksheet.getUsedRange();

      // Log the range's address to the console.
      console.log(usedRange.getAddress());
    }
'ExcelScript.Range#addConditionalFormat:member(1)':
  - |-
    /**
     * This sample applies conditional formatting to the currently used range in the worksheet. 
     * The conditional formatting is a green fill for the top 10% of values.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the used range in the worksheet.
      let range = selectedSheet.getUsedRange();

      // Set the fill color to green for the top 10% of values in the range.
      let conditionalFormat = range.addConditionalFormat(ExcelScript.ConditionalFormatType.topBottom)
      conditionalFormat.getTopBottom().getFormat().getFill().setColor("green");
      conditionalFormat.getTopBottom().setRule({
        rank: 10, // The percentage threshold.
        type: ExcelScript.ConditionalTopBottomCriterionType.topPercent // The type of the top/bottom condition.
      });
    }
'ExcelScript.Range#autoFill:member(1)':
  - |-
    /**
     * This script uses the autofill feature to complete a table.
     * See https://support.microsoft.com/office/74e31bdd-d993-45da-aa82-35a236c5b5db
     * for examples of autofill scenarios.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      let currentWorksheet = workbook.getActiveWorksheet();

      // Get the data range that shows the pattern.
      let dataRange = currentWorksheet.getRange("C2:C3");

      // Autofill the connected range. C2:C3 are filled in. C4:C14 are blank.
      // This uses the default behavior to match a pattern with the table's contents.
      dataRange.autoFill("C2:C14");
    }
'ExcelScript.Range#calculate:member(1)':
  - |-
    /**
     * This script recalculates the used range of a specific worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Only recalculate if the calculation mode is not set to automatic.
      if (workbook.getApplication().getCalculationMode() !== ExcelScript.CalculationMode.automatic) {
        // Get the used range from a worksheet named "Monthly Report".
        const sheet = workbook.getWorksheet("Monthly Report");
        const range = sheet.getUsedRange();
        console.log(`Calculating ${range.getAddress()}`);

        // Force all the used cells in that worksheet to calculate.
        sheet.getUsedRange().calculate();
      }
    }
'ExcelScript.Range#clear:member(1)':
  - |-
    /**
     * This script removes all the formatting from the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected range.
      let range = workbook.getSelectedRange();

      // Clear all the formatting in that range.
      range.clear(ExcelScript.ClearApplyTo.formats);
    }
'ExcelScript.Range#copyFrom:member(1)':
  - |-
    /**
     * This script copies a table from one worksheet to a new worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the worksheet named "TableTemplate".
      let base = workbook.getWorksheet("TableTemplate");
      
      // Get the range to be copied based on the first table.
      let tableRange = base.getTables()[0].getRange();

      // Get the area in a new worksheet for the new table.
      let newWorksheet = workbook.addWorksheet();
      let newRange = newWorksheet.getRangeByIndexes(0,0, tableRange.getRowCount(), tableRange.getColumnCount());

      // Copy the existing data into the new range.
      newRange.copyFrom(tableRange);
    }
'ExcelScript.Range#delete:member(1)':
  - |-
    /**
     * This sample creates a sample range, then deletes
     * "A1" using different DeleteShiftDirection values.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Add sample data to better visualize the delete changes.
      const currentSheet = workbook.getActiveWorksheet();
      currentSheet.getRange("A1:D4").setValues([
        [1,2,3,4],
        [5,6,7,8],
        [9,10,11,12],
        [13,14,15,16]]);

      // Delete A1 and shift the cells from the right to fill the space.
      // The value being deleted is 1.
      currentSheet.getRange("A1").delete(ExcelScript.DeleteShiftDirection.left);

      // Delete A1 and shift the cells from the bottom to fill the space.
      // The value being deleted is 2.
      currentSheet.getRange("A1").delete(ExcelScript.DeleteShiftDirection.up);

      // Log the sample range. The values should be:
      /*
        5, 3, 4, "",
        9, 6, 7, 8,
        13, 10, 11, 12,
        "", 14, 15, 16
      */
      console.log(currentSheet.getRange("A1:D4").getValues()); 
    }
'ExcelScript.Range#flashFill:member(1)':
  - |-
    /**
     * This script uses the Flash Fill feature to complete a table.
     * See https://support.microsoft.com/office/3f9bcf1e-db93-4890-94a0-1578341f73f7
     * for the example table.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      let currentWorksheet = workbook.getActiveWorksheet();

      // Get the data range with a pattern and cells to fill. C2 is filled in. C3:C6 are blank.
      let dataRange = currentWorksheet.getRange("C2:C6");

      // Flash fill the connected range. 
      dataRange.flashFill();
    }
'ExcelScript.Range#find:member(1)':
  - |-
    /**
     * This script searches through a table column and finds cells marked "no change". 
     * Those cells have "no change" replaced with the value from the cell to the left.
     * This script uses Range.find instead of Worksheet.findAll 
     * to limit the search to a specific range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range of a table named "Orders".
      let table = workbook.getTable("Orders");
      let range = table.getColumnByName("March").getRange();

      // Find all cells with the value "no change".
      let cellToOverwrite = range.find("no change", { completeMatch: true });
      while (cellToOverwrite) {
        let cellToCopyFrom = cellToOverwrite.getOffsetRange(0,-1);
        cellToOverwrite.setValue(cellToCopyFrom.getValue());
        cellToOverwrite = range.find("no change", { completeMatch: true });
      }
    }
'ExcelScript.Range#getAddress:member(1)':
  - |-
    /**
     * This script logs the address of the used range in each worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Iterate over every worksheet in the workbook.
      workbook.getWorksheets().forEach((sheet) => {
        // Get the used range for a single worksheet.
        let range = sheet.getUsedRange();

        // Print the address of the used range to the console.
        console.log(range.getAddress());
      });
    }
'ExcelScript.Range#getBoundingRect:member(1)':
  - |-
    /**
     * This script gets the bounding range of two existing ranges and puts a border around it.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let sheet = workbook.getActiveWorksheet();

      // Create two range objects for the sample.
      let range1 = sheet.getRange("B2:C5");
      let range2 = sheet.getRange("D10:E15");

      // Get the rectangular range that fully includes both ranges.
      let boundingRectangle = range1.getBoundingRect(range2);

      // Add a border around the whole bounding range (B2:E15).
      let format = boundingRectangle.getFormat();
      format.getRangeBorder(ExcelScript.BorderIndex.edgeTop).setStyle(ExcelScript.BorderLineStyle.continuous); // Top border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom).setStyle(ExcelScript.BorderLineStyle.continuous); // Bottom border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft).setStyle(ExcelScript.BorderLineStyle.continuous); // Left border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeRight).setStyle(ExcelScript.BorderLineStyle.continuous); // Right border
    }
'ExcelScript.Range#getColumnCount:member(1)':
  - |-
    /**
     * This sample provides the count of negative numbers that are present
     * in the used range of the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the working range.
      let usedRange = workbook.getActiveWorksheet().getUsedRange();
      let rowCount = usedRange.getRowCount();
      let columnCount = usedRange.getColumnCount();

      // Save the values locally to avoid repeatedly asking the workbook.
      let usedRangeValues = usedRange.getValues();

      // Start the negative number counter.
      let negativeCount = 0;

      // Iterate over the entire range looking for negative numbers.
      for (let i = 0; i < rowCount; i++) {
        for (let j = 0; j < columnCount; j++) {
          if (usedRangeValues[i][j] < 0) {
            negativeCount++;
          }
        }
      }

      // Log the negative number count to the console.
      console.log(negativeCount);
    }
'ExcelScript.Range#getDataValidation:member(1)':
  - |-
    /**
     * This script creates a drop-down selection list for a cell. It uses the existing values of the selected range as the choices for the list.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the values for data validation.
      let selectedRange = workbook.getSelectedRange();
      let rangeValues = selectedRange.getValues();

      // Convert the values into a comma-delimited string.
      let dataValidationListString = "";
      rangeValues.forEach((rangeValueRow) => {
        rangeValueRow.forEach((value) => {
          dataValidationListString += value + ",";
        });
      });

      // Clear the old range.
      selectedRange.clear(ExcelScript.ClearApplyTo.contents);

      // Apply the data validation to the first cell in the selected range.
      let targetCell = selectedRange.getCell(0,0);
      let dataValidation = targetCell.getDataValidation();

      // Set the content of the drop-down list.
      dataValidation.setRule({
          list: {
            inCellDropDown: true,
            source: dataValidationListString
          }
        });
    }
'ExcelScript.Range#getDirectPrecedents:member(1)':
  - |-
    /**
     * This script finds the direct precedents of the active cell.
     * It changes the font and color of those precedent cells. 
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active cell.
      const selected = workbook.getActiveCell();
      
      // Get the cells that are direct precedents of the current cell.
      const precedents : ExcelScript.WorkbookRangeAreas = selected.getDirectPrecedents();

      // Set the font to bold and the fill color to orange for all the precedent cells.
      precedents.getRanges().forEach(range => {
        range.getFormat().getFill().setColor("orange");
        range.getFormat().getFont().setBold(true);
      });
    }
'ExcelScript.Range#getExtendedRange:member(1)':
  - |-
    /**
     * This script makes the font bold on all the contiguous cells between 
     * A1 and the bottom of the used range of the first column.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get every cell that's used between A1 and the end of the column.
      // This recreates the Ctrl+Shift+Down arrow key behavior.
      let firstCell = selectedSheet.getRange("A1");
      let firstColumn = firstCell.getExtendedRange(ExcelScript.KeyboardDirection.down);

      // Set the font to bold in that range.
      firstColumn.getFormat().getFont().setBold(true);
    }
'ExcelScript.Range#getFormat:member(1)':
  - |-
    /**
     * This script gives the total row of a table a green color fill.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      let table = workbook.getTables()[0];

      // Get the range for the total row of the table.
      let totalRange = table.getTotalRowRange();

      // Set the fill color to green.
      totalRange.getFormat().getFill().setColor("green");
    }
'ExcelScript.Range#getFormula:member(1)':
  - |-
    /*
     * This script sets a cell's formula, 
     * then displays how Excel stores the cell's formula and value separately.
     */
    function main(workbook: ExcelScript.Workbook) {
      let selectedSheet = workbook.getActiveWorksheet();

      // Set A1 to 2.
      let a1 = selectedSheet.getRange("A1");
      a1.setValue(2);

      // Set B1 to the formula =(2*A1), which should equal 4.
      let b1 = selectedSheet.getRange("B1")
      b1.setFormula("=(2*A1)");

      // Log the current results for `getFormula` and `getValue` at B1.
      console.log(`B1 - Formula: ${b1.getFormula()} | Value: ${b1.getValue()}`);
    }
'ExcelScript.Range#getHyperlink:member(1)':
  - |-
    /**
     * This sample clears all of the hyperlinks from the current worksheet
     * and removes the usual hyperlink formatting.
     */
    function main(workbook: ExcelScript.Workbook, sheetName: string = 'Sheet1') {
      // Get the active worksheet. 
      let sheet = workbook.getWorksheet(sheetName);

      // Get the used range to operate on.
      // For large ranges (over 10000 entries), consider splitting the operation into batches for performance.
      const targetRange = sheet.getUsedRange(true);
      console.log(`Target Range to clear hyperlinks from: ${targetRange.getAddress()}`);

      const rowCount = targetRange.getRowCount();
      const colCount = targetRange.getColumnCount();
      console.log(`Searching for hyperlinks in ${targetRange.getAddress()} which contains ${(rowCount * colCount)} cells`);

      // Go through each individual cell looking for a hyperlink. 
      // This allows us to limit the formatting changes to only the cells with hyperlink formatting.
      let clearedCount = 0;
      for (let i = 0; i < rowCount; i++) {
        for (let j = 0; j < colCount; j++) {
          const cell = targetRange.getCell(i, j);
          const hyperlink = cell.getHyperlink();
          if (hyperlink) {
            cell.clear(ExcelScript.ClearApplyTo.hyperlinks);
            cell.getFormat().getFont().setUnderline(ExcelScript.RangeUnderlineStyle.none);
            cell.getFormat().getFont().setColor('Black');
            clearedCount++;
          }
        }
      }

      console.log(`Done. Cleared hyperlinks from ${clearedCount} cells`);
    }
'ExcelScript.Range#getNumberFormatCategories:member(1)':
  - |-
    /**
     * This script finds cells in a table column that are not formatted as currency
     * and sets the fill color to red.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Cost" column from the "Expenses" table.
      const table = workbook.getTable("Expenses");
      const costColumn = table.getColumnByName("Cost");
      const costColumnRange = costColumn.getRangeBetweenHeaderAndTotal();

      // Get the number format categories for the column's range.
      const numberFormatCategories = costColumnRange.getNumberFormatCategories();

      // If any cell in the column doesn't have a currency format, make the cell red.
      numberFormatCategories.forEach((category, index) =>{
        if (category[0] != ExcelScript.NumberFormatCategory.currency) {
          costColumnRange.getCell(index, 0).getFormat().getFill().setColor("red");
        }
      }); 
    }
'ExcelScript.Range#getOffsetRange:member(1)':
  - |-
    /**
     * This script gets adjacent cells using relative references.
     * Note that if the active cell is on the top row, part of the script fails, 
     * because it references the cell above the currently selected one.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the currently active cell in the workbook.
      let activeCell = workbook.getActiveCell();
      console.log(`The active cell's address is: ${activeCell.getAddress()}`);

      // Get the cell to the right of the active cell and set its value and color.
      let rightCell = activeCell.getOffsetRange(0,1);
      rightCell.setValue("Right cell");
      console.log(`The right cell's address is: ${rightCell.getAddress()}`);
      rightCell.getFormat().getFont().setColor("Magenta");
      rightCell.getFormat().getFill().setColor("Cyan");

      // Get the cell to the above of the active cell and set its value and color.
      // Note that this operation will fail if the active cell is in the top row.
      let aboveCell = activeCell.getOffsetRange(-1, 0);
      aboveCell.setValue("Above cell");
      console.log(`The above cell's address is: ${aboveCell.getAddress()}`);
      aboveCell.getFormat().getFont().setColor("White");
      aboveCell.getFormat().getFill().setColor("Black");
    }
'ExcelScript.Range#getRangeEdge:member(1)':
  - |-
    /**
     * This script adds the value "Total" after the end of the first column.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the last used cell at the end of the column.
      // This recreates the Ctrl+Down arrow key behavior.
      let firstCell = selectedSheet.getRange("A1");
      let firstColumn = selectedSheet.getRange("A1").getRangeEdge(ExcelScript.KeyboardDirection.down);
      let cellAfter = firstColumn.getOffsetRange(1, 0);

      // Set the value of the cell after the current end of the used column to "Total".
      cellAfter.setValue("Total");
    }
'ExcelScript.Range#getResizedRange:member(1)':
  - |-
    /**
     * This script copies the formatting in the active cell to the neighboring cells.
     * Note that this script only works when the active cell isn't on an edge of the worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active cell.
      let activeCell = workbook.getActiveCell();

      // Get the cell that's one row above and one column to the left of the active cell.
      let cornerCell = activeCell.getOffsetRange(-1,-1);

      // Get a range that includes all the cells surrounding the active cell.
      let surroundingRange = cornerCell.getResizedRange(2, 2)

      // Copy the formatting from the active cell to the new range.
      surroundingRange.copyFrom(
        activeCell, /* The source range. */
        ExcelScript.RangeCopyType.formats /* What to copy. */
      );
    }
'ExcelScript.Range#getRowCount:member(1)':
  - |-
    /**
     * This sample provides the count of negative numbers that are present
     * in the used range of the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the working range.
      let usedRange = workbook.getActiveWorksheet().getUsedRange();
      let rowCount = usedRange.getRowCount();
      let columnCount = usedRange.getColumnCount();

      // Save the values locally to avoid repeatedly asking the workbook.
      let usedRangeValues = usedRange.getValues();

      // Start the negative number counter.
      let negativeCount = 0;

      // Iterate over the entire range looking for negative numbers.
      for (let i = 0; i < rowCount; i++) {
        for (let j = 0; j < columnCount; j++) {
          if (usedRangeValues[i][j] < 0) {
            negativeCount++;
          }
        }
      }

      // Log the negative number count to the console.
      console.log(negativeCount);
    }
'ExcelScript.Range#getSpecialCells:member(1)':
  - |-
    /**
     * This sample gets all the blank cells in the current worksheet's used range. It then highlights all those cells with a yellow background.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the current used range.
        let range = workbook.getActiveWorksheet().getUsedRange();
        
        // Get all the blank cells.
        let blankCells = range.getSpecialCells(ExcelScript.SpecialCellType.blanks);
        // Highlight the blank cells with a yellow background.
        blankCells.getFormat().getFill().setColor("yellow");
    }
'ExcelScript.Range#getValue:member(1)':
  - |-
    /**
     * This sample reads the value of A1 and prints it to the console.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the value of cell A1.
      let range = selectedSheet.getRange("A1");
      
      // Print the value of A1.
      console.log(range.getValue());
    }
'ExcelScript.Range#getValueType:member(1)':
  - |-
    /**
     * This script formats rows in a worksheet based on the first value in that row. 
     * If it's the boolean value TRUE, the row is bolded. 
     * If it's FALSE, nothing is changed. 
     * If the value type isn't a boolean, the row is italicized.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range in the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const usedRange = sheet.getUsedRange();

      // Get the values in the first column.
      const firstColumnValues = usedRange.getColumn(0).getValues();

      // Look at the first cell in each row.
      const rowCount = usedRange.getRowCount();
      for (let i = 0; i < rowCount; i++) {
        // Get the type of the first cell to make sure it's a boolean.
        let firstValueType = usedRange.getCell(i, 0).getValueType();

        // Set the bold or italic of the row as described earlier.
        if (firstValueType === ExcelScript.RangeValueType.boolean) {
          if (firstColumnValues[i][0] as boolean === true) {
            usedRange.getRow(i).getFormat().getFont().setBold(true);
          } else {
            usedRange.getRow(i).getFormat().getFont().setBold(false);
          }
        } else {
          usedRange.getRow(i).getFormat().getFont().setItalic(true);
        }
      }
    }
'ExcelScript.Range#getVisibleView:member(1)':
  - |-
    /**
     * This script copies values and formatting from the 
     * visible range of a table in Sheet1 into Sheet2.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the filtered data from Sheet1.
      const currentSheet = workbook.getWorksheet("Sheet1");
      const table = currentSheet.getTables()[0];
      const visibleTableRange: ExcelScript.RangeView = table.getRange().getVisibleView();
      const source = currentSheet.getRanges(visibleTableRange.getCellAddresses().toString());

      // Copy the data into the other sheet.
      const otherSheet = workbook.getWorksheet("Sheet2");
      const otherRangeCorner = otherSheet.getRange("A1");
      otherRangeCorner.copyFrom(source, ExcelScript.RangeCopyType.all);
    }
'ExcelScript.Range#group:member(1)':
  - |-
    /**
     * This script creates a two-level column-based outline on Sheet1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Group columns A-F in the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const firstLevel = sheet.getRange("A:F");
      firstLevel.group(ExcelScript.GroupOption.byColumns);
      
      // Create a second level to the outline by grouping subsections.
      sheet.getRange("A:B").group(ExcelScript.GroupOption.byColumns);
      sheet.getRange("D:E").group(ExcelScript.GroupOption.byColumns);
    }
'ExcelScript.Range#insert:member(1)':
  - |-
    /**
     * This script inserts headers at the top of the worksheet.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      let currentSheet = workbook.getActiveWorksheet();

      // Create headers for 3 columns.
      let myHeaders = [["NAME", "ID", "ROLE"]];

      // Add a blank first row and push existing data down a row.
      let firstRow = currentSheet.getRange("1:1");
      firstRow.insert(ExcelScript.InsertShiftDirection.down);

      // Add the headers.
      currentSheet.getRange("A1:C1").setValues(myHeaders);
    }
'ExcelScript.Range#merge:member(1)':
  - |-
    /**
     * This script merges a group of cells into a single region.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active worksheet.
      const selectedSheet = workbook.getActiveWorksheet();

      // Merge cells A1 through A4.
      const range = selectedSheet.getRange("A1:A4");
      range.merge();
    }
'ExcelScript.Range#removeDuplicates:member(1)':
  - |-
    /**
     * This script removes duplicate rows from a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range of the active worksheet.
      const usedRange = workbook.getActiveWorksheet().getUsedRange();

      // Remove any row that has a same value in the 0-indexed column as a previous row.
      const removedResults = usedRange.removeDuplicates([0], true);

      // Log the count of removed rows.
      console.log(`Rows removed: ${removedResults.getRemoved()}.`);
    }
'ExcelScript.Range#replaceAll:member(1)':
  - |-
    /**
     * This script searches through a table column and replaces  
     * cells marked "monthly special" with "parsnip".
     * This script uses Range.replaceAll instead of Worksheet.replaceAll
     * to limit the search to a specific range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range of a table named "Orders".
      let table = workbook.getTable("Orders");
      let range = table.getColumnByName("Vegetable").getRange();
      
      // Change the value of any cells with the value "monthly special".
      range.replaceAll("monthly special", "parsnip", {completeMatch: true});
    }
'ExcelScript.Range#select:member(1)':
  - |-
    /**
     * This script selects the first row of a table.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const sheet = workbook.getActiveWorksheet()
      const table = sheet.getTables()[0];

      // Get the first data row in the table.
      const row = table.getRangeBetweenHeaderAndTotal().getRow(0);

      // Select the first data row.
      row.select();
    }
'ExcelScript.Range#setFormula:member(1)':
  - |-
    /*
     * This script sets a cell's formula, 
     * then displays how Excel stores the cell's formula and value separately.
     */
    function main(workbook: ExcelScript.Workbook) {
      let selectedSheet = workbook.getActiveWorksheet();

      // Set A1 to 2.
      let a1 = selectedSheet.getRange("A1");
      a1.setValue(2);

      // Set B1 to the formula =(2*A1), which should equal 4.
      let b1 = selectedSheet.getRange("B1")
      b1.setFormula("=(2*A1)");

      // Log the current results for `getFormula` and `getValue` at B1.
      console.log(`B1 - Formula: ${b1.getFormula()} | Value: ${b1.getValue()}`);
    }
'ExcelScript.Range#setFormulas:member(1)':
  - |-
    /**
     * This script sets the values of a range, then adds SUM formulas to calculate
     * the totals for each row of that range. 
     */
    function main(workbook: ExcelScript.Workbook)
    {
      let currentSheet = workbook.getActiveWorksheet();

      // Set the values of a range.
      let values = [[1, 2, 4], [8, 16, 32], [64, 128, 256]];
      let valueRange = currentSheet.getRange("A1:C3");
      valueRange.setValues(values);

      // Set the formulas of a range.
      let formulas = [["=SUM(A1:C1)"], ["=SUM(A2:C2)"], ["=SUM(A3:C3)"]];
      let formulaRange = currentSheet.getRange("D1:D3");
      formulaRange.setFormulas(formulas);
    }
'ExcelScript.Range#setHyperlink:member(1)':
  - |-
    /** 
     * This script inserts a hyperlink to the first cell of the last worksheet in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active cell.
      let cell = workbook.getActiveCell();

      // Get the last worksheet in the workbook.
      // Note that this might be the current sheet if there's only one worksheet.
      let lastSheet = workbook.getLastWorksheet();

      // Get sheet name. 
      let linkedSheetName = lastSheet.getName();
      console.log(`Setting hyperlink of ${cell.getAddress()} to the ${linkedSheetName} sheet's A1 cell`);

      // Set the text for the hyperlink.
      let value = `Click to go to: ${linkedSheetName}`;

      // Create the hyperlink using that cell's value.
      cell.setHyperlink({
        textToDisplay: value.toString(),
        screenTip: `Navigate to ${linkedSheetName}`,
        documentReference: `${linkedSheetName}!A1`
      });
    }
'ExcelScript.Range#setNumberFormat:member(1)':
  - |-
    /**
     * This script sets the number format in column C to show the data as a percentage.
     */
    function main(workbook: ExcelScript.Workbook) {
      const  selectedSheet = workbook.getActiveWorksheet();
      
      // Set number format for column C to a percentage that rounds to the nearest percentage point.
      selectedSheet.getRange("C:C").setNumberFormat("0%");
    }
'ExcelScript.Range#setNumberFormatLocal:member(1)':
  - |-
    /**
     * This script sets the number format in column D to show the data as a percentage with a decimal.
     */
    function main(workbook: ExcelScript.Workbook) {
      const  selectedSheet = workbook.getActiveWorksheet();
      
      // Set number format for column D to a percentage that rounds to the nearest tenth of a percentage.
      selectedSheet.getRange("D:D").setNumberFormatLocal("0.0%");
    }
'ExcelScript.Range#setValues:member(1)':
  - |-
   /**
    * This sample inserts some pre-loaded data into a range.
    * It also shows how to get a range that fits the data.
    */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active cell.
      let currentCell = workbook.getActiveCell();
      
      // Calculate the range needed to fit the given data.
      let targetRange = currentCell.getResizedRange(DATA.length - 1, DATA[0].length - 1);

      // Set range values to the data.
      targetRange.setValues(DATA);

      // Autofit the columns so the worksheet is readable. 
      targetRange.getFormat().autofitColumns();
    }

    /* 
     * This sample's data is in a static 2-dimensional array.
     * You could also get the input from other ranges or sources.
     * Note that each row must have the same number of columns to be valid. 
     */
    const DATA = [
      ['Date', 'Salesperson', 'Product', 'Amount']
      , ['3/2/2020', 'Anne', 'Pizza', '$1400']
      , ['3/2/2020', 'Mariya', 'Pizza', '$1700']
      , ['3/7/2020', 'Mark', 'Sandwiches', '$1010']
      , ['3/24/2020', 'Anne', 'Pizza', '$750']
      , ['3/28/2020', 'Mark', 'Salads', '$510']
      , ['4/17/2020', 'Laura', 'Salads', '$900']
      , ['4/17/2020', 'Mariya', 'Salads', '$1600']
      , ['4/28/2020', 'Laura', 'Sandwiches', '$680']
    ];
'ExcelScript.Range#unmerge:member(1)':
  - |-
    /**
     * This script unmerges every used cell in the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active worksheet.
      const selectedSheet = workbook.getActiveWorksheet();

      // Separate all regions into single cells in the currently used range.
      const range = selectedSheet.getUsedRange();
      range.unmerge();
    }
'ExcelScript.RangeAreas:interface':
  - |- 
    /**
     * This script clears all the cells in the current worksheet that are displaying errors.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current sheet.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Get the RangeAreas object for each cell with a formula error.
      const errorCells = usedRange.getSpecialCells(ExcelScript.SpecialCellType.formulas, ExcelScript.SpecialCellValueType.errors);

      // If there are any error cells, clear them.
      if (errorCells) {
        errorCells.clear();
      }
    }
'ExcelScript.RangeAreas#clear:member(1)':
  - |- 
    /**
     * This script clears all the cells in the current worksheet that are displaying errors.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current sheet.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Get the RangeAreas object for each cell with a formula error.
      const errorCells = usedRange.getSpecialCells(ExcelScript.SpecialCellType.formulas, ExcelScript.SpecialCellValueType.errors);

      // If there are any error cells, clear them.
      if (errorCells) {
        errorCells.clear();
      }
    }
'ExcelScript.RangeAreas#getFormat:member(1)':
  - |- 
    /**
     * This script finds and highlights all the cells in the current worksheet that contain a formula.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current sheet.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Get the RangeAreas object for each cell with a formula.
      const formulaCells = usedRange.getSpecialCells(ExcelScript.SpecialCellType.formulas);

      // Add a light blue background to the cells containing formulas.
      formulaCells.getFormat().getFill().setColor("#ADD8E6");
    }
'ExcelScript.RangeAreas#setPredefinedCellStyle:member(1)':
  - |- 
    /**
     * This script sets the cell style to "warning text"
     * on every cell with a formula error.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const usedRange = sheet.getUsedRange();

      // Get any cells that are displaying errors.
      const errorCells = usedRange.getSpecialCells(
        ExcelScript.SpecialCellType.formulas,
        ExcelScript.SpecialCellValueType.errors
      );

      // Check if there are error cells before proceeding.
      if (errorCells) {
        // Use the built-in warning text style on the error cells.
        errorCells.setPredefinedCellStyle(
          ExcelScript.BuiltInStyle.warningText.toString()
        );
      } else {
        console.log("No formula errors in the worksheet.");
      }
    }
'ExcelScript.RangeBorder#setStyle:member(1)':
  - |-   
    /**
     * This script adds a border around the outside of a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get a range from the current worksheet.
      let range = workbook.getActiveWorksheet().getRange("B2:E15");

      // Add a border around the whole bounding range.
      let format = range.getFormat();
      format.getRangeBorder(ExcelScript.BorderIndex.edgeTop).setStyle(ExcelScript.BorderLineStyle.continuous); // Top border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom).setStyle(ExcelScript.BorderLineStyle.continuous); // Bottom border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft).setStyle(ExcelScript.BorderLineStyle.continuous); // Left border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeRight).setStyle(ExcelScript.BorderLineStyle.continuous); // Right border
    }
'ExcelScript.RangeBorder#setWeight:member(1)':
  - |-
    /**
     * This script creates a border around a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the RangeFormat object for the range "B2:G10".
      const currentSheet = workbook.getActiveWorksheet();
      const rangeForBorder = currentSheet.getRange("B2:G10");
      const format = rangeForBorder.getFormat();
      
      // Get a RangeBorder object for each edge of the range and set the border properties.
      let edgeTop = format.getRangeBorder(ExcelScript.BorderIndex.edgeTop);
      edgeTop.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeTop.setWeight(ExcelScript.BorderWeight.thick);

      let edgeBottom = format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom);
      edgeBottom.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeBottom.setWeight(ExcelScript.BorderWeight.thick);

      let edgeLeft = format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft);
      edgeLeft.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeLeft.setWeight(ExcelScript.BorderWeight.thick);

      let edgeRight = format.getRangeBorder(ExcelScript.BorderIndex.edgeRight);
      edgeRight.setStyle(ExcelScript.BorderLineStyle.dashDot);
      edgeRight.setWeight(ExcelScript.BorderWeight.thick);
    }
'ExcelScript.RangeCopyType:enum':
  - |-
    /**
     * This script copies all of the values from the current worksheet to a new worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current worksheet.
      let usedRange = workbook.getActiveWorksheet().getUsedRange();

      // Create a new worksheet with a default name.
      let newSheet = workbook.addWorksheet();

      // Copy the values from the used range to the new worksheet.
      let copyType = ExcelScript.RangeCopyType.values; /* Change this to copy different information, such as formats. */
      let targetRange = newSheet.getRangeByIndexes(
        usedRange.getRowIndex(),
        usedRange.getColumnIndex(),
        usedRange.getRowCount(),
        usedRange.getColumnCount());
      targetRange.copyFrom(usedRange, copyType);

      // Switch the view to the new worksheet.
      newSheet.activate();
    }
'ExcelScript.RangeFill:interface':
  - |-
    /**
     * This script sets the fill color of the used range to green.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the used range of the current worksheet.
      let currentSheet = workbook.getActiveWorksheet();
      let usedRange = currentSheet.getUsedRange();

      // Get the RangeFill object.
      let fill = usedRange.getFormat().getFill();

      // Set the fill color to green.
      fill.setColor("green");
    }
'ExcelScript.RangeFill#clear:member(1)':
  - |-
    /**
     * This script removes all fill color and styles from the used range.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the used range of the current worksheet.
      let currentSheet = workbook.getActiveWorksheet();
      let usedRange = currentSheet.getUsedRange();

      // Clear the fill from the entire range.
      usedRange.getFormat().getFill().clear();
    }
'ExcelScript.RangeFill#setColor:member(1)':
  - |-
    /**
     * This script sets the fill color of cell A2 to blue.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range representing cell A2 from the current worksheet.
      let cell = workbook.getActiveWorksheet().getRange("A2");

      // Set the fill color to blue.
      cell.getFormat().getFill().setColor("blue");
    }
'ExcelScript.RangeFill#setPattern:member(1)':
  - |-
    /**
     * This script sets a black-checkered fill on the selected range.
     */
    function main(workbook: ExcelScript.Workbook) {
      const selected = workbook.getSelectedRange();
      selected.getFormat().getFill().setPattern(ExcelScript.FillPattern.checker);
      selected.getFormat().getFill().setPatternColor("black");
    }
'ExcelScript.RangeFormat:interface':
  - |-
    /**
     * This script applies some simple formatting to the top row of the used range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the top row of the used range in the current worksheet.
      const selectedSheet = workbook.getActiveWorksheet();
      const topRow = selectedSheet.getUsedRange().getRow(0);

      // For the top row, set the fill to black, the font color to white, and the font to be bold.
      const format: ExcelScript.RangeFormat = topRow.getFormat();
      format.getFill().setColor("black");
      format.getFont().setColor("white");
      format.getFont().setBold(true);
    }
'ExcelScript.RangeFormat#adjustIndent:member(1)':
  - |-
    /**
     * This script adjusts the indentation of a specific table column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the current worksheet.
      const selectedSheet = workbook.getActiveWorksheet();
      const table = selectedSheet.getTables()[0];

      // Get the data range of the second column.
      const secondColumn = table.getColumn(2);
      const data = secondColumn.getRangeBetweenHeaderAndTotal();

      // Add an indentation of 1 character space to the data range.
      data.getFormat().adjustIndent(1);
    }
'ExcelScript.RangeFormat#getFill:member(1)':
  - |-
    /**
     * This script gives the total row of a table a green color fill.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      let table = workbook.getTables()[0];

      // Get the range for the total row of the table.
      let totalRange = table.getTotalRowRange();

      // Set the fill color to green.
      totalRange.getFormat().getFill().setColor("green");
    }
'ExcelScript.RangeFormat#autofitColumns:member(1)':
  - |-
    /**
     * This script creates a new table from existing data and autofits the columns.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Create the table.
      const table = currentSheet.addTable(usedRange, true);

      // Format the table columns.
      table.getRange().getFormat().autofitColumns();
    }
'ExcelScript.RangeFormat#autofitRows:member(1)':
  - |-
    /**
     * This script creates a new table from existing data and autofits the rows.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Create the table.
      const table = currentSheet.addTable(usedRange, true);

      // Format the table rows.
      table.getRange().getFormat().autofitRows();
    }
'ExcelScript.RangeFormat#getColumnWidth:member(1)':
  - |-
    /**
     * This script doubles the column width for every column in the active worksheet's used range.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // To optimize performance, get all the current row heights before setting them.
      let currentWidths = Array<number>(usedRange.getColumnCount());
      for (let column = 0; column < currentWidths.length; column++) {
        currentWidths[column] = usedRange.getColumn(column).getFormat().getColumnWidth();
      }

      // Set the new column widths.
      for (let column = 0; column < currentWidths.length; column++) {
        usedRange.getFormat().setColumnWidth(currentWidths[column] * 2);
      }
'ExcelScript.RangeFormat#getFont:member(1)':
  - |-
    /**
     * This script bolds the text of cell A1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get A1 on the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Bold the font for that cell
      cell.getFormat().getFont().setBold(true);
    }
'ExcelScript.RangeFormat#getRowHeight:member(1)':
  - |-
    /**
     * This script doubles the row height for every row in the active worksheet's used range.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // To optimize performance, get all the current row heights before setting them.
      let currentHeights = Array<number>(usedRange.getRowCount());
      for (let row = 0; row < currentHeights.length; row++) {
        currentHeights[row] = usedRange.getRow(row).getFormat().getRowHeight();
      }

      // Set the new row heights.
      for (let row = 0; row < currentHeights.length; row++) {
        usedRange.getFormat().setRowHeight(currentHeights[row] * 2);
      }
    }
'ExcelScript.RangeFormat#getRangeBorder:member(1)':
  - |-   
    /**
     * This script adds a border around the outside of a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get a range from the current worksheet.
      let range = workbook.getActiveWorksheet().getRange("B2:E15");

      // Add a border around the whole bounding range.
      let format = range.getFormat();
      format.getRangeBorder(ExcelScript.BorderIndex.edgeTop).setStyle(ExcelScript.BorderLineStyle.continuous); // Top border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeBottom).setStyle(ExcelScript.BorderLineStyle.continuous); // Bottom border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeLeft).setStyle(ExcelScript.BorderLineStyle.continuous); // Left border
      format.getRangeBorder(ExcelScript.BorderIndex.edgeRight).setStyle(ExcelScript.BorderLineStyle.continuous); // Right border
    }
'ExcelScript.RangeFormat#setColumnWidth:member(1)':
  - |-
    /**
     * This script inserts a new column and sets that column's width to 100 pixels wide.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();

      // Insert a new column between the current B and C columns.
      const bcRange = currentSheet.getRange("C:C");
      const newColumn = bcRange.insert(ExcelScript.InsertShiftDirection.right);
      
      // Set the column width of the new column to 100 pixels.
      newColumn.getFormat().setColumnWidth(100);
    }
'ExcelScript.RangeFormat#setHorizontalAlignment:member(1)':
  - |-
    /**
     * This script centers the text in a table's header row cells.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Get the header range.
      const headerRange = table.getHeaderRowRange();

      // Set the horizontal text alignment to `center`.
      headerRange.getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.center);
    }
'ExcelScript.RangeFormat#setRowHeight:member(1)':
  - |-
    /**
     * This script inserts a new row and sets that row's width to 100 pixels tall.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();

      // Insert a new row between the current 2 and 3 rows.
      const bcRange = currentSheet.getRange("3:3");
      const newRow = bcRange.insert(ExcelScript.InsertShiftDirection.down);
      
      // Set the row height of the new row to 100 pixels.
      newRow.getFormat().setRowHeight(100);
    }
'ExcelScript.RangeFormat#setVerticalAlignment:member(1)':
  - |-
    /**
     * This script sets the vertical alignment formatting to "top"
     * for every cell in the row.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get row 1 for the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const firstRow = sheet.getRange("1:1");

      // Set the vertical alignment formatting on the row.
      firstRow.getFormat().setVerticalAlignment(ExcelScript.VerticalAlignment.top);
    }
'ExcelScript.RangeFormat#setWrapText:member(1)':
  - |-
    /**
     * This script turns on the text wrapping for a column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the E column in current worksheet.
      const column = workbook.getActiveWorksheet().getRange("E:E");

      // Set wrap text to true for the column.
      column.getFormat().setWrapText(true);
    }
'ExcelScript.RangeFont:interface':
  - |-
    /**
     * This script sets the font of A1 to Arial, size 16.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get A1 on the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Adjust the font settings for that cell.
      const cellFont = cell.getFormat().getFont();
      cellFont.setName("Arial");
      cellFont.setSize(16);
    }
'ExcelScript.RangeFont#setBold:member(1)':
  - |-
    /**
     * This script bolds the text of cell A1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get A1 on the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Bold the font for that cell
      cell.getFormat().getFont().setBold(true);
    }
'ExcelScript.RangeFont#setName:member(1)':
  - |-
    /**
     * This script sets the font style of A1 to Arial.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get A1 on the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Adjust the font settings for that cell.
      cell.getFormat().getFont().setName("Arial");
    }
'ExcelScript.RangeFont#setSize:member(1)':
  - |-
    /**
     * This script sets the font size of A1 to 16.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get A1 on the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Adjust the font settings for that cell.clear
      cell.getFormat().getFont().setSize(16);
    }
'ExcelScript.RangeHyperlink:interface':
  - |-
    /**
     * This script puts a link to a webpage in a cell.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first cell in the current worksheet.
      const cell = workbook.getActiveWorksheet().getCell(0,0);

      // Create a link to a webpage.
      const sampleHyperlink : ExcelScript.RangeHyperlink = {
        address: "https://learn.microsoft.com/office/dev/scripts/resources/samples/table-of-contents",
        screenTip: "Sample: Create a workbook table of contents",
        textToDisplay: "Learn how to make a workbook table of contents"
      }

      // Put the link in the cell and format the width to fit.
      cell.setHyperlink(sampleHyperlink);
      cell.getFormat().autofitColumns();
    }
'ExcelScript.RangeHyperlink#documentReference:member':
  - |-
    /**
     * This script creates a hyperlink in the current cell to a table.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the selected cell.
      const selectedCell = workbook.getActiveCell();

      // Create a hyperlink from the current cell to a table named "Resources".
      const link : ExcelScript.RangeHyperlink = {
        documentReference: "Resources",
        screenTip: "Resources table",
        textToDisplay: "Go to table"
      } ;

      selectedCell.setHyperlink(link)
    }
'ExcelScript.RangeSort#apply:member(1)':
  - |-
    /**
     * This script sorts the used range of the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the used range of the current worksheet.
        const activeRange = workbook.getActiveWorksheet().getUsedRange();

        // Sort the rows in ascending order based on the last column.
        activeRange.getSort().apply(
            [{
                ascending: true,
                key: activeRange.getColumnCount() - 1
            }],
            false, /* Don't match case. */
            true,  /* Treat the first row as a header row. */
            ExcelScript.SortOrientation.rows
        );
    }
'ExcelScript.RangeValueType:enum':
  - |-
    /**
     * This script formats rows in a worksheet based on the first value in that row. 
     * If it's the boolean value TRUE, the row is bolded. 
     * If it's FALSE, nothing is changed. 
     * If the value type isn't a boolean, the row is italicized.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range in the active worksheet.
      const sheet = workbook.getActiveWorksheet();
      const usedRange = sheet.getUsedRange();

      // Get the values in the first column.
      const firstColumnValues = usedRange.getColumn(0).getValues();

      // Look at the first cell in each row.
      const rowCount = usedRange.getRowCount();
      for (let i = 0; i < rowCount; i++) {
        // Get the type of the first cell to make sure it's a boolean.
        let firstValueType = usedRange.getCell(i, 0).getValueType();

        // Set the bold or italic of the row as described earlier.
        if (firstValueType === ExcelScript.RangeValueType.boolean) {
          if (firstColumnValues[i][0] as boolean === true) {
            usedRange.getRow(i).getFormat().getFont().setBold(true);
          } else {
            usedRange.getRow(i).getFormat().getFont().setBold(false);
          }
        } else {
          usedRange.getRow(i).getFormat().getFont().setItalic(true);
        }
      }
    }
'ExcelScript.RangeView:interface':
  - |-
    /**
     * This script copies values and formatting from the 
     * visible range of a table in Sheet1 into Sheet2.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the filtered data from Sheet1.
      const currentSheet = workbook.getWorksheet("Sheet1");
      const table = currentSheet.getTables()[0];
      const visibleTableRange: ExcelScript.RangeView = table.getRange().getVisibleView();
      const source = currentSheet.getRanges(visibleTableRange.getCellAddresses().toString());

      // Copy the data into the other sheet.
      const otherSheet = workbook.getWorksheet("Sheet2");
      const otherRangeCorner = otherSheet.getRange("A1");
      otherRangeCorner.copyFrom(source, ExcelScript.RangeCopyType.all);
    }
'ExcelScript.RangeView#getCellAddresses:member(1)':
  - |-
    /**
     * This script copies values and formatting from the 
     * visible range of a table in Sheet1 into Sheet2.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the filtered data from Sheet1.
      const currentSheet = workbook.getWorksheet("Sheet1");
      const table = currentSheet.getTables()[0];
      const visibleTableRange: ExcelScript.RangeView = table.getRange().getVisibleView();
      const source = currentSheet.getRanges(visibleTableRange.getCellAddresses().toString());

      // Copy the data into the other sheet.
      const otherSheet = workbook.getWorksheet("Sheet2");
      const otherRangeCorner = otherSheet.getRange("A1");
      otherRangeCorner.copyFrom(source, ExcelScript.RangeCopyType.all);
    }
'ExcelScript.RemoveDuplicatesResult:interface':
  - |-
    /**
     * This script removes duplicate rows from a range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range of the active worksheet.
      const usedRange = workbook.getActiveWorksheet().getUsedRange();

      // Remove any row that has a same value in the 0-indexed column as a previous row.
      const removedResults: ExcelScript.RemoveDuplicatesResult = usedRange.removeDuplicates([0], true);

      // Log the count of removed rows.
      console.log(`Rows removed: ${removedResults.getRemoved()}.`);
    }
'ExcelScript.ReplaceCriteria#completeMatch:member':
  - |-
    /**
     * This script normalizes the text in a column so that values don't include both "OK" and "okay". 
     * It replaces "OK" and all the case-based variants with "okay".
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the range representing column D.
      const currentSheet = workbook.getActiveWorksheet();
      const column = currentSheet.getRange("D:D");

      // Create a ReplaceCriteria object for the Range.replaceAll call.
      const criteria: ExcelScript.ReplaceCriteria = {
        completeMatch: true, /* Use a complete match to skip cells that already say "okay". */
        matchCase: false /* Ignore case when comparing strings. */
      };

      // Replace all instances of "ok" (case-insensitive) with "okay".
      column.replaceAll("ok", "okay", criteria);
    }
'ExcelScript.ReplaceCriteria#matchCase:member':
  - |-
    /**
     * This script replaces instances of "NA" with "North America", 
     * using the casing to ignore parts of words.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the currently used range.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Create a ReplaceCriteria object for the Range.replaceAll call.
      const criteria: ExcelScript.ReplaceCriteria = {
        completeMatch: false, 
        matchCase: true /* Match with "NA market", not "navigate" */
      }

      // Replace all instances of "NA" (case-sensitive) with "North America".
      usedRange.replaceAll("NA", "North America", criteria);
    }
'ExcelScript.RowColumnPivotHierarchy:interface':
  - |-
    /**
     *  This sample sorts the rows of a PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get an existing PivotTable.
      const pivotTable = workbook.getPivotTable("Farm Sales");

      // Get the data hierarchy to use as the basis of the sort.
      const valueFieldToSortOn: ExcelScript.DataPivotHierarchy = pivotTable.getDataHierarchy("Sum of Crates Sold Wholesale");

      // Get the row to sort.
      const rowToSort: ExcelScript.RowColumnPivotHierarchy = pivotTable.getRowHierarchy("Farm");

      // Sort the "Farm" row's only field by the values in "Sum of Crates Sold Wholesale".
      rowToSort.getFields()[0].sortByValues(ExcelScript.SortBy.descending, valueFieldToSortOn);
    }
'ExcelScript.SearchCriteria:interface':
  - |-
    /**
     * This script searches for the next instance of the text "TK" on the current worksheet.
     * It then selects that cell and removes "TK" and all formatting from the cell.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current worksheet.
      let range = workbook.getActiveWorksheet().getUsedRange();

      // Get the next cell that contains "TK".
      let tkCell = range.find("TK", {
        completeMatch: true, /* Don't match if the cell text only contains "TK" as part of another string. */
        matchCase: false,
        searchDirection: ExcelScript.SearchDirection.forward /* Start at the beginning of the range and go to later columns and rows. */
      });

      // Set focus on the found cell.
      tkCell.select();

      // Remove the "TK" text value from the cell, as well as any formatting that may have been added.
      tkCell.clear(ExcelScript.ClearApplyTo.all);
    }
'ExcelScript.SearchDirection:enum':
  - |-
    /**
     * This script searches for the next instance of the text "TK" on the current worksheet.
     * It then selects that cell and removes "TK" and all formatting from the cell.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current worksheet.
      let range = workbook.getActiveWorksheet().getUsedRange();

      // Get the next cell that contains "TK".
      let tkCell = range.find("TK", {
        completeMatch: true, /* Don't match if the cell text only contains "TK" as part of another string. */
        matchCase: false,
        searchDirection: ExcelScript.SearchDirection.forward /* Start at the beginning of the range and go to later columns and rows. */
      });

      // Set focus on the found cell.
      tkCell.select();

      // Remove the "TK" text value from the cell, as well as any formatting that may have been added.
      tkCell.clear(ExcelScript.ClearApplyTo.all);
    }
'ExcelScript.Shape:interface':
  - |-
    /**
     * This script creates a hexagon shape on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const hexagon: ExcelScript.Shape = 
        currentSheet.addGeometricShape(ExcelScript.GeometricShapeType.hexagon);
      
      // Set the hexagon size to 40x40 pixels.
      hexagon.setHeight(40);
      hexagon.setWidth(40);

      // Position the hexagon at [100,100] pixels.
      hexagon.setLeft(100);
      hexagon.setTop(100);
    }
'ExcelScript.Shape#delete:member(1)':
  - |-
    /**
     * This script deletes all the shapes on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the collection of shapes on the currently selected worksheet.
      const shapes = workbook.getActiveWorksheet().getShapes();

      // Remove each shape.
      shapes.forEach(shape =>{
        shape.delete();
      });
    }
'ExcelScript.Shape#getAsImage:member(1)':
  - |-
    /**
     * This script creates a star shape with the value from cell A1.
     * It then returns the image as a base64-encoded string. 
     * This string would be used as part of a Power Automate flow to add the image elsewhere.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the value of A1 from the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const value = sheet.getRange("A1").getValue();

      // Create a Shape object that looks like a 5-pointed star.
      const star = sheet.addGeometricShape(ExcelScript.GeometricShapeType.star5);

      // Set the text of star and make sure the shape fits the text.
      const textFrame = star.getTextFrame();
      textFrame.getTextRange().setText(value.toString());
      textFrame.setAutoSizeSetting(ExcelScript.ShapeAutoSize.autoSizeShapeToFitText);

      // Return the shape as a PNG image represented by a base64-encoded string.
      return star.getAsImage(ExcelScript.PictureFormat.png);
    }
'ExcelScript.Shape#getImage:member(1)':
  - |-
    /**
     * This script transfers an image from one worksheet to another.
     */
    function main(workbook: ExcelScript.Workbook)
    {
      // Get the worksheet with the image on it.
      let firstWorksheet = workbook.getWorksheet("FirstSheet");

      // Get the first image from the worksheet.
      // If a script added the image, you could add a name to make it easier to find.
      let image: ExcelScript.Image;
      firstWorksheet.getShapes().forEach((shape, index) => {
        if (shape.getType() === ExcelScript.ShapeType.image) {
          image = shape.getImage();
          return;
        }
      });

      // Copy the image to another worksheet.
      image.getShape().copyTo("SecondSheet");
    }
'ExcelScript.Shape#getLine:member(1)':
  - |- 
    /**
     * This script adds a line that goes from cell B2 to cell F4 on the current worksheet.
     */ 
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      const sheet = workbook.getActiveWorksheet();

      // Get the ranges for the two cells.
      const b2Range = sheet.getRange("B2");
      const f4Range = sheet.getRange("F4");

      // Add a straight line that connects the top-left corners of both cells.
      const newShape = sheet.addLine(
        b2Range.getLeft(),
        b2Range.getTop(),
        f4Range.getLeft(),
        f4Range.getTop(),
        ExcelScript.ConnectorType.straight);

      // Add an open arrowhead to the end of the line, such that it points at F4.
      const line = newShape.getLine();
      line.setEndArrowheadStyle(ExcelScript.ArrowheadStyle.open);
    }
'ExcelScript.Shape#getTextFrame:member(1)':
  - |-
    /**
     * This script creates a star shape with the value from cell A1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the value of A1 from the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const value = sheet.getRange("A1").getValue();

      // Create a Shape object that looks like a 5-pointed star.
      const star = sheet.addGeometricShape(ExcelScript.GeometricShapeType.star5);

      // Set the text of star and make sure the shape fits the text.
      const textFrame = star.getTextFrame();
      textFrame.getTextRange().setText(value.toString());
      textFrame.setAutoSizeSetting(ExcelScript.ShapeAutoSize.autoSizeShapeToFitText);
    }
'ExcelScript.Shape#setName:member(1)':
  - |-
    /**
     * This script creates a triangle shape on the current worksheet and names it "TRI".
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const triangle: ExcelScript.Shape = 
        currentSheet.addGeometricShape(ExcelScript.GeometricShapeType.triangle);
      
      triangle.setName("TRI");
    }
'ExcelScript.Shape#setPlacement:member(1)':
  - |-
    /**
     * This script creates a diamond shape at cell C3.
     * The shape moves and resizes as the grid underneath it changes.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get cell C3 in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const cell = sheet.getRange("C3");

      // Create a diamond that slightly overlaps the cell C3.
      const diamond = sheet.addGeometricShape(ExcelScript.GeometricShapeType.diamond);
      // Set each dimension so that the shape extends 5 pixels beyond the cell borders.
      diamond.setLeft(cell.getLeft() - 5);
      diamond.setTop(cell.getTop() - 5);
      diamond.setHeight(cell.getHeight() + 10);
      diamond.setWidth(cell.getWidth() + 10);

      // Set the placement of the shape so that it resizes and moves with the grid.
      diamond.setPlacement(ExcelScript.Placement.twoCell);
    }
'ExcelScript.ShapeAutoSize:enum':
  - |-
    /**
     * This script creates a star shape with the value from cell A1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the value of A1 from the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const value = sheet.getRange("A1").getValue();

      // Create a Shape object that looks like a 5-pointed star.
      const star = sheet.addGeometricShape(ExcelScript.GeometricShapeType.star5);

      // Set the text of star and make sure the shape fits the text.
      const textFrame = star.getTextFrame();
      textFrame.getTextRange().setText(value.toString());
      textFrame.setAutoSizeSetting(ExcelScript.ShapeAutoSize.autoSizeShapeToFitText);
    }
'ExcelScript.ShapeFont:interface':
  - |-
    /**
     * This sample sets the font of a shape to be bold. 
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first shape in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const shape = sheet.getShapes()[0];

      // Get the text font from the shape.
      const text: ExcelScript.TextRange = shape.getTextFrame().getTextRange();
      const shapeTextFont: ExcelScript.ShapeFont = text.getFont();

      // Set the font to be bold.
      shapeTextFont.setBold(true);
    }
'ExcelScript.SheetVisibility:enum':
  - |-
    /**
     * This script unhides all the worksheets in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Iterate over each worksheet.
      workbook.getWorksheets().forEach((worksheet) => {
        // Set the worksheet visibility to visible.
        worksheet.setVisibility(ExcelScript.SheetVisibility.visible);
      });
    }
'ExcelScript.ShowAsCalculation:enum':
  - |-
    /**
     * The script changes the display for "Crates Sold at Farm".
     * It shows the percentage of the grand total, 
     * instead of the default sum.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Pivot".
      const farmPivot = workbook.getPivotTable("Farm Pivot");

      // Get the data hierarchy "Sum of Crates Sold at Farm".
      const farmSales = farmPivot.getDataHierarchy("Sum of Crates Sold at Farm");

      // Show the data as a percentage of the grand total.
      farmSales.setShowAs({
        calculation: ExcelScript.ShowAsCalculation.percentOfGrandTotal
      });
    }
'ExcelScript.ShowAsRule:interface':
  - |-
    /**
     * The script changes the display for "Crates Sold at Farm".
     * The field shows each value's difference
     * from the value of the "Lemon" in the same row.
     * If the row has no value for "Lemon", the field shows "#N/A".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Pivot".
      const farmPivot = workbook.getPivotTable("Farm Pivot");

      // Get the data hierarchy "Sum of Crates Sold at Farm".
      const farmSales = farmPivot.getDataHierarchy("Sum of Crates Sold at Farm");

      // Get the row hierarchy "Type".
      const typeField = farmPivot.getRowHierarchy("Type").getFields()[0];

      // Change the data hierarchy to show each value as the difference
      // from the value of the "Lemon" in that row.
      const rule: ExcelScript.ShowAsRule = {
        calculation: ExcelScript.ShowAsCalculation.differenceFrom,
        baseField: typeField,
        baseItem: typeField.getPivotItem("Lemon")
      }
      farmSales.setShowAs(rule);

      // Set the name of the field to match the new behavior.
      farmSales.setName("Difference from Lemons of Crates Sold at Farm");
    }
'ExcelScript.Slicer:interface':
  - |-
    /**
     * This script adds a slicer for an existing PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Pivot".
      const farmPivot = workbook.getPivotTable("Farm Pivot");

      // Create the slicer. 
      // Note that this assumes "Type" is already added as a hierarchy to the PivotTable.
      const fruitSlicer: ExcelScript.Slicer = workbook.addSlicer(
        farmPivot, /* The table or PivotTale to be sliced. */
        farmPivot.getHierarchy("Type").getFields()[0] /* What source field to use as the slicer options. */
      );

      // Select the items to display.
      fruitSlicer.selectItems(["Lemon", "Lime"]);

      // Set the left margin of the slicer.
      fruitSlicer.setLeft(400);
    }
'ExcelScript.SortDataOption:enum':
  - |-
    /**
     * This script sorts a table based on the values in column 1.
     * If the text of a column-1 value can be treated as a number, 
     * it will be sorted in numerical order, rather than Unicode order
     * (so 123 will come before 12.3).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Create the sorting parameters.
      const countSortField: ExcelScript.SortField = {
        key: 1,
        ascending: true,
        dataOption: ExcelScript.SortDataOption.textAsNumber
      };

      // Apply the sort to the table.
      const sort = table.getSort();
      sort.apply([countSortField]);
    }
'ExcelScript.SortField#color:member':
  - |-
    /**
     * This script sorts a range based on the color of the cells.
     * It brings all red cells to the top of the range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range (A1:D8) to sort from the current worksheet.
      const worksheet = workbook.getActiveWorksheet();
      const rangeToSort = worksheet.getRange("A1:D8");

      // Create a SortField for color sorting.
      // This sorts the rows based on the fill color of each row's cell in the first column.
      let colorSort: ExcelScript.SortField = {
        ascending: true,
        color: "FF0000", /* red */
        key: 0,
        sortOn: ExcelScript.SortOn.cellColor
      };

      // Apply the SortField to the range.
      rangeToSort.getSort().apply([colorSort]);
    }
'ExcelScript.SortField#dataOption:member':
  - |-
    /**
     * This script sorts a table based on the values in column 1.
     * If the text of a column-1 value can be treated as a number, 
     * it will be sorted in numerical order, rather than Unicode order
     * (so 123 will come before 12.3).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Create the sorting parameters.
      const countSortField: ExcelScript.SortField = {
        key: 1,
        ascending: true,
        dataOption: ExcelScript.SortDataOption.textAsNumber
      };

      // Apply the sort to the table.
      const sort = table.getSort();
      sort.apply([countSortField]);
    }
'ExcelScript.SortField#key:member':
  - |-
    /**
     * This script sorts the used range of the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the used range of the current worksheet.
        const activeRange = workbook.getActiveWorksheet().getUsedRange();

        // Sort the rows in ascending order based on the last column.
        activeRange.getSort().apply(
            [{
                ascending: true,
                key: activeRange.getColumnCount() - 1
            }],
            false, /* Don't match case. */
            true,  /* Treat the first row as a header rows. */
            ExcelScript.SortOrientation.rows
        );
    }
'ExcelScript.SortMethod:enum':
  - |-
    /**
     * This script sorts a range using the values in the first column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range (A1:D8) to sort from the current worksheet.
      const worksheet = workbook.getActiveWorksheet();
      const rangeToSort = worksheet.getRange("A1:D8");

      // Create a SortField for text sorting.
      let valueSort: ExcelScript.SortField = {
        ascending: true,
        key: 0, /* First column */
        sortOn: ExcelScript.SortOn.value
      };

      // Apply the SortField to the range.
      rangeToSort.getSort().apply(
        [valueSort],
        false, /* Don't let casing have an impact of sorting. */
        true, /* The range has headers. */
        ExcelScript.SortOrientation.rows,
        ExcelScript.SortMethod.pinYin /* Use phonetic sorting for Chinese characters. */
        );
    }
'ExcelScript.SortOn:enum':
  - |-
    /**
     * This script sorts a range based on the color of the cells.
     * It brings all red cells to the top of the range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the range (A1:D8) to sort from the current worksheet.
      const worksheet = workbook.getActiveWorksheet();
      const rangeToSort = worksheet.getRange("A1:D8");

      // Create a SortField for color sorting.
      // This sorts the rows based on the fill color of each row's cell in the first column.
      let colorSort: ExcelScript.SortField = {
        ascending: true,
        color: "FF0000", /* red */
        key: 0,
        sortOn: ExcelScript.SortOn.cellColor
      };

      // Apply the SortField to the range.
      rangeToSort.getSort().apply([colorSort]);
    }
'ExcelScript.SpecialCellType:enum':
  - |- 
    /**
     * This script finds and highlights all the cells in the current worksheet that contain a formula.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current sheet.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Get the RangeAreas object for each cell with a formula.
      const formulaCells = usedRange.getSpecialCells(ExcelScript.SpecialCellType.formulas);

      // Add a light blue background to the cells containing formulas.
      formulaCells.getFormat().getFill().setColor("#ADD8E6");
    }
'ExcelScript.SpecialCellValueType:enum':
  - |- 
    /**
     * This script finds and bolds the text of cells containing strings (not numbers or formulas).
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the used range on the current sheet.
      const currentSheet = workbook.getActiveWorksheet();
      const usedRange = currentSheet.getUsedRange();

      // Get the RangeAreas object for each cell with only text.
      const textCells = usedRange.getSpecialCells(
        ExcelScript.SpecialCellType.constants, 
        ExcelScript.SpecialCellValueType.text);

      // Bold the text of those cells.
      textCells.getFormat().getFont().setBold(true);
    }
'ExcelScript.SubtotalLocationType:enum':
  - |-
    /**
     * This script displays group subtotals of the "Farms Sales" PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Sales".
      const pivot = workbook.getPivotTable("Farm Sales");

      // Get the PivotLayout object.
      const layout = pivot.getLayout();

      // Show all the subtotals at the bottom of each group.
      layout.setSubtotalLocation(ExcelScript.SubtotalLocationType.atBottom);
    }
'ExcelScript.Table:interface':
  - |-
    /**
     * This script creates a table from the current sheet's used range.
     * It then adds a total row to the table with the SUM of the last column.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the used range of the current worksheet.
        const sheet = workbook.getActiveWorksheet();
        const range = sheet.getUsedRange();

        // Create a table that has headers from that range.
        const table = sheet.addTable(range, true);

        // Have the table display the SUM for the last column.
        table.setShowTotals(true);
        const lastColumn = table.getColumn(table.getColumns().length);
        lastColumn.getTotalRowRange().setFormula(`=SUBTOTAL(109,[${lastColumn.getName()}])`);
    }
'ExcelScript.Table#addColumn:member(1)':
  - |-
    /**
     * This script adds a new column to a table.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Append an empty column to the table with the header "Total". 
      table.addColumn(-1, null, "Total");
    }
'ExcelScript.Table#addRow:member(1)':
  - |-
    /**
     * This script adds a row to an existing table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table in the current worksheet.
        const selectedSheet = workbook.getActiveWorksheet();
        const table = selectedSheet.getTables()[0];

        // Initialize the data to be added as a table row.
        // Note that length of the array must match the number of columns in the table.
        let rowData = ["Carrots", "Vegetable", 750];

        // Add a row to the end of the table.
        table.addRow(-1, rowData);
    }
'ExcelScript.Table#addRows:member(1)':
  - |-
    /**
     * This script adds multiple rows to an existing table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table in the current worksheet.
        const selectedSheet = workbook.getActiveWorksheet();
        const table = selectedSheet.getTables()[0];

        // Initialize the data to be added as table rows.
        // Note that length of the array must match the number of columns in the table.
        let rowData = [["Apples", "Fruit", 5000],
                      ["Celery", "Vegetable", 600],
                      ["Onions", "Vegetable", 1500]];

        // Add the rows to the end of the table.
        table.addRows(-1, rowData);
    }
'ExcelScript.Table#clearFilters:member(1)':
  - |-
    /**
     * This script clears the filters from all tables in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get all the tables in the workbook.
        const tables = workbook.getTables();

        // Remove any active filters from each table.
        tables.forEach((table) => {
          table.clearFilters();
        });
    }
'ExcelScript.Table#convertToRange:member(1)':
  - |-
    /**
     * This script converts a table to a range and removes the formatting.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table in the current worksheet.
        const selectedSheet = workbook.getActiveWorksheet();
        const table = selectedSheet.getTables()[0];

        // Convert the table to a range.
        const formerTable = table.convertToRange();

        // Remove the formatting from the table
        formerTable.clear(ExcelScript.ClearApplyTo.formats);
    }
'ExcelScript.Table#delete:member(1)':
  - |-
    /**
     * This script deletes a table. 
     * This removes all associated data and formatting.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the table named "Inventory".
        const table = workbook.getTable("Inventory");

        // Delete the table.
        table.delete();
    }
'ExcelScript.Table#getColumn:member(1)':
  - |-
    /**
     * This script adjusts the indentation of a specific table column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the current worksheet.
      const selectedSheet = workbook.getActiveWorksheet();
      const table = selectedSheet.getTables()[0];

      // Get the data range of the second column.
      const secondColumn = table.getColumn(2);
      const data = secondColumn.getRangeBetweenHeaderAndTotal();

      // Add an indentation of 1 character space to the data range.
      data.getFormat().adjustIndent(1);
    }
'ExcelScript.Table#getColumns:member(1)':
  - |-
    /**
     * This script adds a new column to a table.
     * It then sets the formulas in the new column to be the product
     * of the values in the two preceding columns.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Append an empty column to the table with the header "Total". 
      const totalColumn = table.addColumn(-1, null, "Total");

      // Get the names of the two preceding columns.
      const productColumnName1 = table.getColumns()[totalColumn.getIndex() - 1].getName();
      const productColumnName2 = table.getColumns()[totalColumn.getIndex() - 2].getName();
      
      // Set the formulas in the "Total" column to be the product of the two preceding columns.
      totalColumn.getRangeBetweenHeaderAndTotal().setFormula(
        `=[@[${productColumnName1}]]*[@[${productColumnName2}]]`
      );
    }
'ExcelScript.Table#getColumnByName:member(1)':
  - |-
    /**
     * This script removes a specific column from a table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the table named "Inventory".
        const table = workbook.getTable("Inventory");

        // If it exists, remove the column named "Category".
        let categoryColumn = table.getColumnByName("Category");
        if (categoryColumn) {
            categoryColumn.delete();
        }
    }
'ExcelScript.Table#getHeaderRowRange:member(1)':
  - |-
    /**
     * This script centers the text in a table's header row cells.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const table = currentSheet.getTables()[0];

      // Get the header range.
      const headerRange = table.getHeaderRowRange();

      // Set the horizontal text alignment to `center`.
      headerRange.getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.center);
    }
'ExcelScript.Table#getRange:member(1)':
  - |-
    /**
     * This script removes any extra formatting that's been applied to a table. 
     * This leaves only the base table style effects.
     * Any formatting outside of the table will be left as is.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table on the current worksheet.
      let worksheet = workbook.getActiveWorksheet();
      let table = worksheet.getTables()[0];

      // Get the range used by the table.
      let range = table.getRange();

      // Clear all the formatting that is not applied by the table and the table style.
      range.clear(ExcelScript.ClearApplyTo.formats);
    }
'ExcelScript.Table#reapplyFilters:member(1)':
  - |-
    /**
     * This script reapplies the filters on every table in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the tables.
      const tables = workbook.getTables();

      // Iterate over every table.
      tables.forEach((table) => {
        // Reapply the filters to account for new table entries.
        table.reapplyFilters();
      });
    }
'ExcelScript.Table#setShowBandedRows:member(1)':
  - |-
    /**
     * This script sets all the tables in the workbook to have banded rows. 
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the tables.
      const tables = workbook.getTables();

      // For each table, set the banded row formatting to true.
      tables.forEach((table) => {
        table.setShowBandedRows(true);
      });
    }
'ExcelScript.Table#setShowHeaders:member(1)':
  - |-
    /**
     * This script makes a table's headers not visible in the grid.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the table named "CoverageTable".
        const coverageTable = workbook.getTable("CoverageTable");

        // Make the header row not visible.
        coverageTable.setShowHeaders(false);
    }
'ExcelScript.Table#setShowTotals:member(1)':
  - |-
    /**
     * This script adds the Total Row to an existing table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table in the current worksheet.
        const selectedSheet = workbook.getActiveWorksheet();
        const table = selectedSheet.getTables()[0];

        // Set the Total Row to show.
        table.setShowTotals(true);
    }
'ExcelScript.TableColumn:interface':
  - |-
    /**
     * This script shows how to get the range of a table column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Get the range of the table column named "Type".
      const typeColumn : ExcelScript.TableColumn = table.getColumn("Type");
      const range = typeColumn.getRange();

      // Do something with the range...
    }
'ExcelScript.TableColumn#delete:member(1)':
  - |-
    /**
     * This script removes a specific column from a table.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the table named "Inventory".
        const table = workbook.getTable("Inventory");

        // If it exists, remove the column named "Category".
        let categoryColumn = table.getColumnByName("Category");
        if (categoryColumn) {
            categoryColumn.delete();
        }
    }
'ExcelScript.TableColumn#getFilter:member(1)':
  - |- 
    /**
     * This script adds a table filter to only show the top 10% of values 
     * belonging to a particular column.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the first table on the current worksheet.
        const table = workbook.getActiveWorksheet().getTables()[0];

        // Get the filter for the "PageViews" table column.
        const pageViewFilter = table.getColumnByName("PageViews").getFilter();

        // Apply a filter to only show the rows with the top 10% of values in this column.
        pageViewFilter.applyTopPercentFilter(10);
    }
'ExcelScript.TableColumn#getRangeBetweenHeaderAndTotal:member(1)':
  - |-
    /**
     * This script adds a new column to a table.
     * It then sets the formulas in the new column to be the product
     * of the values in the two preceding columns.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first table in the workbook.
      const table = workbook.getTables()[0];

      // Append an empty column to the table with the header "Total". 
      const totalColumn = table.addColumn(-1, null, "Total");

      // Get the names of the two preceding columns.
      const productColumnName1 = table.getColumns()[totalColumn.getIndex() - 1].getName();
      const productColumnName2 = table.getColumns()[totalColumn.getIndex() - 2].getName();
      
      // Set the formulas in the "Total" column to be the product of the two preceding columns.
      totalColumn.getRangeBetweenHeaderAndTotal().setFormula(
        `=[@[${productColumnName1}]]*[@[${productColumnName2}]]`
      );
    }
'ExcelScript.TableColumn#getTotalRowRange:member(1)':
  - |-
    /**
     * This script logs the value in the total row of a table column.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get the table named "Cities".
        const table = workbook.getTable("Cities");

        // Get the total row from the "Population" column.
        const column = table.getColumn("Population");
        const totalRange = column.getTotalRowRange();

        // Log the total value.
        console.log(totalRange.getValue());
    }
'ExcelScript.TableColumn#setName:member(1)':
  - |-
    /**
     * This script renames a column in an existing table.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the "Employee" table.
      const employeeTable = workbook.getTable("Employee");

      // Rename a column from "EmplID" to "Employee ID".
      const idColumn = employeeTable.getColumnByName("EmplID");
      idColumn.setName("Employee ID");
    }
'ExcelScript.TableSort#apply:member(1)':
  - |-
    /**
     * This sample creates a table from the current worksheet's used range, then sorts it based on the first column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Create a table with the used cells.
      let usedRange = selectedSheet.getUsedRange();
      let newTable = selectedSheet.addTable(usedRange, true);

      // Sort the table using the first column.
      newTable.getSort().apply([{ key: 0, ascending: true }]);
    }
'ExcelScript.TableSort#reapply:member(1)':
  - |-
    /**
     * This script reapplies all the current sorting criteria to existing tables.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the tables.
      const tables = workbook.getTables();

      // For each table, reapply that table's current sorting parameters.
      tables.forEach((table) => {
        const sort: ExcelScript.TableSort = table.getSort();
        sort.reapply();
      });
    }
'ExcelScript.TextConditionalFormat:interface':
  - |-
    /**
     * This script adds conditional formatting to the first column in the worksheet.
     * This formatting gives the cells a green fill if they have text starting with "Excel".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first column in the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const firstColumn = currentSheet.getRange("A:A");

      // Add conditional formatting based on the text in the cells.
      const textConditionFormat: ExcelScript.TextConditionalFormat = 
        firstColumn.addConditionalFormat(ExcelScript.ConditionalFormatType.containsText).getTextComparison();

      // Set the conditional format to provide a green fill.
      textConditionFormat.getFormat().getFill().setColor("green");

      // Apply the condition rule that the text begins with "Excel".
      const textRule: ExcelScript.ConditionalTextComparisonRule = {
        operator: ExcelScript.ConditionalTextOperator.beginsWith,
        text: "Excel"
      };
      textConditionFormat.setRule(textRule);
    }
'ExcelScript.TextFrame:interface':
  - |-
    /**
     * This script creates a star shape with the value from cell A1.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the value of A1 from the worksheet named Sheet1.
      const sheet = workbook.getWorksheet("Sheet1");
      const value = sheet.getRange("A1").getValue();

      // Create a Shape object that looks like a 5-pointed star.
      const star = sheet.addGeometricShape(ExcelScript.GeometricShapeType.star5);

      // Set the text of star and make sure the shape fits the text.
      const textFrame: ExcelScript.TextFrame = star.getTextFrame();
      textFrame.getTextRange().setText(value.toString());
      textFrame.setAutoSizeSetting(ExcelScript.ShapeAutoSize.autoSizeShapeToFitText);
    }
'ExcelScript.TextRange:interface':
  - |-
    /**
     * This script adds text to a shape.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a hexagon shape in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const hexagon = sheet.addGeometricShape(ExcelScript.GeometricShapeType.hexagon);
      
      // Set the text of the shape.
      const hexText: ExcelScript.TextRange = hexagon.getTextFrame().getTextRange();
      hexText.setText("Forest");
    }
'ExcelScript.TextRange#getFont:member(1)':
  - |-
    /**
     * This sample sets the font of a shape to be bold. 
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first shape in the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const shape = sheet.getShapes()[0];

      // Get the text font from the shape.
      const text: ExcelScript.TextRange = shape.getTextFrame().getTextRange();
      const shapeTextFont: ExcelScript.ShapeFont = text.getFont();

      // Set the font to be bold.
      shapeTextFont.setBold(true);
    }
'ExcelScript.TextRange#getText:member(1)':
  - |-
    /**
     * This script writes all the text from the workbook's geometric shapes in a new worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a new worksheet.
      const shapeTextSheet = workbook.addWorksheet("ShapeText");
      let shapeTextValues: string[][] = [];

      // Get the text from every geometric shape in every worksheet.
      workbook.getWorksheets().forEach((sheet) => {
        sheet.getShapes().forEach((shape) => {
          if (shape.getType() === ExcelScript.ShapeType.geometricShape)
          shapeTextValues.push([
            sheet.getName(),
            shape.getGeometricShapeType().toString(),
            shape.getTextFrame().getTextRange().getText()]);
        });
      });

      // Add the text to the new worksheet.
      const range = shapeTextSheet.getRangeByIndexes(
        0,
        0, 
        shapeTextValues.length, 
        shapeTextValues[0].length);
      range.setValues(shapeTextValues);
    }
'ExcelScript.TopBottomConditionalFormat:interface':
  - |-
    /**
     * This sample applies conditional formatting to the currently used range in the worksheet. 
     * The conditional formatting is a green fill for the top 10% of values.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the used range in the worksheet.
      let range = selectedSheet.getUsedRange();

      // Set the fill color to green for the top 10% of values in the range.
      let conditionalFormat = range.addConditionalFormat(ExcelScript.ConditionalFormatType.topBottom)
      conditionalFormat.getTopBottom().getFormat().getFill().setColor("green");
      conditionalFormat.getTopBottom().setRule({
        rank: 10, /* The percentage threshold. */
        type: ExcelScript.ConditionalTopBottomCriterionType.topPercent /* The type of the top/bottom condition. */
      });
    }
'ExcelScript.ValueFilterCondition:enum':
  - |-
    /**
     * This script applies a PivotValueFilter to the first row hierarchy in the PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable on the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let pivotTable = sheet.getPivotTables()[0];

      // Get the first row hierarchy to use as the field which gets filtered.
      let rowHierarchy = pivotTable.getRowHierarchies()[0];

      // Get the first data hierarchy to use as the values for filtering the rows.
      let dataHierarchy = pivotTable.getDataHierarchies()[0];

      // Create a filter that excludes values greater than 500.
      let filter: ExcelScript.PivotValueFilter = {
        condition: ExcelScript.ValueFilterCondition.greaterThan,
        comparator: 500,
        value: dataHierarchy.getName()
      };

      // Apply the filter.
      rowHierarchy.getPivotField(rowHierarchy.getName()).applyFilter({
        valueFilter: filter
      });
    }
'ExcelScript.VerticalAlignment:enum':
  - |-
    /**
     * This script sets the vertical alignment formatting to "top"
     * for every cell in the row.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get row 1 for the current worksheet.
      const sheet = workbook.getActiveWorksheet();
      const firstRow = sheet.getRange("1:1");

      // Set the vertical alignment formatting on the row.
      firstRow.getFormat().setVerticalAlignment(ExcelScript.VerticalAlignment.top);
    }
'ExcelScript.Workbook:interface':
  - |-
    /**
     * This script adds a new worksheet to the workbook, then switches to it.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Add a new worksheet with the default name.
      let worksheet = workbook.addWorksheet();

      // Switch focus to the new worksheet.
      worksheet.activate();
    }
'ExcelScript.Workbook#addNamedItem:member(1)':
  - |-
    /**
     * This script creates a named formula and uses it in another part of the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a named item for a formula.
      // This formula is the sum of the cells F2:F21 on Sheet1.
      const namedItem: ExcelScript.NamedItem = workbook.addNamedItem(
        "GrandTotal", 
        "=SUM(Sheet1!$F$2:$F$21)", 
        "The sum of table sums."
      );

      // Add this named formula to a new sheet in the workbook.
      const otherSheet = workbook.addWorksheet();
      otherSheet.getRange("A1").setFormula(namedItem.getFormula());

      // Switch to the new worksheet.
      otherSheet.activate();
    }
'ExcelScript.Workbook#addPivotTable:member(1)':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to an existing worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     * It also assumes there is a worksheet named "PivotSheet".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];
      let pivotTable = workbook.addPivotTable("My Pivot", table, "PivotSheet!A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));
    }
'ExcelScript.Workbook#addSlicer:member(1)':
  - |-
    /**
     * This script adds a slicer for an existing PivotTable.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the PivotTable named "Farm Pivot".
      const farmPivot = workbook.getPivotTable("Farm Pivot");

      // Create the slicer. 
      // Note that this assumes "Type" is already added as a hierarchy to the PivotTable.
      const fruitSlicer: ExcelScript.Slicer = workbook.addSlicer(
        farmPivot, /* The table or PivotTale to be sliced. */
        farmPivot.getHierarchy("Type").getFields()[0] /* What source field to use as the slicer options. */
      );

      // Select the items to display.
      fruitSlicer.selectItems(["Lemon", "Lime"]);

      // Set the left margin of the slicer.
      fruitSlicer.setLeft(400);
    }
'ExcelScript.Workbook#addTable:member(1)':
  - |-
    /**
     * This sample converts the information in the first worksheet
     * into a table with headers.
    */
    function main(workbook: ExcelScript.Workbook) {
      // This assumes there is one contiguous range in the first worksheet.
      const dataRange = workbook.getFirstWorksheet().getUsedRange();
      
      // Add a table at the workbook level.
      workbook.addTable(dataRange.getAddress(), true);
    }
'ExcelScript.Workbook#addWorksheet:member(1)':
  - |-
    /**
     * This script adds a new worksheet named "Data" to the workbook.
     * If a worksheet with that name already exists, the script logs a note.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Check if the "Data" worksheet already exists.
      if (workbook.getWorksheet("Data")) {
        console.log("The Data worksheet is already in the workbook.");
      } else {
        // Add a new worksheet.
        let worksheet = workbook.addWorksheet("Data");
      }
    }
'ExcelScript.Workbook#getActiveCell:member(1)':
  - |-
    /**
     * This script logs the value of the current active cell. 
     * If multiple cells are selected, the top-leftmost cell will be logged.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current active cell in the workbook.
      let cell = workbook.getActiveCell();
      console.log(`The current cell's value is ${cell.getValue()}`);
    }
'ExcelScript.Workbook#getLinkedWorkbookRefreshMode:member(1)':
  - |-
    /**
     * This script refreshes all the links to external workbooks, 
     * if the linked workbook refresh mode is set to manual.
     * To learn about linked workbooks, see https://support.microsoft.com/office/c98d1803-dd75-4668-ac6a-d7cca2a9b95f.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Check the refresh mode.
      if (workbook.getLinkedWorkbookRefreshMode() === ExcelScript.WorkbookLinksRefreshMode.manual) {
        console.log("Refreshing workbook links");

        // Trigger a refresh of linked workbook content.
        workbook.refreshAllLinksToLinkedWorkbooks();
      }
'ExcelScript.Workbook#getLinkedWorkbooks:member(1)':
  - |-
    /**
     * This script removes all links to other workbooks.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Get all the linked workbook references.
        const externalWorkbooks: ExcelScript.LinkedWorkbook[] = workbook.getLinkedWorkbooks();
        console.log(`There are ${externalWorkbooks.length} other workbooks linked to from this workbook.`);

        // Remove all the links to those workbooks.
        // This changes the value of cells with workbook links to "#CONNECT!".
        externalWorkbooks.forEach((workbookLink) => {
            workbookLink.breakLinks();
        });
    }
'ExcelScript.Workbook#getName:member(1)':
  - |-
    /**
     * This script logs the name of the workbook without the ".xlsx" extension.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the workbook's name.
      let name = workbook.getName();

      // Remove the file extension.
      name = name.substring(0, name.lastIndexOf(".xlsx"));

      // Display the name in the console.
      console.log(name);
    }
'ExcelScript.Workbook#getNames:member(1)':
  - |-
    /**
     * This script looks for every named range with "Review" in the name 
     * and marks the range with a yellow fill.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Look at every named item in the workbook.
      workbook.getNames().forEach((namedItem) => {
        // Find names containing "Review".
        if (namedItem.getName().includes("Review")) {
          // Only change the fill color if the named item is a range (not a formula).
          let itemType: ExcelScript.NamedItemType = namedItem.getType();
          if (itemType === ExcelScript.NamedItemType.range) {
            // Set the range's fill color to yellow.
            namedItem.getRange().getFormat().getFill().setColor("yellow");
          }
        }
      });
    }
'ExcelScript.Workbook#getProtection:member(1)':
  - |-
    /**
     * This script protects the workbook with a password, if it isn't already protected.
     * The password is provided by the user through a prompt.
     */
    function main(workbook: ExcelScript.Workbook, password?: string) {
      // Get the workbook-level protection object.
      const protection = workbook.getProtection();

      // Check if the workbook is already protected.
      if (!protection.getProtected()) {
          // Protect the workbook with the given password.
          // If the optional password was omitted, 
          // no password will be needed to unprotect the workbook.
        protection.protect(password);
      }
    }
'ExcelScript.Workbook#getWorksheet:member(1)':
  - |-
    /**
     * This script switches the active view to a worksheet named "Data", if it exists.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Check if the "Data" worksheet exists.
      let dataWorksheet = workbook.getWorksheet("Data");
      if (dataWorksheet) {
        // Switch to the "Data" worksheet.
        dataWorksheet.activate();
      } else {
        console.log(`No worksheet named "Data" in this workbook.`);
      }
    }
'ExcelScript.Workbook#getWorksheets:member(1)':
  - |-
    /**
     * This script logs the names of all the worksheets in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the worksheets in the workbook. 
      let sheets = workbook.getWorksheets();

      // Get a list of all the worksheet names.
      let names = sheets.map ((sheet) => sheet.getName());

      // Write in the console all the worksheet names and the total count.
      console.log(names);
      console.log(`Total worksheets inside of this workbook: ${sheets.length}`);
    }
'ExcelScript.WorkbookProtection#getProtected:member(1)':
  - |-
    /**
     * This script protects the workbook with a default password, if there is not already protection.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the workbook-level protection object.
      const protection = workbook.getProtection();

      // Check if the workbook is already protected.
      if (!protection.getProtected()) {
        // Apply a default password.
        protection.protect("1234");
      }
    }
'ExcelScript.WorkbookProtection#protect:member(1)':
  - |-
    /**
     * This script protects the workbook using a password given in a user prompt.
     */
    function main(workbook: ExcelScript.Workbook, password?: string) {
      // Get the workbook-level protection object.
      const protection = workbook.getProtection();

      // Protect the workbook with the given password.
      // If the optional password was omitted, 
      // no password will be needed to unprotect the workbook.
      protection.protect(password);
    }
'ExcelScript.WorkbookProtection#unprotect:member(1)':
  - |-
    /**
     * This script removes protection from the workbook using a password given in a user prompt.
     */
    function main(workbook: ExcelScript.Workbook, password?: string) {
      // Get the workbook-level protection object.
      const protection = workbook.getProtection();

      // Unprotect the workbook with the given password.
      protection.unprotect(password);
    }
'ExcelScript.WorkbookRangeAreas:interface':
  - |-
    /**
     * This script finds the direct precedents of the active cell.
     * It changes the font and color of those precedent cells. 
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the active cell.
      const selected = workbook.getActiveCell();
      
      // Get the cells that are direct precedents of the current cell.
      const precedents : ExcelScript.WorkbookRangeAreas = selected.getDirectPrecedents();

      // Set the font to bold and the fill color to orange for all the precedent cells.
      precedents.getRanges().forEach(range => {
        range.getFormat().getFill().setColor("orange");
        range.getFormat().getFont().setBold(true);
      });
    }
'ExcelScript.WorkbookLinksRefreshMode:enum':
  - |-
    /**
     * This script refreshes all the links to external workbooks, 
     * if the linked workbook refresh mode is set to manual.
     * To learn about linked workbooks, see https://support.microsoft.com/office/c98d1803-dd75-4668-ac6a-d7cca2a9b95f.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Check the refresh mode.
      if (workbook.getLinkedWorkbookRefreshMode() === ExcelScript.WorkbookLinksRefreshMode.manual) {
        console.log("Refreshing workbook links");

        // Trigger a refresh of linked workbook content.
        workbook.refreshAllLinksToLinkedWorkbooks();
      }
    }
'ExcelScript.Worksheet:interface':
  - |-
    /**
     * This script creates a new worksheet named "Plum" and sets its tab color to purple.
     */
    function main(workbook: ExcelScript.Workbook) {
      const newSheet = workbook.addWorksheet("Plum")
      newSheet.setTabColor("purple");
    }
'ExcelScript.Worksheet#activate:member(1)':
  - |-
    /**
     * This script switches the active view to a worksheet named "Data", if it exists.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Check if the "Data" worksheet exists.
      let dataWorksheet = workbook.getWorksheet("Data");
      if (dataWorksheet) {
        // Switch to the "Data" worksheet.
        dataWorksheet.activate();
      } else {
        console.log(`No worksheet named "Data" in this workbook.`);
      }
    }
'ExcelScript.Worksheet#addChart:member(1)':
  - |-
    /**
     * This sample creates a column-clustered chart based on the current worksheet's data.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the data range.
      let range = selectedSheet.getUsedRange();

      // Insert a chart using the data on the current worksheet.
      let chart = selectedSheet.addChart(ExcelScript.ChartType.columnClustered, range);

      // Name the chart for easy access in other scripts.
      chart.setName("ColumnChart");
    }
'ExcelScript.Worksheet#addGeometricShape:member(1)':
  - |-
    /**
     * This script creates a hexagon shape on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const hexagon: ExcelScript.Shape = 
        currentSheet.addGeometricShape(ExcelScript.GeometricShapeType.hexagon);
      
      // Set the hexagon size to 40x40 pixels.
      hexagon.setHeight(40);
      hexagon.setWidth(40);

      // Position the hexagon at [100,100] pixels.
      hexagon.setLeft(100);
      hexagon.setTop(100);
    }
'ExcelScript.Worksheet#addImage:member(1)':
  - |-
    /**
     * This sample copies an image from a URL. 
     * This could be used to copy photos that a colleague stored in a shared folder to a related workbook.
     */
    async function main(workbook: ExcelScript.Workbook) {
      // Fetch the image from a URL.
      const link = "https://raw.githubusercontent.com/OfficeDev/office-scripts-docs/master/docs/images/git-octocat.png";
      const response = await fetch(link);

      // Store the response as an ArrayBuffer, since it is a raw image file.
      const data = await response.arrayBuffer();

      // Convert the image data into a base64-encoded string.
      const image = convertToBase64(data);

      // Add the image to the current worksheet.
      workbook.getActiveWorksheet().addImage(image);
    }

    /**
     * Converts an ArrayBuffer containing a .png image into a base64-encoded string.
     */
    function convertToBase64(input: ArrayBuffer) {
      const uInt8Array = new Uint8Array(input);
      const count = uInt8Array.length;

      // Allocate the necessary space up front.
      const charCodeArray = new Array<string>(count) 
      
      // Convert every entry in the array to a character.
      for (let i = count; i >= 0; i--) { 
        charCodeArray[i] = String.fromCharCode(uInt8Array[i]);
      }

      // Convert the characters to base64.
      const base64 = btoa(charCodeArray.join(''));
      return base64;
    }
'ExcelScript.Worksheet#addPivotTable:member(1)':
  - |-
    /**
     * This script creates a PivotTable from an existing table and adds it to a new worksheet.
     * This script assumes there is a table in the current worksheet with columns named "Type" and "Sales".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Create a PivotTable based on a table in the current worksheet.
      let sheet = workbook.getActiveWorksheet();
      let table = sheet.getTables()[0];

      // Add the PivotTable to a new worksheet.
      let newSheet = workbook.addWorksheet("Pivot");
      let pivotTable = newSheet.addPivotTable("My Pivot", table, "A1");

      // Add fields to the PivotTable to show "Sales" per "Type".
      pivotTable.addRowHierarchy(pivotTable.getHierarchy("Type"));
      pivotTable.addDataHierarchy(pivotTable.getHierarchy("Sales"));

      // Switch to the new worksheet.
      newSheet.activate();
    }
'ExcelScript.Worksheet#addSlicer:member(1)':
  - |-
    /**
     * This script adds a slicer for an existing PivotTable on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first PivotTable from the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const pivot = currentSheet.getPivotTables()[0];

      // Create the slicer. 
      // Note that this assumes "Type" is already added as a hierarchy to the PivotTable.
      const slicer = currentSheet.addSlicer(
        pivot, /* The table or PivotTale to be sliced. */
        pivot.getHierarchy("Type").getFields()[0] /* What source field to use as the slicer options. */
      );

      // Select the items to display.
      slicer.selectItems(["Lemon", "Lime"]);

      // Set the left margin of the slicer.
      slicer.setLeft(400);
    }
'ExcelScript.Worksheet#addTable:member(1)':
  - |-
    /**
     * This sample creates a table from the current worksheet's used range, then sorts it based on the first column.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Create a table with the used cells.
      let usedRange = selectedSheet.getUsedRange();
      let newTable = selectedSheet.addTable(usedRange, true);

      // Sort the table using the first column.
      newTable.getSort().apply([{ key: 0, ascending: true }]);
    }
'ExcelScript.Worksheet#copy:member(1)':
  - |-
    /**
     * This script duplicates a worksheet named "Template". 
     * The new worksheet is added after the template.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the worksheet named "Template".
      let template = workbook.getWorksheet("Template");

      // Copy the worksheet.
      let newSheet = template.copy(
        ExcelScript.WorksheetPositionType.after,
        template
      );

      // Name the worksheet using the current date.
      let date = new Date(Date.now());
      newSheet.setName(`${date.toDateString()}`);
    }
'ExcelScript.Worksheet#delete:member(1)':
  - |-
    /**
     * The following scripts removes the first worksheet in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the first worksheet.
      let sheet = workbook.getWorksheets()[0];

      // Remove that worksheet from the workbook.
      sheet.delete();
    }
'ExcelScript.Worksheet#findAll:member(1)':
 - |-
    /**
     * This script searches through a worksheet and finds cells containing "No". 
     * Those cells are filled with the color red.
     * Use Range.find instead of Worksheet.findAll when you want to limit the search to a specific range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      let worksheet = workbook.getActiveWorksheet();
      let noCells = worksheet.findAll("No", { completeMatch: true });

      // Set the fill color to red.
      noCells.getFormat().getFill().setColor("red");
    }
'ExcelScript.Worksheet#getAutoFilter:member(1)':
 - |-
    /**
     * This script creates an autoFilter on the worksheet that filters out rows based on column values. 
     * The autoFilter filters to only include rows that have a value in column D in the top 10 percentile 
     * (of column D values).
     */
    function main(workbook: ExcelScript.Workbook) {
      const currentSheet = workbook.getActiveWorksheet();
      const dataRange = currentSheet.getUsedRange();

      // Add a filter that will only show the rows with the top 10% of values in column D
      // (index 3, assuming the used range spans from at least A:D).
      currentSheet.getAutoFilter().apply(dataRange, 3, {
        criterion1: "10",
        filterOn: ExcelScript.FilterOn.topPercent
      });
    }
'ExcelScript.Worksheet#getChart:member(1)':
 - |-
    /**
     * This sample moves an existing chart to a specific place on the worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();
      
      // Get an existing chart named "ColumnChart".
      let chart = selectedSheet.getChart("ColumnChart");

      // Place the chart over the range "F1:L13".
      chart.setPosition("F1", "L13");
    }
'ExcelScript.Worksheet#getName:member(1)':
  - |-
    /**
     * This sample gets all the worksheet names in the workbook.
     * It then logs those names to the console.
     */
    function main(workbook: ExcelScript.Workbook) {
        // Create an array to hold the worksheet names.
        let worksheetNames = [];

        // Iterate over the worksheet collection in the workbook.
        for (let worksheet of workbook.getWorksheets()) {
            worksheetNames.push(worksheet.getName());
        }

        // Log the array of worksheet names.
        console.log(worksheetNames);
    }
'ExcelScript.Worksheet#getPageLayout:member(1)':
  - |-
    /**
     * This script sets the printing orientation for the entire workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Go to each worksheet so the print settings are consistent.
      workbook.getWorksheets().forEach((sheet) => {
        const pageLayout = sheet.getPageLayout();

        // Print every page with a landscape orientation.
        pageLayout.setOrientation(ExcelScript.PageOrientation.landscape);
      });
    }
'ExcelScript.Worksheet#getProtection:member(1)':
  - |-
    /**
     * This script protects cells from being selected on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the protection settings for the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const sheetProtection = currentSheet.getProtection();

      // Create a new WorksheetProtectionOptions object with the selectionMode property set to `none`.
      let protectionOptions : ExcelScript.WorksheetProtectionOptions = {
        selectionMode: ExcelScript.ProtectionSelectionMode.none
      }

      // Apply the given protection options.
      sheetProtection.protect(protectionOptions);
    }
'ExcelScript.Worksheet#getRange:member(1)':
  - |-
    /**
     * This sample reads the value of A1 and prints it to the console.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current worksheet.
      let selectedSheet = workbook.getActiveWorksheet();

      // Get the value of cell A1.
      let range = selectedSheet.getRange("A1");
      
      // Print the value of A1.
      console.log(range.getValue());
    }
'ExcelScript.Worksheet#setName:member(1)':
  - |-
    /**
     * This sample renames a worksheet from "Sheet1" to "SALES".
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get a worksheet named "Sheet1".
      const sheet = workbook.getWorksheet('Sheet1'); 

      // Set its name to SALES.
      sheet.setName('SALES');
    }
'ExcelScript.Worksheet#setPosition:member(1)':
  - |-
    /**
     * This sample sets the worksheet named "SALES" as the first sheet in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get a worksheet named "SALES".
      const sheet = workbook.getWorksheet('SALES'); 
      // Position the worksheet at the beginning of the workbook.
      sheet.setPosition(0);
    }
'ExcelScript.Worksheet#setTabColor:member(1)':
  - |-
    /**
     * This script sets the tab color of every worksheet in the workbook to red.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get all the worksheets in the workbook. 
      let sheets = workbook.getWorksheets();
      
      // Set the tab color of each worksheet to a random color.
      for (let sheet of sheets) {    
        // Set the color of the current worksheet's tab to red.
        sheet.setTabColor("red");
      }
    }
'ExcelScript.Worksheet#setVisibility:member(1)':
  - |-
    /**
     * This script unhides all the worksheets in the workbook.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Iterate over each worksheet.
      workbook.getWorksheets().forEach((worksheet) => {
        // Set the worksheet visibility to visible.
        worksheet.setVisibility(ExcelScript.SheetVisibility.visible);
      });
    }
'ExcelScript.WorksheetPositionType:enum':
  - |-
    /**
     * This script duplicates a worksheet named "Template". 
     * The new worksheet is added after the template.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the worksheet named "Template".
      let template = workbook.getWorksheet("Template");

      // Copy the worksheet.
      let newSheet = template.copy(
        ExcelScript.WorksheetPositionType.after,
        template
      );

      // Name the worksheet using the current date.
      let date = new Date(Date.now());
      newSheet.setName(`${date.toDateString()}`);
    }
'ExcelScript.WorksheetProtection:interface':
  - |-
    /**
     * This script pauses the protection of a worksheet by using the provided password.
     * This password could come from a Power Automate flow.
     */
    function main(workbook: ExcelScript.Workbook, password: string) {
      // Get the worksheet named "Sales".
      const sheet = workbook.getWorksheet("Sales");
      const protection: ExcelScript.WorksheetProtection = sheet.getProtection();
      
      // Check if the provided password works.
      if (protection.checkPassword(password)) {
        protection.pauseProtection(password);

        // Edit the worksheet...

        protection.resumeProtection();
      } else {
        console.log("Incorrect password");
      }
    }
'ExcelScript.WorksheetProtection#addAllowEditRange:member(1)':
  - |-
    /**
     * This script adds a password-protected, editable range
     * to an otherwise protected worksheet.
     */
    function main(workbook: ExcelScript.Workbook, password: string) {
        // Get the protection object for the "Data" worksheet.
        const dataSheet = workbook.getWorksheet("Data");
        const sheetProtection = dataSheet.getProtection();

        // Set the password needed to edit the range to be the user provided string.
        const editRangeProperties : ExcelScript.AllowEditRangeOptions = {
            password: password
        };

        // Set range "D2:D6" to be editable if the password is provided.
        sheetProtection.addAllowEditRange("Notes Section", "D2:D6", editRangeProperties);
        
        // Protect the worksheet.
        sheetProtection.protect();
    }
'ExcelScript.WorksheetProtection#protect:member(1)':
  - |-
    /**
     * This script protects cells from being selected on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the protection settings for the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const sheetProtection = currentSheet.getProtection();

      // Create a new WorksheetProtectionOptions object with the selectionMode property set to `none`.
      let protectionOptions : ExcelScript.WorksheetProtectionOptions = {
        selectionMode: ExcelScript.ProtectionSelectionMode.none
      }

      // Apply the given protection options.
      sheetProtection.protect(protectionOptions);
    }
'ExcelScript.WorksheetProtectionOptions:interface':
  - |-
    /**
     * This script protects cells from being selected on the current worksheet.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the protection settings for the current worksheet.
      const currentSheet = workbook.getActiveWorksheet();
      const sheetProtection = currentSheet.getProtection();

      // Create a new WorksheetProtectionOptions object with the selectionMode property set to `none`.
      let protectionOptions : ExcelScript.WorksheetProtectionOptions = {
        selectionMode: ExcelScript.ProtectionSelectionMode.none
      }

      // Apply the given protection options.
      sheetProtection.protect(protectionOptions);
    }
'ExcelScript.WorksheetSearchCriteria:interface':
 - |-
    /**
     * This script searches through a worksheet and finds cells containing "No". 
     * Those cells are filled with the color red.
     * Use Range.find instead of Worksheet.findAll when you want to limit the search to a specific range.
     */
    function main(workbook: ExcelScript.Workbook) {
      // Get the current, active worksheet.
      const worksheet = workbook.getActiveWorksheet();

      // Get all the cells that exactly contain the string "No".
      const searchCriteria: ExcelScript.WorksheetSearchCriteria = { 
        completeMatch: true,
        matchCase: true
      };
      const noCells = worksheet.findAll("No", searchCriteria);

      // Set the fill color to red.
      noCells.getFormat().getFill().setColor("red");
    }
'OfficeScript.convertToPdf:function(1)':
  - |-  
    /**
     * This script saves a worksheet as a PDF and emails that PDF to a recipient.
     */
    function main(workbook: ExcelScript.Workbook) {    
        // Create the PDF.
        const pdfObject = OfficeScript.convertToPdf();
        const pdfFile = { name: "report.pdf", content: pdfObject }; // Enter your desired PDF name here.

        // Email the PDF.
        OfficeScript.sendMail({
            to: "name@email.com", // Enter your recipient email address here.
            subject: "[Demo] Monthly Sales Report", // This is the subject of your email.
            content: "Here's the Monthly Sales Report", // This is the content within your email.
            attachments: [pdfFile]
        })    
    }